(function(){var EventManagerCls,ext,j3,root,toString,_regFormat,_stringBuilder_proto,__slice=[].slice,__indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};root=this,j3=function(){return j3.$.apply(this,arguments)},typeof exports!="undefined"?typeof module!="undefined"?module.exports=j3:exports.j3=j3:root.j3=j3,j3.version="0.4.4",j3.fnRetFalse=function(){return!1},j3.isRunInServer=function(){return j3.UA.name==="server"},j3.has=function(e,t){return e.hasOwnProperty(t)},j3.isUndefined=function(e){return typeof e=="undefined"},j3.isBoolean=function(e){return typeof e=="boolean"},j3.isNumber=function(e){return typeof e=="number"},j3.isFunction=function(e){return typeof e=="function"},j3.isString=function(e){return typeof e=="string"},j3.isObject=function(e){return typeof e=="object"},j3.isNull=function(e){return e===null},j3.isNullOrUndefined=function(e){return j3.isNull(e)||j3.isUndefined(e)},toString=Object.prototype.toString,j3.isDate=function(e){return"[object Date]"===toString.call(e)},j3.isArray=function(e){return"[object Array]"===toString.call(e)},j3.isDateTime=function(e){return e instanceof j3.DateTime},j3.bind=function(e,t,n){return n?function(){return e.apply(t,n)}:function(){return e.call(t)}},j3.clone=function(e,t,n){var r,i,s,o,u,a,f;if(!j3.isObject(e))return e;if(e===null)return null;if(j3.isDate(e))return new Date(e.getTime());if(j3.isArray(e)){s=[];for(o=0,a=e.length;o<a;o++)r=e[o],s.push(j3.clone(r));return s}if(j3.isFunction(e.clone))return e.clone(t);s={};if(!t)for(i in e)s[i]=j3.clone(e[i]);else for(u=0,f=t.length;u<f;u++)i=t[u],e.hasOwnProperty(i)&&(n?j3.isUndefined(e[i])||(s[i]=j3.clone(e[i])):s[i]=j3.clone(e[i]));return s},j3.equals=function(e,t){var n,r;if(typeof e!=typeof t)return!1;if(j3.isNull(e))return j3.isNull(t);if(!j3.isObject(e))return e===t;if(j3.isDate(e))return e.getTime()===t.getTime();if(j3.isArray(e)){if(!t)return!1;if(e.length!==t.length)return!1;n=-1;while(++n<e.length)if(!j3.equals(e[n],t[n]))return!1;return!0}if(j3.isFunction(e.equals))return e.equals(t);if(j3.isObject(e)&&j3.isObject(t)){for(r in e)if(!j3.equals(e[r],t[r]))return!1;return!0}return!1},j3.compare=function(e,t,n){if(j3.isNullOrUndefined(e))return j3.isNullOrUndefined(t)?0:n?1:-1;if(j3.isNullOrUndefined(t))return n?-1:1;if(j3.isDateTime(e)||j3.isDate(e))e=e.getTime();if(j3.isDateTime(t)||j3.isDate(t))t=t.getTime();if(j3.isObject(e)){if(j3.isFunction(e.compare))return e.compare(t);if(!j3.isObject(t))return 1}if(j3.isObject(t)){if(j3.isFunction(t.compare))return t.compare(e);if(!j3.isObject(e))return-1}return e===t?0:e>t?1:-1},j3.$=function(e){return typeof e=="string"?document.getElementById(e):e},j3.guid=function(){var e,t,n,r;n="";for(e=r=1;r<33;e=++r){t=Math.floor(Math.random()*16).toString(16),n+=t;if(e===8||e===12||e===16||e===20)n+="-"}return n},j3.ns=function(e){var t,n,r,i,s;r=e.split("."),t=typeof window=="undefined"?global:window;for(i=0,s=r.length;i<s;i++)n=r[i],t[n]||(t[n]={}),t=t[n];return t},ext=j3.ext=function(){var e,t,n,r,i,s;n=arguments[0],t=2<=arguments.length?__slice.call(arguments,1):[];for(i=0,s=t.length;i<s;i++){e=t[i];for(r in e)n[r]=e[r]}return n},j3.cls=function(e,t){var n,r,i;return arguments.length===1&&(t=e,e=null),r=t.ctor,e?r?t.ctor=function(){return e.apply(this,arguments),r.apply(this,arguments)}:t.ctor=function(){return e.apply(this,arguments)}:r||(t.ctor=function(){}),n=t.ctor,i=n.prototype,e&&this.ext(i,e.prototype),this.ext(i,t),this.has(t,"toString")&&(i.toString=t.toString),n.base=function(){return e.prototype},n},j3.UA=function(){var e,t,n,r;t={ie:0,trident:0,gecko:0,webkit:0,opera:0,name:"",N_IE:"MSIE",N_TRIDENT:"Trident",N_FIREFOX:"Firefox",N_OPERA:"Opera",N_CHROME:"Chrome",N_SAFARI:"Safari",N_ANDROID:"Android",P_IPOD:"iPod",P_IPAD:"iPad",P_IPHONE:"iPhone",P_ANDROID:"Android"};if(!this.navigator)return t.name="server",t;n=this.navigator.userAgent,n.indexOf(t.N_IE)>-1?(t.ie=!0,t.name=t.N_IE):n.indexOf(t.N_TRIDENT)>-1?(t.ie=!0,t.trident=!0,t.name=t.N_IE):n.indexOf(t.N_FIREFOX)>-1?(t.gecko=!0,t.name=t.N_FIREFOX):n.indexOf(t.N_OPERA)>-1?(t.opera=!0,t.name=t.N_OPERA):n.indexOf("AppleWebKit")>-1&&(t.webkit=!0,n.indexOf(t.N_ANDROID)>-1?t.name=t.N_ANDROID:n.indexOf(t.N_CHROME)>-1?t.name=t.N_CHROME:n.indexOf(t.N_SAFARI)>-1&&(t.name=t.N_SAFARI)),n.indexOf(t.P_IPOD)>-1?t.platform=t.P_IPOD:n.indexOf(t.P_IPAD)>-1?t.platform=t.P_IPAD:n.indexOf(t.P_IPHONE)>-1?t.platform=t.P_IPHONE:n.indexOf(t.P_ANDROID)>-1&&(t.platform=t.P_ANDROID);if(t.name===t.N_OPERA||t.name===t.N_SAFARI)e=n.indexOf("Version")+8;return t.trident?e=n.indexOf("rv:")+3:e=n.indexOf(t.name)+t.name.length+1,r=parseFloat(n.substring(e,e+4).match(/\d+\.\d{1}/i)[0]),t.ie?t.ie=r:t.gecko?t.gecko=r:t.opera?t.opera=r:t.webkit&&(t.webkit=r),t.supportTouch=document.documentElement&&document.documentElement.hasOwnProperty&&document.documentElement.hasOwnProperty("ontouchstart"),t}(),j3.UA.ie>=8||j3.UA.opera||j3.UA.webkit?j3.StringBuilder=j3.cls({ctor:function(){this._data=""},append:function(e){return this._data+=e,this},encodeAndAppend:function(e){return this._data+=j3.htmlEncode(e),this},clear:function(){return this._data="",this},toString:function(){return this._data}}):j3.StringBuilder=j3.cls({ctor:function(){this._data=[]},append:function(e){return this._data[this._data.length]=e,this},encodeAndAppend:function(e){return this._data[this._data.length]=j3.htmlEncode(e),this},clear:function(){return this._data=[],this},toString:function(){return this._data.join("")}}),_stringBuilder_proto=j3.StringBuilder.prototype,_stringBuilder_proto.a=_stringBuilder_proto.append,_stringBuilder_proto.e=_stringBuilder_proto.encodeAndAppend,j3.UrlQuery=j3.cls({ctor:function(){this._query={},this.parse()},get:function(e,t){return this._query?this._query.hasOwnProperty(e)?this._query[e]:t:t},set:function(e,t){var n;return(n=this._query)==null&&(this._query={}),this._query[e]=t},unset:function(e){if(!this._query)return;return delete this._query[e]},toString:function(){var e,t,n,r,i;n=new j3.StringBuilder,e=!0,i=this._query;for(t in i)r=i[t],e?e=!1:n.a("&"),n.a(t+"="+encodeURIComponent(r));return n.toString()},parse:function(){var e,t,n,r,i,s,o,u,a,f;o=location.href,n=o.indexOf("#");if(n<0)return;t=o.substr(n+1),s=t.split("&"),f=[];for(u=0,a=s.length;u<a;u++)e=s[u],i=e.split("="),r=i[0],r?f.push(this.set(r,i[1])):f.push(void 0);return f}}),function(e){var t,n,r,i,s,o,u,a,f,l,c,h;return a=1e3,u=6e4,o=36e5,r=864e5,f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l=/^(\d{4})-(\d{1,2})-(\d{1,2})(?: (\d{1,2}):(\d{1,2}):(\d{1,2})(?:.(\d{1,3}))?)?$/,c=/^(\d{1,2})\/(\d{1,2})\/(\d{4})(?: (\d{1,2}):(\d{1,2}):(\d{1,2})(?:.(\d{1,3}))?)?$/,h=/^(\d{4})-(\d{1,2})-(\d{1,2})(?:T(\d{1,2}):(\d{1,2}):(\d{1,2})(?:.(\d{1,3}))?)?Z$/,i="yyyy-MM-dd HH:mm:ss",s="yyyy-MM-ddTHH:mm:ssZ",t=e.cls({ctor:function(e,t,n,r,i,s,o){var u;u=arguments.length,u===0?this._value=new Date:u===1?this._value=new Date(e):(t=t||0,n=n||0,r=r||0,i=i||0,s=s||0,o=o||0,this._value=new Date(e,t-1,n,r,i,s,o))},getYear:function(){return this._value.getFullYear()},getMonth:function(){return this._value.getMonth()+1},getDay:function(){return this._value.getDate()},getDayOfWeek:function(){return this._value.getDay()},justDate:function(){return new t(this.getYear(),this.getMonth(),this.getDay())},justTime:function(){return new t(this._value.getTime()%r)},addYear:function(e){return new t(this._value.getFullYear+e,this._value.getMonth()+1,this._value.getDate(),this._value.getHours(),this._value.getMinutes(),this._value.getSeconds(),this._value.getMilliseconds())},addMonth:function(e){var n,r;return n=this._value.getFullYear()*12+this._value.getMonth()+1+e,r=parseInt(n/12),n%=12,new t(r,n,this._value.getDate(),this._value.getHours(),this._value.getMinutes(),this._value.getSeconds(),this._value.getMilliseconds())},addDay:function(e){return new t(this._value.getTime()+r*e)},addHour:function(e){return new t(this._value.getTime()+o*e)},addMinute:function(e){return new t(this._value.getTime()+u*e)},addSecond:function(e){return new t(this._value.getTime()+a*e)},addMillisecond:function(e){return new t(this._value.getTime()+e)},toString:function(e){return e==null&&(e=i),t.format(this._value,e)},toUTCString:function(){return t.format(this._value,s,!0)},toJson:function(t){return e.isUndefined(t)&&(t=new e.StringBuilder),t.a('"'),t.a(this.toUTCString()),t.a('"')},getValue:function(){return new Date(this._value.getTime())},getTime:function(){return this._value.getTime()},equals:function(e){return e?this._value.getTime()===e._value.getTime():!1},lt:function(t){return e.DateTime.lt(this,t)},lte:function(t){return e.DateTime.lte(this,t)},gt:function(t){return e.DateTime.gt(this,t)},gte:function(t){return e.DateTime.gte(this,t)},clone:function(){return new t(this._value.getTime())}}),e.ext(t,{UTC:function(e,n,r,i,s,o,u){var a,f;return a=arguments.length,a===0?f=(new Date).getTime():a===1?f=e:(n=n||0,r=r||0,i=i||0,s=s||0,o=o||0,u=u||0,f=Date.UTC(e,n-1,r,i,s,o,u)),new t(f)},format:function(e,n,r){var s,o,u,a,l,c,h;e instanceof t&&(e=e.getValue());if(typeof e=="number")e=new Date(e);else if(!e instanceof Date)return"";return n==null&&(n=i),r?(h=e.getUTCFullYear().toString(),l=(e.getUTCMonth()+1).toString(),o=e.getUTCDate().toString(),u=e.getUTCHours().toString(),a=e.getUTCMinutes().toString(),c=e.getUTCSeconds().toString()):(h=e.getFullYear().toString(),l=(e.getMonth()+1).toString(),o=e.getDate().toString(),u=e.getHours().toString(),a=e.getMinutes().toString(),c=e.getSeconds().toString()),s=n.replace("yyyy",h),s=s.replace("MMM",f[e.getMonth()]),s=s.replace("MM",l.length===1?"0"+l:l),s=s.replace("dd",o.length===1?"0"+o:o),s=s.replace("HH",u.length===1?"0"+u:u),s=s.replace("mm",a.length===1?"0"+a:a),s=s.replace("ss",c.length===1?"0"+c:c),s=s.replace("yy",h.substr(2)),s=s.replace("M",l),s=s.replace("d",o),s=s.replace("H",u),s=s.replace("m",a),s.replace("s",c)},formatUTC:function(e,t){return t==null&&(t=s),this.format(e,t,!0)},parse:function(e){var n;return e instanceof t?e:(n=h.exec(e),n?t.UTC(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),parseInt(n[6],10),parseInt(n[7],10)):(n=l.exec(e),n?new t(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),parseInt(n[6],10),parseInt(n[7],10)):(n=c.exec(e),n?new t(parseInt(n[3],10),parseInt(n[1],10),parseInt(n[2],10),parseInt(n[4],10),parseInt(n[5],10),parseInt(n[6],10),parseInt(n[7],10)):null)))},convertFromJson:function(){var t,n,r,i,s;r=arguments[0],n=2<=arguments.length?__slice.call(arguments,1):[];for(i=0,s=n.length;i<s;i++)t=n[i],r[t]=e.DateTime.parse(r[t])},now:function(){return new t},today:function(){return(new t).justDate()},fromMongoObjectId:function(e){return new t(1e3*parseInt(e.slice(0,8),16))},equals:function(e,t){return e?e.equals(t):!t},lt:function(e,t){var n,r;return n=e?e.getTime():0,r=t?t.getTime():0,n<r},lte:function(e,t){return this.lt(e,t)||this.equals(e,t)},gt:function(e,t){var n,r;return n=e?e.getTime():0,r=t?t.getTime():0,n>r},gte:function(e,t){return this.gt(e,t)||this.equals(e,t)}}),e.DateTime=t,n=function(e,t){var n;arguments.length===1?n=e:n=e.getTime()-t.getTime(),n<0&&(n*=-1),this._span=n||0},e.ext(n.prototype,{totalSeconds:function(){return Math.floor(this._span/a)},totalMinutes:function(){return Math.floor(this._span/u)},totalHours:function(){return Math.floor(this._span/o)},totalDays:function(){return Math.floor(this._span/r)}}),e.ext(n,{format:function(t){var n,i,s,f,l;return t<u?(l=Math.floor(t/a),e.format(e.Lang.seconds,l)):t<o?(f=Math.floor(t/u),f===1?i=e.Lang.minute:i=e.Lang.minutes,e.format(i,f)):t<r?(s=Math.floor(t/o),f=Math.floor((t-s*o)/u),f===0?s===1?i=e.Lang.hour:i=e.Lang.hours:i=e.Lang.hourMinute,e.format(i,s,f)):(n=Math.floor(t/r),s=Math.floor((t-n*r)/o),s===0?n===1?i=e.Lang.day:i=e.Lang.days:i=e.Lang.dayHour,e.format(i,n,s))}}),e.TimeSpan=n}(j3),_regFormat=/{(\d+)?}/g,j3.ext(j3,{format:function(e){var t;return t=arguments,t.length===0?"":t.length===1?e:e.replace(_regFormat,function(e,n){return t[parseInt(n)+1]})},include:function(e,t,n){return n&&n.length?(n+e+n).indexOf(n+t+n)>-1:e.indexOf(t)>-1},isNullOrEmpty:function(e){return typeof e=="undefined"||e===null||e===""},isNullOrWhiteSpace:function(e){return j3.isNullOrEmpty(e)||e.trim()===""},hyphenlize:function(e){var t,n,r,i;n="",r=-1,i=e.length;while(++r<i)t=e.charAt(r),t===t.toUpperCase()?n+="-"+t.toLowerCase():n+=t;return n},htmlEncode:function(e){return this.isNullOrEmpty(e)?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},substrEx:function(e,t){var n,r,i,s,o,u;if(j3.isNullOrEmpty(e))return"";r=0,i=65377,s=65439,o=65512,u=65518;while(r<e.length&&t>0)n=e.charCodeAt(r),n<256||i<=n&&n<=s||o<=n&&n<=u?t-=1:t-=2,r++;return e.length>r?e.substr(0,r)+"...":e.substr(0,r)},startsWith:function(e,t){return!e||!t?!1:e.indexOf(t)===0?!0:!1},endsWith:function(e,t){var n;return!e||!t?!1:(n=e.length-t.length,n<0?!1:e.substr(n)===t?!0:!1)},padLeft:function(e,t,n){var r,i,s,o;e||(e=""),r=t-e.length;if(r<0)return e;n||(n="0"),n.length>1&&(n=n.substr(0,1)),s="";for(i=o=0;0<=r?o<r:o>r;i=0<=r?++o:--o)s+=n;return s+e},padRight:function(e,t,n){var r,i,s,o;e||(e=""),r=t-e.length;if(r<0)return e;n||(n="0"),n.length>1&&(n=n.substr(0,1)),s="";for(i=o=0;0<=r?o<r:o>r;i=0<=r?++o:--o)s+=n;return e+s}}),String.prototype.trim?j3.trim=function(e){return this.isNullOrEmpty(e)?"":e.trim()}:(j3.trim=function(e){return this.isNullOrEmpty(e)?"":e.replace(_regTime,"")},String.prototype.trim=function(){var e,t,n;t=this,t=t.replace(/^\s\s*/,""),n=/\s/,e=t.length-1;while(n.test(t.charAt(e)))e--;return t.slice(0,e+1)}),j3.template=function(e){var t,n,r,i,s,o,u,a;o={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},r=/.^/,n={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(i in n)n[n[i]]=i;return t=/\\|'|\r|\n|\t|\u2028|\u2029/g,a=/\\(\\|'|r|n|t|u2028|u2029)/g,u=function(e){return e.replace(a,function(e,t){return n[t]})},s=function(i,s,a){var f,l,c;return a=a||{},e.ext(a,o),c=i.replace(t,function(e){return"\\"+n[e]}).replace(a.escape||r,function(e,t){return"',\nj3.htmlEncode("+u(t)+"),\n'"}).replace(a.interpolate||r,function(e,t){return"',\n"+u(t)+",\n'"}).replace(a.evaluate||r,function(e,t){return"');\n"+u(t)+"\n;__p.push('"}),l=new e.StringBuilder,l.append("var __p=[],print=function(){__p.push.apply(__p,arguments);};\n"),a.variable||l.append("with(obj||{}){\n"),l.append("__p.push('"),l.append(c),l.append("');\n"),a.variable||l.append("}\n"),l.append('return __p.join("");\n'),f=new Function(a.variable||"obj","j3",l.toString()),s?f(s,e):function(t){return f.call(this,t,e)}},s}(j3),j3.List=j3.cls({ctor:function(){this._count=0},firstNode:function(){return this._first},first:function(){return this._first&&this._first.value},lastNode:function(){return this._last},last:function(){return this._last&&this._last.value},count:function(){return this._count},insertNode:function(e,t){if(e===t)return this;if(e.list){if(t)e.next?e.next.prev=e.prev:this._last=e.prev,e.prev?e.prev.next=e.next:this._first=e.next,e.prev=t.prev,e.next=t,t.prev?(t.prev.next=e,t.prev=e):this._first=e;else{if(this._last===e)return this;e.next.prev=e.prev,e.prev?e.prev.next=e.next:this._first=e.next,e.prev=this._last,e.next=null,this._last.next=e,this._last=e}return this}return e.list=this,this._first?t?(e.next=t,e.prev=t.prev,t.prev=e,e.prev?e.prev.next=e:this._first=e):(e.next=null,e.prev=this._last,this._last.next=e,this._last=e):(e.prev=e.next=null,this._first=this._last=e),this._count++,this},insert:function(e,t){return this.insertNode({value:e},t)},removeNode:function(e){return e&&(e===this._first?this._first=e.next:e.prev.next=e.next,e===this._last?this._last=e.prev:e.next.prev=e.prev,this._count--,delete e.value,delete e.prev,delete e.next,delete e.list),this},remove:function(e){var t,n;return t=this.findNode(e),t?(n=t.value,this.removeNode(t),n):null},clear:function(){var e,t;t=this._first;while(t)e=t.next,delete t.value,delete t.prev,delete t.next,delete t.list,t=e;return this._first=this._last=null,this._count=0},findNode:function(e,t){var n;n=this._first;if(t)while(n){if(t(e,n.value))return n;n=n.next}else if(j3.isFunction(e))while(n){if(e(n.value))return n;n=n.next}else if(e&&e.equals)while(n){if(e.equals(n.value))return n;n=n.next}else while(n){if(e===n.value)return n;n=n.next}return null},contains:function(e,t){return null!==this.findNode(e,t)},getNodeAt:function(e){var t;if(e<0||e>this._count)return null;t=this._first;while(e--)t=t.next;return t},getAt:function(e){var t;return t=this.getNodeAt(e),t?t.value:null},toString:function(){var e;return e=new j3.StringBuilder,this.toJson(e),e.toString()},toJson:function(e){var t;e.append("["),t=this._first;if(t){j3.toJson(t.value,e),t=t.next;while(t)e.append(","),j3.toJson(t.value,e),t=t.next}e.append("]")},forEach:function(e,t,n){var r,i;!t&&!n?(n=e,e=null,t=null):n||(n=t,t=null),i=this._first,r=0;while(i)n.call(e,i.value,t,r),i=i.next,r++},tryUntil:function(e,t,n){var r,i;!t&&!n?(n=e,e=null,t=null):n||(n=t,t=null),i=this._first,r=0;while(i){if(n.call(e,i.value,t,r))return i.value;i=i.next,r++}},doWhile:function(e,t,n){var r,i;!t&&!n?(n=e,e=null,t=null):n||(n=t,t=null),i=this._first,r=0;while(i){if(!n.call(e,i.value,t,r))return i.value;i=i.next,r++}}}),function(e){var t,n;return e.Queue=t=e.cls({ctor:function(){return this.clear()},clear:function(){return this._size=0,this._front=this._rear=-1,this._data=[],this._data.length=5},enqueue:function(e){this._size===this._data.length&&n.call(this),this._rear=(this._rear+1)%this._data.length,this._size+=1,this._data[this._rear]=e},dequeue:function(){if(this._size===0)throw new Error("J3_Err_Queue_Empty");return this._data[this._front]=null,this._front=(this._front+1)%this._data.length,this._size-=1,this._data[this._front]},peek:function(){if(this._size===0)throw new Error("J3_Err_Queue_Empty");return this._data[(this._front+1)%this._data.length]},getSize:function(){return this._size}}),n=function(){var e,t,n,r;e=this._data,r=e.length,r<10240?r*=2:r+=10240,e.length=r;if(this._front<this._rear)return;if(this._rear+1<this._size-this._front-1){t=0,n=this._rear+1;while(t<n)e[(this._size+t)%r]=e[t],e[t]=null,t++;this._rear=(this._rear+this._size)%r}else{t=this._size-1,n=r-this._size;while(t>this._front)e[t+n]=e[t],t--;this._front+=n}},t.fromArray=function(e){var n;return n=new t,n._data=e.concat(),n._size=e.length,n}}(j3),function(e){var t;return e.compileSelector=function(t){if(!t)return function(e){return e};if(e.isFunction(t))return t;if(e.isString(t))return function(n){return e.getVal(n,t)};if(e.isArray(t))return function(n){var r,i,s,o,u;i={};for(o=0,u=t.length;o<u;o++)r=t[o],s=e.getVal(n,r),e.isUndefined(s)||(i[r]=s);return i};if(e.isObject(t))return function(n){var r,i,s,o;i={};for(r in t)o=t[r],e.isString(o)?s=e.getVal(n,o):s=o(n),e.isUndefined(s)||(i[r]=s);return i}},e.compileEquals=function(t){if(e.isFunction(t))return t;if(e.isString(t))return function(n,r){return n===null?r===null?!0:!1:r===null?!1:e.equals(e.getVal(n,t),e.getVal(r,t))};if(e.isArray(t))return function(n,r){var i,s,o;if(n===null)return r===null?!0:!1;if(r===null)return!1;for(s=0,o=t.length;s<o;s++){i=t[s];if(!e.equals(e.getVal(n,i),e.getVal(r,i)))return!1}return!0}},e.compileSortBy=function(t){var n,r,i,s,o,u,a,f,l,c;if(e.isFunction(t))return t;e.isString(t)&&(t=[t]),o=[];for(u=0,f=t.length;u<f;u++){n=t[u],i=n.split(" "),s={name:i[0]},s.name.indexOf("?")===0&&(s.name=s.name.substr(1),s.bool=!0);if(i.length>1){c=i.slice(1);for(a=0,l=c.length;a<l;a++)r=c[a],r==="desc"?s.desc=!0:r==="nullGreat"&&(s.nullGreat=!0)}o.push(s)}return function(t,n){var r,i,s,u;i=0;for(s=0,u=o.length;s<u;s++){r=o[s],r.bool?i=e.compare(!!e.getVal(t,r.name),!!e.getVal(n,r.name)):i=e.compare(e.getVal(t,r.name),e.getVal(n,r.name),r.nullGreat),r.desc&&(i*=-1);if(i!==0)return i}return 0}},t={},e.compileGroupBy=function(n){var r;if(e.isFunction(n))return n;if(e.isString(n))return r=t[n],r?r:(t[n]=r=function(t){return e.getVal(t,n)},r)}}(j3),function(e){var t,n;return t=function(e){var t,n,r,i;i=[];for(n=0,r=this.length;n<r;n++)t=this[n],i.push(e(t));return i},e.indexOf=function(t,n,r){var i;return t?(i=-1,r==null&&(r=e.equals),e.tryUntil(t,function(e,t,s){if(r(e,n))return i=s,!0}),i):-1},e.contains=function(t,n,r){return-1!==e.indexOf(t,n,r)},e["in"]=e.contains,e.remove=function(e,t,n){var r,i,s,o,u,a,f,l;if(e.remove)return e.remove(t,n);if(n)for(i=s=0,a=e.length;s<a;i=++s){r=e[i];if(n(t,r))return e.splice(i,1),r}else if(t.equals)for(i=o=0,f=e.length;o<f;i=++o){r=e[i];if(t.equals(r))return e.splice(i,1),r}else for(i=u=0,l=e.length;u<l;i=++u){r=e[i];if(t===r)return e.splice(i,1),r}},e.count=function(t){return e.isArray(t)?t.length:t?t.count():0},e.forEach=function(t,n,r,i){var s,o,u,a;if(!t)return;!r&&!i?(i=n,n=null,r=null):i||(i=r,r=null);if(e.isArray(t))for(o=u=0,a=t.length;u<a;o=++u)s=t[o],i.call(n,s,r,o);else t.forEach&&t.forEach(n,r,i)},e.tryUntil=function(t,n,r,i){var s,o,u,a;if(!t)return;!r&&!i?(i=n,n=null,r=null):i||(i=r,r=null);if(e.isArray(t))for(o=u=0,a=t.length;u<a;o=++u){s=t[o];if(i.call(n,s,r,o))return s}else t.tryUntil&&t.tryUntil(n,r,i)},e.doWhile=function(t,n,r,i){var s,o,u,a;if(!t)return;!r&&!i?(i=n,n=null,r=null):i||(i=r,r=null);if(e.isArray(t))for(o=u=0,a=t.length;u<a;o=++u){s=t[o];if(!i.call(n,s,r,o))return s}else t.doWhile&&t.doWhile(n,r,i)},e.sortBy=function(t,n){var r;return r=e.compileSortBy(n),t.sort(r)},e.group=function(n,r,i){var s,o,u;return u={},o=e.compileGroupBy(r),s=n.forEach||t,s.call(n,function(e){var t,n;return t=o(e),n=u[t],n||(u[t]=n=[]),n.push(i?i(e):e)}),u},n=function(t,r,i){var s,o,u,a;return u=i.idName,a=i.parentName,o=i.childrenName,s=[],e.forEach(t,function(f){if(r===e.getVal(f,a))return s.push(f),e.setVal(f,o,n(t,e.getVal(f,u),i))}),s.length?s:null},e.tree=function(t,r){var i,s,o,u,a,f,l,c;return r==null&&(r={}),(f=r.idName)==null&&(r.idName="id"),(l=r.parentName)==null&&(r.parentName="parentId"),(c=r.childrenName)==null&&(r.childrenName="children"),s=r.idName,u=r.parentName,i=r.childrenName,o={},e.forEach(t,function(t){return o[e.getVal(t,s)]=t}),a=[],e.forEach(t,function(o){if(!e.getVal(o,u))return a.push(o),e.setVal(o,i,n(t,e.getVal(o,s),r))}),a},e.pickFieldVal=function(t,n){var r,i;return e.isString(n)&&(n={ensureUnique:!1,ignoreEmpty:!1,fieldName:n}),i=[],n.ensureUnique?(r={},e.forEach(t,function(t){var s,o,u,a;o=e.getVal(t,n.fieldName);if(e.isArray(o))for(u=0,a=o.length;u<a;u++){s=o[u];if(n.ignoreEmpty&&e.isNullOrUndefined(s))return;r[s]||(r[s]=!0,i.push(s))}else{if(n.ignoreEmpty&&e.isNullOrUndefined(o))return;if(!r[o])return r[o]=!0,i.push(o)}}),i):(e.forEach(t,function(t){if(n.ignoreEmpty&&e.isNullOrUndefined(t))return;return i.push(e.getVal(t,n.fieldName))}),i)},e.toMap=function(t,n){var r;return r={},e.isFunction(n)?e.forEach(t,function(e){var t;return t=n(e),r[t]=e}):e.forEach(t,function(t){var i;return i=e.getVal(t,n),r[i]=t}),r},e.without=function(t,n){var r;return r=[],e.forEach(t,function(t){if(e.isFunction(n)){if(!n(t))return r.push(t)}else if(!e.tryUntil(n,function(n){return e.equals(t,n)}))return r.push(t)}),r}}(j3),j3.Pool=function(e){return this._maxSize=e.maxSize||-1,this._data=[],this._usedSize=0,this._poolSize=0,this.__onCreate=e.onCreate,this.__onInit=e.onInit,this.__onRelease=e.onRelease,this.__onDestroy=e.onDestroy},j3.ext(j3.Pool.prototype,{getMaxSize:function(){return this._maxSize},setMaxSize:function(e){if(e===-1||e>this._maxSize)return this._maxSize=e},getUsedSize:function(){return this._usedSize},canGain:function(){return this._usedSize!==this._maxSize},gain:function(e){var t;if(!this.canGain())return null;this._usedSize<this._poolSize&&(t=this._data[this._usedSize]);if(!t){t=this.__onCreate(e);if(!t)return null;this._data[this._poolSize++]=t}return this.__onInit(t,e),this._usedSize++,t},release:function(e){var t,n;if(!e)return;n=this._data[this._usedSize-1];if(e!==n){t=0;while(t<this._usedSize){if(e===this._data[t]){this._data[t]=n;break}t++}this._data[this._usedSize-1]=e}typeof this.__onRelease=="function"&&this.__onRelease(e),this._usedSize--}}),function(e){var t,n;return e.Unique=t=function(e){e==null&&(e={}),this._array=[],this._ignoreEmpty=e.ignoreEmpty},t.prototype.getArray=function(){return this._array},t.prototype.add=function(t){var r,i,s,o;if(arguments.length===0)return;if(this._ignoreEmpty){if(e.isUndefined(t))return;if(e.isNull(t))return}if(e.isArray(t)){o=[];for(i=0,s=t.length;i<s;i++)r=t[i],o.push(n.call(this,r));return o}return n.call(this,t)},n=function(t){var n,r,i,s;s=this._array;for(r=0,i=s.length;r<i;r++){n=s[r];if(e.equals(n,t))return}return this._array.push(t)}}(j3),j3.EventManager={on:function(e,t,n){var r,i,s;this._eventHandlers||(this._eventHandlers={});if(arguments.length===1){s=e;for(i in s)n=s[i],r=this._eventHandlers[i],j3.isArray(n)?(t=n[0],n=n[1]):j3.isObject(n)?(t=n.c||n.ctx||n.context,n=n.h||n.hdl||n.handler):t=null,r||(this._eventHandlers[i]=r=new j3.List),r.insert({handler:n,context:t})}else arguments.length===2&&(n=t,t=null),r=this._eventHandlers[e],r||(this._eventHandlers[e]=r=new j3.List),r.insert({handler:n,context:t});return this},un:function(e,t,n){var r;return this._eventHandlers?(r=this._eventHandlers[e],r?(arguments.length===2&&(n=t,t=null),r.removeNode(r.findNode({handler:n,context:t,equals:function(e){return this.handler===e.handler&&this.context===e.context}})),this):this):this},fire:function(e,t,n){var r;return this._eventHandlers?(r=this._eventHandlers[e],r?(r.forEach(function(e){return e.handler.call(e.context,t,n)}),this):this):this}},EventManagerCls=function(){},j3.ext(EventManagerCls.prototype,j3.EventManager),j3.createEventManager=function(){return new EventManagerCls},function(e){var t;return t=function(e,t){this.view=e,this.handler=t},t.prototype.equals=function(e){return this.view===e.view&&this.handler===e.handler},e.Datasource={bind:function(n,r){var i;if(!n)return;this._views||(this._views=new e.List),i=new t(n,r);if(this._views.contains(i))return;return this._views.insert(i),r==null&&(r=n.updateView),r.call(n,this,"refresh")},unbind:function(e,n){var r;if(!e)return;if(!this._views)return;r=new t(e,n);if(!this._views.contains(r))return;return this._views.remove(r)},updateViews:function(e,t){var n,r,i,s;if(!this._views)return;r=this._views.firstNode();while(r)s=r.value,i=s.view,n=s.handler||i.updateView,n.call(i,this,e,t),r=r.next},refreshViews:function(){return this.updateViews("refresh")}}}(j3),j3.DataView={getDatasource:function(){return this._datasource},setDatasource:function(e){if(this._datasource===e)return;this._datasource&&this._datasource.unbind(this),this._datasource=e;if(e)return e.bind(this)},updateData:function(){if(!this._datasource)return;if(this._updatingData)return;return this._updatingData=!0,this.onUpdateData(this._datasource),this._updatingData=!1},isUpdatingData:function(){return this._updatingData},updateView:function(e,t,n){if(this._updatingData||this._updatingView)return;return this._updatingView=!0,this.onUpdateView(e,t,n),this._updatingView=!1},isUpdatingView:function(){return this._updatingView}},function(e){var t;return e.Model=t=function(t,n){var r;n==null&&(n={}),t&&!n.noParse&&this.parse&&(t=this.parse(t));if(r=this.get("defaults"))t=e.ext(r,t);this._data=t||{}},e.ext(t.prototype,e.EventManager,e.Datasource,{notifyChangeName:"modelDataChange",has:function(e){return this._data.hasOwnProperty(e)},getData:function(t){return this._data?e.clone(this._data,t):{}},get:function(t,n){return e.isFunction(this[t])?this[t].call(this):this._data?this._data.hasOwnProperty(t)?this._data[t]:n:n},set:function(t,n,r){var i,s,o,u;(u=this._data)==null&&(this._data={}),e.isObject(t)&&(s=t,r=n),r==null&&(r={}),this._originalData||(this._originalData=e.clone(this._data)),o="change";if(!s){if(e.equals(this._data[t],n))return;i={},i[t]=n,this._data[t]=n}else if(r.append){i={};for(t in s){n=s[t];if(e.equals(this._data[t],n))continue;i[t]=n,this._data[t]=n}}else o="refresh",this.parse&&(s=this.parse(s)),this._data=e.clone(s);return this.notifyChange({eventName:o,changedData:i,source:r.source})},notifyChange:function(e){var t,n,r;return e==null&&(e={}),r=e.eventName,t={changedData:e.changedData,source:e.source,model:this},this.fire(r,this,t),this.updateViews(r,t),n=this.collection,n&&n.notifyModelChange(this.notifyChangeName,t)},toJson:function(t){return e.toJson(this._data,t)}}),e.getVal=function(t,n,r){return e.isFunction(t.get)?t.get(n,r):e.isUndefined(t[n])?r:t[n]},e.setVal=function(t,n,r,i){return e.isFunction(t.set)?t.set(n,r,i):t[n]=r}}(j3),function(e){var t;return t={},e.getCollection=function(e){return t[e]},e.Collection=e.cls({ctor:function(n){n==null&&(n={}),n.id&&(this.id=n.id,t[this.id]=this),this._idName=n.idName||"id",this._idxId={},this._model=n.model||e.Model,this._models=new e.List,this._notFoundModels={},this._lazyLoad=n.lazyLoad,this._url=n.url,this._contextData=n.contextData,n.on&&this.on(n.on)},getModel:function(){return this._model},getContextData:function(){return this._contextData},setContextData:function(e){if(this._contextData===e)return;return this._contextData=e},insert:function(t,n){var r,i,s,o;return n==null&&(n={}),t instanceof this._model?s=t:s=new this._model(t),i=s.get(this._idName),i&&(this._idxId[i]=s),s.collection=this,o=null,e.isUndefined(n.targetIndex)||(o=this._models.getNodeAt(n.targetIndex)),this._models.insert(s,o),n.silent||(r={model:s},this.updateViews("add",r),this.fire("addModel",this,r)),s},remove:function(e,t){var n,r,i;if(!e)return;return t==null&&(t={}),i=this._models.findNode(e),this._activeModel===e&&(r=i.next&&i.next.value,r||(r=i.prev&&i.prev.value)),delete this._idxId[e.get(this._idName)],this._models.removeNode(i),t.silent||(n={model:e},this.updateViews("remove",n),this.fire("removeModel",this,n)),r&&this.setActive(r,t),e},removeById:function(e,t){var n;n=this.getById(e);if(n)return this.remove(n,t)},removeActive:function(e){if(this._activeModel)return this.remove(this._activeModel,e)},clear:function(e){e==null&&(e={}),this._idxId={},this._models.clear(),this._notFoundModels={};if(!e.silent)return this.updateViews("refresh"),this.fire("refresh",this)},loadData:function(t,n){var r,i,s,o;t=t||[],n=n||{},i=n.silent,n.silent=!0,this.clear(n);for(s=0,o=t.length;s<o;s++)r=t[s],this.insert(r,n);e.isUndefined(n.activeIndex)||this.setActive(this._models.getAt(n.activeIndex));if(!i)return this.updateViews("refresh"),this.fire("refresh",this)},getActive:function(){return this._activeModel},setActive:function(e,t){var n,r;if(this._activeModel===e)return;t=t||{},r=this._activeModel,this._activeModel=e;if(!t.silent)return n={old:r,model:e},this.updateViews("active",n),this.fire("activeModelChange",this,n)},setActiveByIndex:function(e,t){if(e>=this.count()||e<0)e=-1;return this.setActive(this.getAt(e),t)},setActiveById:function(e,t){var n=this;return this.getById(e,function(e){return n.setActive(e,t)})},notifyModelChange:function(e,t){return this.updateViews(e,t),this.fire(e,this,t)},getById:function(t,n){var r;return t?(r=this._idxId[t],r?(n&&n(r),r):!this._lazyLoad||this._notFoundModels[t]?(n&&n(null),null):e.get(this._url+t,null,this,function(e,r){if(e.status>=500)return n(null);if(e.status>=400)return this._notFoundModels[t]=!0,n(null);this.insert(r),n(this._idxId[t])})):(n&&n(null),null)},getAt:function(e){return this._models.getAt(e)},count:function(){return this._models.count()},forEach:function(e,t,n){return this._models.forEach(e,t,n)},tryUntil:function(e,t,n){return this._models.tryUntil(e,t,n)},doWhile:function(e,t,n){return this._models.doWhile(e,t,n)},find:function(e,t){var n;return n=this._models.findNode(e,t),n&&n.value},contains:function(e,t){return this._models.contains(e,t)},map:function(e,t){var n;return n=[],this.forEach(t,null,function(t){return n.push(e.call(this,t))}),n}}),e.ext(e.Collection.prototype,e.Datasource),e.ext(e.Collection.prototype,e.EventManager)}(j3),function(e){var t,n,r,i;return t=function(t,n){var r,i;if(e.isFunction(n))return n(t);for(i in n){r=n[i];if(e.isFunction(r)){if(!r(t[i],t))return!1}else if(t[i]!==r)return!1}return!0},i=function(t,n){if(e.isFunction(n))return n(t)},r=function(t){var n,r,i,s,o,u;if(e.isFunction(t))return t;if(e.isString(t))return function(e){return e[t]};if(e.isObject(t))return t.text?e.isFunction(t.text)?r=t.text:(o=t.text,r=function(e){return e[o]}):r=null,t.value?e.isFunction(t.value)?i=t.value:(u=t.value,i=function(e){return e[u]}):i=null,t.id?e.isFunction(t.id)?n=t.id:(s=t.id,n=function(e){return e[s]}):n=null,function(e){var t;return t={},r&&(t.text=r(e)),i&&(t.value=i(e)),n&&(t.id=n(e)),t}},n=function(){var t,n,i,s,o,u,a,f,l,c,h,p;c=this._models,s=this._groupIdName,n=this._groupBy,a=this._groupSortBy;if(!n)return;f=r(n),u={},o=[];for(h=0,p=c.length;h<p;h++){t=c[h],i=f(t.getData()),i||(i=this._defaultGroupData);if(!i)continue;l=u[i[s]],l||(i.items=[],u[i[s]]=l=i,o.push(l)),l.items.push(t)}a||(a="id"),o.sort(e.compileSortBy(a)),this._groupList=o,this._groupMap=u},e.CollectionView=e.cls({ctor:function(e){return this._idName=e.idName||"id",this._selector=e.selector,this._filterBy=e.filterBy,this._sortBy=e.sortBy,this._groupIdName=e.groupIdName||"id",this._groupBy=e.groupBy,this._groupSortBy=e.groupSortBy,this._defaultGroupData=e.defaultGroupData,this._model=e.model,this.setDatasource(e.datasource),e.on&&this.on(e.on)},getModel:function(){return this._model||this.getDatasource().getModel()||e.Model},getSelector:function(){return this._selector},setSelector:function(e,t){t=t||{},this._selector=e;if(!t.silent)return this.refresh()},getFilterBy:function(){return this._filterBy},setFilterBy:function(e,t){t=t||{},this._filterBy=e;if(!t.silent)return this.refresh()},getSortBy:function(){return this._sortBy},setSortBy:function(e,t){t=t||{},this._sortBy=e;if(!t.silent)return this.refresh()},getGroupBy:function(){return this._groupBy},setGroupBy:function(e,t){t=t||{},this._groupBy=e;if(!t.silent)return n.call(this),this.updateViews("group")},getGroupSortBy:function(){return this._groupSortBy},setGroupSortBy:function(e,t){t=t||{},this._groupSortBy=e;if(!t.silent)return this.updateViews("groupSort")},getById:function(e){return this._idxId[e]},getAt:function(e){return e<0||e>=this._models.length?null:this._models[e]},removeById:function(e,t){return this.getDatasource().removeById(e,t)},getActive:function(){return this._activeModel},setActive:function(e,t){var n,r;if(this._activeModel===e)return;t=t||{},r=this._activeModel,this._activeModel=e;if(!t.silent)return n={old:r,model:e},this.updateViews("active",n),this.fire("activeModelChange",this,n)},count:function(){return this._models.length},onUpdateView:function(e,t,n){return this.refresh()},forEach:function(t,n,r){return e.forEach(this._models,t,n,r)},tryUntil:function(t,n,r){return e.tryUntil(this._models,t,n,r)},doWhile:function(t,n,r){return e.doWhile(this._models,t,n,r)},forEachGroup:function(e,t,n){var r,i,s,o,u,a;if(!this._groupList)return;!t&&!n?(n=e,e=null,t=null):n||(n=t,t=null),u=this._groupList,a=[];for(i=s=0,o=u.length;s<o;i=++s)r=u[i],a.push(n.call(e,r,t,i));return a},getGroupById:function(e){if(!this._groupMap)return;return this._groupMap[e]},refresh:function(){var r,s,o,u,a,f,l,c,h,p,d;f=[],s={};if(this._selector){this._datasource.forEach(this,function(e){var t,n;n=i(e,this._selector);if(n){if(!this._idName)return f.push(n);t=n[this._idName];if(!s[t])return s[t]=n,f.push(n)}});if(this._filterBy){o=[];for(c=0,p=f.length;c<p;c++)a=f[c],t(a,this._filterBy)&&o.push(a);f=o}}else this._filterBy?this._datasource.forEach(this,function(e){var n;n=e.getData();if(t(n,this._filterBy))return f.push(n)}):this._datasource.forEach(this,function(e){return f.push(e.getData())});this._models=[],this._idxId={},r=this.getModel();for(h=0,d=f.length;h<d;h++)a=f[h],l=new r(a),l.collection=this,this._models.push(l),this._idName&&(u=a[this._idName],this._idxId[u]=l);return this._sortBy&&this._models.sort(e.compileSortBy(this._sortBy)),n.call(this),this.updateViews("refresh"),this.fire("refresh",this)}}),e.ext(e.CollectionView.prototype,e.DataView,e.Datasource,e.EventManager)}(j3),function(e){var t,n,r,i;return r=function(t,n){var r;if(t.group===n)return;return t.group&&t.group.items.remove(t),t.group=n,r=n.items,r||(n.items=r=new e.List),r.insert(t)},i=function(e){var t,n;t=e.group;if(!t)return;e.group=null,n=t.items;if(n)return n.remove(e)},n=function(e,t,n){var r;r=e.firstNode();while(r){if(r.value!==t&&0<n(r.value._data,t._data))return r;r=r.next}return null},e.GroupedCollection=t=e.cls({ctor:function(t){t==null&&(t={}),t.id&&(this.id=t.id,_collections[this.id]=this),this._idName=t.idName||"id",this._idxId={},this._model=t.model||e.Model,this._models=new e.List,this._groupIdName=t.groupIdName||"id",this._groupMap={},this._groupModel=t.groupModel||e.Model,this._groupList=new e.List,t.groupBy&&(this._groupBy=e.compileGroupBy(t.groupBy)),t.groupSortBy&&(this._groupSortBy=e.compileSortBy(t.groupSortBy)),t.on&&this.on(t.on)},getModel:function(){return this._model},getData:function(e){return this._data?this._data[e]:null},setData:function(e,t){return this._data||(this._data={}),this._data[e]=t},insertGroup:function(e,t){var r,i,s;return t==null&&(t={}),r=new this._groupModel(e),r.notifyChangeName="groupDataChange",r.collection=this,s=r.get(this._groupIdName),s&&(this._groupMap[s]=r),this._groupSortBy&&(i=n(this._groupList,r,this._groupSortBy)),this._groupList.insert(r,i),t.silent||this.updateViews("groupAdd",{group:r}),r},removeGroup:function(e,t){var n,r;if(!e)return;return t==null&&(t={}),r=this._groupList.findNode(e),this._activeGroup===e&&(n=r.next&&r.next.value,n||(n=r.prev&&r.prev.value)),this._groupList.removeNode(r),delete this._groupMap[e.get(this._groupIdName)],t.silent||this.updateViews("groupRemove",{group:e}),n&&this.setActiveGroup(n,t),e},removeGroupById:function(e,t){var n;n=this.getGroupById(e);if(n)return this.removeGroup(n,t)},removeActiveGroup:function(e){if(this._activeGroup)return this.removeGroup(this._activeGroup,e)},insert:function(e,t){var n,i,s,o;t==null&&(t={}),e instanceof this._model?o=e:o=new this._model(e),s=o.get(this._idName),s&&(this._idxId[s]=o);if(t.group)r(o,t.group);else{i=this._groupBy(o),n=this.getGroupById(i);if(!n)return;r(o,n)}return o.collection=this,this._models.insert(o),t.silent||this.updateViews("add",{model:o}),o},remove:function(e,t){var n,r;if(!e)return;return t==null&&(t={}),r=this._models.findNode(e),this._activeModel===e&&(n=r.next&&r.next.value,n||(n=r.prev&&r.prev.value)),i(e),delete this._idxId[e.get(this._idName)],this._models.removeNode(r),t.silent||this.updateViews("remove",{model:e}),n&&this.setActive(n,t),e},removeById:function(e,t){var n;n=this.getById(e);if(n)return this.remove(n,t)},removeActive:function(e){if(this._activeModel)return this.remove(this._activeModel,e)},clear:function(e){e==null&&(e={}),this._idxId={},this._models.clear(),this.forEachGroup(function(e){return e.items&&e.items.clear()});if(!e.silent)return this.updateViews("refresh"),this.fire("refresh",this)},clearGroup:function(e){e==null&&(e={}),this._idxId={},this._models.clear(),this._groupMap={},this._groupList.clear();if(!e.silent)return this.updateViews("refresh"),this.fire("refresh",this)},loadGroupData:function(t,n){var r,i,s,o;n==null&&(n={}),i=n.silent,n.silent=!0,this.clearGroup(n);for(s=0,o=t.length;s<o;s++)r=t[s],this.insertGroup(r,n);e.isUndefined(n.activeIndex)||this.setActiveGroup(this._groupList.getAt(n.activeIndex));if(!i)return this.updateViews("refresh"),this.fire("refresh",this)},loadData:function(t,n){var r,i,s,o;n=n||{},i=n.silent,n.silent=!0,this.clear(n);for(s=0,o=t.length;s<o;s++)r=t[s],this.insert(r,n);e.isUndefined(n.activeIndex)||this.setActive(this._models.getAt(n.activeIndex));if(!i)return this.updateViews("refresh"),this.fire("refresh",this)},getActiveGroup:function(){return this._activeGroup},setActiveGroup:function(e,t){var n,r;if(this._activeGroup===e)return;t=t||{},r=this._activeGroup,this._activeGroup=e;if(!t.silent)return n={old:r,group:e},this.updateViews("activeGroup",n),this.fire("activeGroupChange",this,n)},setActiveGroupByIndex:function(e,t){if(e>=this._groupList.count()||e<0)e=-1;return this.setActiveGroup(this.getGroupAt(e),t)},getGroupById:function(e){return e?this._groupMap[e]:null},getGroupAt:function(e){return this._groupList.getAt(e)},groupCount:function(){return this._groupList.count()},getActive:function(){return this._activeModel},setActive:function(e,t){var n,r;if(this._activeModel===e)return;t=t||{},r=this._activeModel,this._activeModel=e;if(!t.silent)return n={old:r,model:e},this.updateViews("active",n),this.fire("activeModelChange",this,n)},setActiveByIndex:function(e,t){if(e>=this.count()||e<0)e=-1;return this.setActive(this.getAt(e),t)},notifyModelChange:function(e,t){var i,s,o,u,a;return e==="groupDataChange"?this._groupSortBy&&(i=t.model,i&&(a=n(this._groupList,i,this._groupSortBy),o=this._groupList.findNode(i),this._groupList.insertNode(o,a))):(u=t.model,s=this._groupBy(u),i=this.getGroupById(s),i&&r(u,i)),this.updateViews(e,t),this.fire(e,this,t)},getById:function(e,t){return e?this._idxId[e]:null},getAt:function(e){return this._models.getAt(e)},count:function(){return this._models.count()},forEach:function(e,t,n){return this._models.forEach(e,t,n)},tryUntil:function(e,t,n){return this._models.tryUntil(e,t,n)},doWhile:function(e,t,n){return this._models.doWhile(e,t,n)},forEachGroup:function(e,t,n){return this._groupList.forEach(e,t,n)},tryUntilGroup:function(e,t,n){return this._groupList.tryUntil(e,t,n)},doWhileGroup:function(e,t,n){return this._groupList.doWhile(e,t,n)}}),e.ext(t.prototype,e.Datasource,e.EventManager)}(j3),function(j3){var fEncodeString,mEncodeString,rEncodeString,__arrayToJson,__objectToJson,__stringToJson,__toJson;return rEncodeString=/\\|\r|\n|\t|"/g,mEncodeString={"\\":"\\\\","\r":"\\n","\n":"\\n","	":"\\t",'"':'\\"'},fEncodeString=function(e){return mEncodeString[e]},__stringToJson=function(e,t){return t.append('"'),t.append(e.replace(rEncodeString,fEncodeString)),t.append('"')},__arrayToJson=function(e,t){var n,r,i,s;t.append("["),n=!0;for(i=0,s=e.length;i<s;i++)r=e[i],n?n=!1:t.append(","),__toJson(r,t);return t.append("]")},__objectToJson=function(e,t){var n,r,i;if(j3.isFunction(e.toJson))return e.toJson(t);t.append("{"),n=!0;for(r in e){i=e[r];if(j3.isUndefined(i))continue;n?n=!1:t.append(","),__stringToJson(r,t),t.append(":"),__toJson(i,t)}return t.append("}")},__toJson=function(e,t){var n;n=typeof e;switch(n){case"string":t.append('"'),t.append(e.replace(rEncodeString,fEncodeString)),t.append('"');break;case"number":case"boolean":t.append(e.toString());break;case"object":j3.isArray(e)?__arrayToJson(e,t):j3.isDate(e)?t.append('"/Date('+e.getTime()+')/"'):j3.isNull(e)?t.append("null"):__objectToJson(e,t);break;case"undefined":t.append("null");break;default:__stringToJson(e.toString(),t)}},j3.toJSON=j3.toJson=function(e,t){return j3.isUndefined(t)?(t=new j3.StringBuilder,__toJson(e,t),t.toString()):__toJson(e,t)},j3.fromJSON=j3.fromJson=function(json){return eval("("+json+")")}}(j3),j3.Dom=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;return j3.isRunInServer()?null:(t=j3.UA,y=document.createElement("div"),e={create:function(e,t,n){var r,i,s;r=document.createElement(e);if(!r)return;if(!t)return r;for(i in t)s=t[i],r[i]=s;return j3.isUndefined(n)||(r.innerHTML=n),r},attr:function(e,t,n){var r;if(arguments.length===3){e.attributes[t]=n;return}return r=e.attributes[t],r?r.nodeValue:null},getAttr:function(e,t){var n;return n=e.attributes[t],n?n.nodeValue:null},setAttr:function(e,t,n){return e.attributes[t]=n},removeAttr:function(e,t){return e.removeAttribute(t)},data:function(e,t,n){if(arguments.length===3){this.attr(e,"data-"+t,n);return}return e.dataset?e.dataset[t]:this.attr(e,"data-"+t)},getData:function(e,t){return e.dataset?e.dataset[t]:this.getAttr(e,"data-"+t)},setData:function(e,t,n){return this.setAttr(e,"data-"+t,n)},removeData:function(e,t){return this.removeAttr(e,"data-"+t)},hasCls:function(e,t){return j3.include(e.className,t," ")},setCls:function(e,t){e.className=t.trim()},addCls:function(e,t){this.hasCls(e,t)||(e.className=(e.className+" "+t).trim())},removeCls:function(e,t){e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)"),"$1").trim()},replaceCls:function(e,t,n){this.hasCls(e,n)?n=" ":n=" "+n+" ",e.className=(" "+e.className+" ").replace(" "+t+" ",n).trim()},toggleCls:function(e,t,n){var r;r=this.hasCls(e,t),arguments.length===2?r?this.removeCls(e,t):this.addCls(e,t):r?this.replaceCls(e,t,n):this.replaceCls(e,n,t)},visible:function(e,t){return arguments.length===1?this.getStyle(e,!0):t?this.show(e):this.hide(e)},show:function(e){if(e.style.display!=="none")return;e.style.display=e._oldStyleDisplay||""},hide:function(e){if(e.style.display==="none")return;e._oldStyleDisplay=e.style.display,e.style.display="none"},remove:function(e){return e.parentNode.removeChild(e)},append:function(e,t){var n;if(!e)return;if(typeof t=="string"){y.innerHTML=t;if(y.childNodes.length>1){n=[];while(y.firstChild)n[n.length]=e.appendChild(y.firstChild);return n}return e.appendChild(y.firstChild)}return e.appendChild(t)},parent:function(e,t){if(arguments.length===1)return e.parentNode;if(0===t.indexOf(".")){t=t.substr(1);while(e){if(this.hasCls(e,t))return e;e=e.parentNode}}else{t=t.toUpperCase();while(e){if(e.tagName===t)return e;e=e.parentNode}}return null},indexOf:function(e){var t,n,r,i,s,o;r=e.parentNode;if(!r)return-1;t=0,o=r.childNodes;for(i=0,s=o.length;i<s;i++){n=o[i];if(n.nodeType===1){if(n===e)return t;++t}}return-1},byIndex:function(e,t){var n,r,i,s,o;if(!e)return null;r=0,o=e.childNodes;for(i=0,s=o.length;i<s;i++){n=o[i];if(n.nodeType===1){if(r===t)return n;++r}}return null},byCls:function(e,t){var n,r,i,s;if(!e)return null;s=e.childNodes;for(r=0,i=s.length;r<i;r++){n=s[r];if(n.nodeType===1&&this.hasCls(n,t))return n}return null},firstChild:function(e){return e.children[0]},lastChild:function(e){e=e.lastChild;while(e){if(e.nodeType===1)return e;e=e.previousSibling}return null},next:function(e){if(!e)return null;e=e.nextSibling;while(e){if(e.nodeType===1)return e;e=e.nextSibling}return null},previous:function(e){if(!e)return null;e=e.previousSibling;while(e){if(e.nodeType===1)return e;e=e.previousSibling}return null},pageWidth:function(e){var t,n;return e==null&&(e=window),n=e.document.documentElement.scrollWidth,t=this.clientWidth(e),n>t?n:t},pageHeight:function(e){var t,n;return e==null&&(e=window),n=e.document.documentElement.scrollHeight,t=this.clientHeight(e),n>t?n:t},offsetWidth:function(e,t){var n;if(arguments.length===1)return e.offsetWidth;j3.isUndefined(t)||t===-1?e.style.width="":(n=e.offsetWidth-this.width(e),e.style.width=t-n+"px")},offsetHeight:function(e,t){var n;if(arguments.length===1)return e.offsetHeight;j3.isUndefined(t)||t===-1?e.style.height="":(n=e.offsetHeight-this.height(e),e.style.height=t-n+"px")},place:function(e,t,n,r){var i,s;s=e.style,s.left=s.top="0",i=this.position(e,r),j3.isUndefined(t)||(s.left=t-i.left+"px"),j3.isUndefined(n)||(s.top=n-i.top+"px")},center:function(e,t,n){var r,i,s,o,u,a,f,l;return t!==0&&t==null&&(t=.4),n!==0&&n==null&&(n=.5),i=this.clientWidth(),r=this.clientHeight(),o=this.offsetWidth(e),s=this.offsetHeight(e),a=document.documentElement.scrollTop,u=document.documentElement.scrollLeft,n>=1?f=n:f=(i-o)*n+u,t>=1?l=t:l=(r-s)*t+a,f<0&&(f=0),l<0&&(l=0),this.place(e,f,l)},disableLink:function(e,t){t||(t="disabled");if(this.hasCls(e,t))return;this.addCls(e,t),this.setData(e,"href",e.href),this.removeAttr(e,"href")},enableLink:function(e,t){t||(t="disabled");if(!this.hasCls(e,t))return;this.removeCls(e,t),e.href=this.getData(e,"href"),this.removeData(e,"href")}},e.getAttr=e.attr,e.getData=e.data,m=function(e,t){var n,r,i,s,o;if(arguments.length===2){e.style.width=t+"px";return}return i=e.currentStyle,n=parseInt(i.borderLeftWidth)||0,r=parseInt(i.borderRightWidth)||0,s=parseInt(i.paddingLeft)||0,o=parseInt(i.paddingRight)||0,e.offsetWidth-n-r-s-o},l=function(e,t){var n,r,i,s,o;if(arguments.length===2){e.style.height=t+"px";return}return i=e.currentStyle,r=parseInt(i.borderTopWidth)||0,n=parseInt(i.borderBottomWidth)||0,o=parseInt(i.paddingTop)||0,s=parseInt(i.paddingBottom)||0,e.offsetHeight-r-n-o-s},g=function(e,t){if(arguments.length===2){e.style.width=t+"px";return}return parseInt(document.defaultView.getComputedStyle(e,null).getPropertyValue("width"))},c=function(e,t){if(arguments.length===2){e.style.height=t+"px";return}return parseInt(document.defaultView.getComputedStyle(e,null).getPropertyValue("height"))},d=function(e,n){var r,i,s,o;return e.parentNode===null||this.getStyle(e,"display")==="none"?null:(r=e.getBoundingClientRect(),s=r.left,o=r.top,t.ie&&t.version===7&&window===top&&(s-=2,o-=2),n||(i=document.documentElement,s+=i.scrollLeft,o+=i.scrollTop),{left:s,top:o})},v=function(e,t){var n,r,i,s;if(e.parentNode===null||this.getStyle(e,"display")==="none")return null;i=0,s=0;while(e){i+=e.offsetLeft||0,s+=e.offsetTop||0;if(e.offsetParent===document.body&&this.getStyle(e,"position")==="absolute")break;e=e.offsetParent,e&&(n=document.defaultView.getComputedStyle(e,null),i+=parseInt(n.getPropertyValue("border-left-width"))||0,s+=parseInt(n.getPropertyValue("border-top-width"))||0)}return t&&(r=document.documentElement,i-=r.scrollLeft,s-=r.scrollTop),{left:i,top:s}},h=function(e,t){var n;if(arguments.length===1)return e.filters.length===0?1:(n=e.filters.item("alpha"),n||(n=e.filters.item("DXImageTransform.Microsoft.Alpha")),n?n.opacity/100:1);e.style.filter="alpha(opacity="+t*100+")",e.currentStyle.hasLayout||(e.style.zoom=1)},p=function(e,t){return arguments.length===1?document.defaultView.getComputedStyle(e,"").getPropertyValue("opacity"):(e.style.opacity=t,e.style["-moz-opacity"]=t,e.style["-khtml-opacity"]=t)},a=function(e,t){return t==="opacity"?this.opacity(e):e.currentStyle[t]},f=function(e,t){var n;return t==="opacity"?this.opacity(e):(n=e.style[t],n?n:document.defaultView.getComputedStyle(e,"").getPropertyValue(j3.hyphenlize(t)))},o=function(e){return e==null&&(e=window),e.document.documentElement.clientWidth},r=function(e){return e==null&&(e=window),e.document.documentElement.clientHeight},u=function(e){return e==null&&(e=window),e.document.body.clientWidth},s=function(e){return e==null&&(e=window),e.innerWidth},n=i=function(e){return e==null&&(e=window),e.innerHeight},t.ie?j3.ext(e,{clientWidth:o,clientHeight:r,width:m,height:l,position:d,getStyle:a,opacity:h}):(t.gecko?j3.ext(e,{clientWidth:s,clientHeight:n,position:d}):j3.ext(e,{clientWidth:u,clientHeight:i,position:v}),j3.ext(e,{width:g,height:c,getStyle:f,opacity:p})),t.ie&&t.version>=8&&e.position(document.documentElement).left===2&&(t.version=7),e)}(),function(){var e;return j3.Path=e={normalize:function(e){return e?(e=e.replace(/\\/gi,"/"),e=e.replace(/\/\//gi,"/")):""},basename:function(e,t){var n,r;return e=this.normalize(e),j3.endsWith(e,"/")&&(e=e.substr(0,e.length-1)),r=e.lastIndexOf("/"),r===-1?n=e:n=e.substr(r+1),j3.endsWith(n,t)&&(n=n.substr(0,n.length-t.length)),n},extname:function(e){var t;return t=e.lastIndexOf("."),t===-1||t===e.length-1?"":e.substr(t)}}}(),function(e){var t,n,r,i;if(e.isRunInServer())return;return t=function(e){this.event=e},e.ext(t.prototype,{keyCode:function(){return this.event.keyCode}}),e.UA.ie?e.ext(t.prototype,{src:function(){return this.event.srcElement},button:function(){switch(this.event.button){case 1:return 1;case 2:return 3;case 4:return 2;default:return 0}},leftButton:function(){return this.event.button===1},rightButton:function(){return this.event.button===2},middleButton:function(){return this.event.button===4},pageX:function(){return this.event.clientX+document.documentElement.scrollLeft},pageY:function(){return this.event.clientY+document.documentElement.scrollTop},stop:function(){return this.event.returnValue=!1,this.event.cancelBubble=!0,this.event.preventDefault&&this.event.preventDefault(),this.event.stopPropagation&&this.event.stopPropagation()}}):e.ext(t.prototype,{src:function(){return this.event.target},button:function(){return this.event.which},leftButton:function(){return this.event.which===1},rightButton:function(){return this.event.which===3},middleButton:function(){return this.event.which===2},pageX:function(){return this.event.pageX},pageY:function(){return this.event.pageY},stop:function(){return this.event.preventDefault(),this.event.stopPropagation()}}),r=new e.List,i=new e.List,n=function(e){var t,n;t=e.e,n=e.n,t.removeEventListener?t.removeEventListener(n,e.f,!0):t.detachEvent(n,e.f),delete e.e,delete e.h,delete e.f},e.on=function(n,i,s,o){var u;if(n.on===e.EventManager.on)return n.on(i,s,o);arguments.length===3&&(o=s),u={e:n,n:i,h:o,c:s,f:function(){return o.call(s,new t(arguments[0]))}},r.insert(u),n.addEventListener?n.addEventListener(i,u.f,!0):n.attachEvent("on"+i,u.f)},e.un=function(t,i,s,o){var u,a;if(t.un===e.EventManager.on)return t.un(i,s,o);arguments.length===3&&(o=s),a=r.firstNode();while(a){u=a.value;if(u.e===t&&u.n===i&&u.h===o&&u.c===s){t.removeEventListener?t.removeEventListener(i,u.h,!0):t.dettachEvent("on"+i,u.h);break}a=a.next}if(!a)return;n(a.value),r.removeNode(a)},e.ready=function(e,t){var n;return n=arguments.length===1?e:function(){return t.call(e,arguments[0])},i.insert(n)},e.on(window,"load",function(){var e;e=i.firstNode();while(e)e.value(),e=e.next}),e.on(window,"unload",function(){var e,t,i;t=r.firstNode(),i=[];while(t)e=t.value,n(e),i.push(t=t.next);return i})}(j3),function(e){var t,n,r,i,s,o,u,a;return e.Drag=t=e.cls({ctor:function(t){this._el=e.$(t.el),this._offsetX=t.offsetX||0,this._offsetY=t.offsetY||0,this._direction=t.direction||3,this._invalidTriggerTypes=t.invalidTriggerTypes,this.setTrigger(t.trigger||t.el)},getTrigger:function(){return this._elTrigger},setTrigger:function(t){return t=e.$(t),this._elTrigger&&e.un(this._elTrigger,"mousedown",this,a),t&&e.on(t,"mousedown",this,a),this._elTrigger=t},getEl:function(){return this._el},getIndicator:function(){return this._el},getStartX:function(){return this._startX},getStartY:function(){return this._startY},getCurX:function(){return this._curX},getCurY:function(){return this._curY},getStartPosX:function(){return this._startPosX},getStartPosY:function(){return this._startPosY},getDragRect:function(){var e,t,n,r;return e=this._curX-this._startX,t=this._curY-this._startY,e<0?n=this._startX+e:n=this._startX,t<0?r=this._startY+t:r=this._startY,{left:n,top:r,width:Math.abs(e),height:Math.abs(t)}},onDrag:function(){return e.Dom.place(this.getIndicator(),this._curPosX,this._curPosY)},getDisabled:function(){return this._disabled},setDisabled:function(e){return this._disabled=!!e}}),e.ext(t.prototype,e.EventManager),a=function(t){var o,u=this;if(this._disabled)return;this._dragTrigger=t.src();if(e.include(this._invalidTriggerTypes,this._dragTrigger.tagName,","))return;return this._startX=this._curX=t.pageX(),this._startY=this._curY=t.pageY(),o=document.body,e.on(o,"keydown",this,r),e.on(o,"mousemove",this,i),e.on(o,"mouseup",this,s),this._beginDragTimeout=setTimeout(function(){return n.call(u)},2e3)},n=function(){var t,n,r;t={trigger:this._dragTrigger,result:!0},this.beforeDrag&&this.beforeDrag(t);if(!t.result)return;this.fire("beforeDrag",this,t);if(!t.result)return;return r=e.Dom.position(this._el),this._curPosX=this._startPosX=r.left+this._offsetX,this._curPosY=this._startPosY=r.top+this._offsetY,n=document.body,this._oldSelectStart=n.onselectstart,n.onselectstart=e.fnRetFalse,e.Dom.addCls(n,"selectDisabled"),this.onDragStart&&this.onDragStart(),this.fire("dragStart",this),this._draging=!0},o=function(){u.call(this);if(!this._draging)return;return this.onDragCancel&&this.onDragCancel(),this.fire("dragCancel",this),this._draging=!1},i=function(e){var t;this._curX=e.pageX(),this._curY=e.pageY();if(!this._draging){if(Math.abs(this._curX-this._startX)>5||Math.abs(this._curY-this._startY)>5)clearTimeout(this._beginDragTimeout),n.call(this);return}return t=this._direction,t&1&&(this._curPosX=this._startPosX+this._curX-this._startX),t&2&&(this._curPosY=this._startPosY+this._curY-this._startY),this.onDrag()},s=function(e){u.call(this);if(!this._draging)return;return this.onDragEnd&&this.onDragEnd(),this.fire("dragEnd",this),this._draging=!1},r=function(e){if(e.event.keyCode===27)return o.call(this)},u=function(){var t;t=document.body,e.un(t,"mousemove",this,i),e.un(t,"mouseup",this,s),clearTimeout(this._beginDragTimeout);if(!this._draging)return;return t.onselectstart=this._oldSelectStart,e.Dom.removeCls(t,"selectDisabled")}}(j3),function(e){var t,n,r,i,s,o,u,a,f,l,c,h;if(e.isRunInServer())return;c=0,u={text:"text/pain",json:"application/json",form:"application/x-www-form-urlencoded"},window.XMLHttpRequest?r=function(){return new XMLHttpRequest}:r=function(){return new ActiveXObject("MSXML2.XmlHttp")},o=function(t,n){var r,i,s;if(!t)return;r=!0;for(i in t){s=t[i];if(t.hasOwnProperty(i)){if(e.isNull(s)||e.isUndefined(s))continue;r?r=!1:n.append("&"),n.append(encodeURIComponent(i)),n.append("="),n.append(encodeURIComponent(s))}}},s=function(t,n,r){switch(r){case"text":t.append(n);break;case"json":e.toJson(n,t);break;default:o(n,t)}},i=function(t){var n;return n=t.getResponseHeader("Content-Type"),n||(n=""),n.indexOf(!1)?e.fromJson(t.responseText):t.responseText},n=function(t){var n,a,f,l,h,p,d;d=r(),p=t.url,p||(p=location.href),n=t.async!==!1,e.UA.ie&&t.method==="GET"&&(p.indexOf("?")===-1?p+="?":p+="&",p+="_j3ts="+(new Date).getTime()+c++),t.method==="POST"&&(t.headers||(t.headers={}),t.headers["Cache-Control"]="no-cache"),t.method==="GET"&&t.data&&(h=new e.StringBuilder,o(t.data,h),p.indexOf("?")===-1?p+="?"+h.toString():p+="&"+h.toString()),d.open(t.method,p,n,t.username,t.password),f=t.headers,d.setRequestHeader("Content-Type",u[t.dataType]||u.form);if(f)for(l in f)f.hasOwnProperty(l)&&d.setRequestHeader(l,f[l]);return n&&(d.onreadystatechange=function(){if(d.readyState!==4)return;return t.callback&&t.callback.call(t.context,d,i(d),t.args)}),t.method==="GET"||!t.data?d.send(""):(a=new e.StringBuilder,s(a,t.data,t.dataType),d.send(a.toString())),d},l=["GET","POST","PUT","DELETE"],h=[];for(a=0,f=l.length;a<f;a++)t=l[a],h.push(e[t.toLowerCase()]=function(t){return function(){var r,i,s,o,u,a;return a=arguments[0],e.isObject(a)?u=a:(u={},arguments.length===3?(s=arguments[1],i=arguments[2],o=null):arguments.length===4?(o=arguments[1],s=arguments[2],i=arguments[3]):arguments.length===5&&(o=arguments[1],s=arguments[2],r=arguments[3],i=arguments[4]),u.method=t,u.data=o,u.dataType="json",u.url=a,u.callback=i,u.context=s,u.args=r),n(u)}}(t));return h}(j3),j3.DataItemsView={getItemsDatasource:function(){return this._itemsDatasource},setItemsDatasource:function(e){if(this._itemsDatasource===e)return;this._itemsDatasource=e;if(e)return e.bind(this,this.updateViewItems)},updateViewItems:function(e,t,n){if(this._updatingViewItems)return;return this._updatingViewItems=!0,this.onUpdateViewItems&&this.onUpdateViewItems(e,t,n),this._updatingViewItems=!1}},function(e){var t,n,r,i,s;return i=null,t=2300,s=t,n=function(){var t,n;return t=e.Dom,n=i.style,n.width=t.pageWidth()+"px",n.height=t.pageHeight()+"px"},r=function(){var t,r;return t=e.Dom,r=i.style,r.width=t.clientWidth()+"px",r.height=t.clientHeight()+"px",setTimeout(n,0)},e.Overlay={show:function(){var n;return i||(i=e.Dom.create("div"),document.body.appendChild(i),n=i.style,n.background="#000",n.position="absolute",n.top="0",n.left="0",e.Dom.opacity(i,.3),e.on(window,"resize",r)),s+=2,n=i.style,n.zIndex=s,s===t+2&&(n.display="block",r()),s},hide:function(){var e;if(!i)return;if(s===t)return;return s-=2,e=i.style,s===t?(e.width="0",e.height="0",e.display="none"):e.zIndex=s,s}}}(j3),j3.View=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m;return f=0,a=0,m={},v={},e.getView=function(e){return m[e]},o=function(){var t,n;this.el||(this.el=e.$(this.id));if(this.children){t=this.children.firstNode();while(t)o.call(t.value),t=t.next}n=this._options,this.onCreated&&this.onCreated(n),n.on&&this.on(n.on)},u=function(){var e;if(this.children){e=this.children.firstNode();while(e)u.call(e.value),e=e.next}this.onLoad&&this.onLoad(this._options),delete this._options},t=e.cls({template:e.template('<div id="<%=id%>" class="<%=css%>"></div>'),ctor:function(t){var n,r,i,s;a++,t==null&&(t={}),this._options=t,t.id&&(m[t.id]=this),this.el=t.el,this.id=t.id||"v_"+ ++f,e.isUndefined(t.name)||(this.name=t.name),this.parent=t.parent,this.page=t.page||this.parent&&this.parent.getPage()||null,this.ctnr=e.$(t.ctnr),!this.ctnr&&this.parent&&(this.ctnr=this.parent.getBody()),this.ctnr||(this.ctnr=document.body);if(this.defaultOptions){r=this.defaultOptions();for(i in r)s=r[i],t.hasOwnProperty(i)||(t[i]=s)}this.baseCss||(this.baseCss=""),t.css&&(this.css=t.css),this.onInit&&this.onInit(t),e.isUndefined(t.width)||(this._width=parseInt(t.width)),e.isUndefined(t.height)||(this._height=parseInt(t.height)),e.isUndefined(t.minWidth)||(this._minWidth=parseInt(t.minWidth)),e.isUndefined(t.maxWidth)||(this._maxWidth=parseInt(t.maxWidth)),e.isUndefined(t.maxHeight)||(this._maxHeight=parseInt(t.maxHeight)),e.isUndefined(t.minHeight)||(this._minHeight=parseInt(t.minHeight)),this._fill=parseInt(t.fill)||0,this.innerHTML=t.innerHTML,this.createChildren&&this.createChildren(t),a--;if(!this.parent||a===0)this.el||(n=new e.StringBuilder,this.render(n),e.Dom.append(this.ctnr,n.toString())),o.call(this),this.layout();this.parent?this.parent.getChildren().insert(this):v[this.id]=this,(!this.parent||a===0)&&u.call(this)},render:function(t){var n;n=!t,n&&(t=new e.StringBuilder),this.onRender(t,this.getTemplateData());if(n)return t.toString()},onRender:function(e,t){e.append(this.template(t))},getCss:function(){return this.css?this.baseCss?this.baseCss+" "+this.css:this.css:this.baseCss},getTemplateData:function(){return{id:this.id,css:this.getCss(),baseCss:this.baseCss,view:this}},getChildren:function(){return this.children||(this.children=new e.List),this.children},getChildByName:function(e){return this.children?this.children.tryUntil(function(t){return t.name===e}):null},addChild:function(e){return this.getChildren().insert(e)},createChildren:function(e){var t,n,r,i,s,o,u;if(!e.children)return;i=e.children.length-1,u=e.children;for(r=s=0,o=u.length;s<o;r=++s)n=u[r],t={index:r,first:r===0,last:r===i},n.parent=this,this.createChild(n,t)},createChild:function(t,n){var r;this.onCreateChild&&this.onCreateChild(t,n);if(!e.isFunction(t.cls))return;return r=new t.cls(t),this.onChildCreated&&this.onChildCreated(r,n,t)},getBody:function(){return this.elBody||this.el},layout:function(){var t,n,r;if(this._layouting)return;n=this.el.parentNode;if(!n)return;t=!0,this.canLayout&&(t=this.canLayout());if(!t)return;this.beforeLayout&&this.beforeLayout(),this._layouting=!0,n===document.body?r={width:this._fill&1?e.Dom.clientWidth():this._width,height:this._fill&2?e.Dom.clientHeight():this._height}:r={width:this._fill&1?e.Dom.width(n):this._width,height:this._fill&2?e.Dom.height(n):this._height},typeof this.onMeasure=="function"&&this.onMeasure(r),this.fire("measure",this,r),s.call(this,r.width),i.call(this,r.height),this.onLayout&&this.onLayout(r),this.layoutChildren(),this._layouting=!1},layoutChildren:function(){var e;if(!this.children)return;e=this.children.firstNode();while(e)e.value.layout(),e=e.next},width:function(e,t){if(arguments.length===0)return this._width;this._width=e;if(this._fill&1)return;this.onSetWidth(e);if(!t)return this.layoutChildren()},height:function(e,t){if(arguments.length===0)return this._height;this._height=e;if(this._fill&2)return;this.onSetHeight(e);if(!t)return this.layoutChildren()},onSetWidth:function(t){return e.Dom.offsetWidth(this.el,t)},onSetHeight:function(t){return e.Dom.offsetHeight(this.el,t)},getFill:function(){return this._fill},show:function(){return this._hidden=!1,e.Dom.show(this.el)},hide:function(){return this._hidden=!0,e.Dom.hide(this.el)},getVisible:function(){return!this._hidden},setVisible:function(e){return e?this.show():this.hide()},toggleVisible:function(){return this.setVisible(!this.getVisible())},getPage:function(){return this.page||this.parent&&this.parent.getPage()},notifyMessage:function(e,t,n){var r;r=this.getPage();if(r)return r(e,t,n)},destory:function(){this.onDestory&&this.onDestory(),this.destoryChildren(),this.parent&&this.parent.getChildren().remove(this);if(this.el)return e.Dom.remove(this.el)},destoryChildren:function(){var e;if(!this.children)return;e=this.children.firstNode();while(e)e.value.destory(),e=e.next}}),e.ext(t.prototype,e.EventManager),s=function(e){this._maxWidth&&e>this._maxWidth&&(e=this._maxWidth),this._minWidth&&e<this._minWidth&&(e=this._minWidth),this.onSetWidth(e)},i=function(e){return this._maxHeight&&e>this._maxHeight&&(e=this._maxHeight),this._minHeight&&e<this._minHeight&&(e=this._minHeight),this.onSetHeight(e)},d=!1,h=!1,c=0,l=0,p=null,r=function(t){var r,i,s;if(d){h=!0;return}r=e.Dom,s=r.clientWidth(),i=r.clientHeight();if(s===c&&i===l)return;return c=s,l=i,clearTimeout(p),p=setTimeout(n,100)},n=function(){var n,i,s,o;n=e.Dom,s=n.clientWidth(),i=n.clientHeight(),d=!0;for(o in v)t=v[o],t.layout();d=!1;if(h)return r()},e.on(window,"resize",r),t.genId=function(){return"v_"+ ++f},t.focusChild=function(){return this.children?this.children.tryUntil(function(e){return e.focus&&e.focus()}):!1},t}(j3),function(e){var t,n;if(e.isRunInServer())return;return n={},t=function(t,n){if(e.isArray(t))while(n){if(__indexOf.call(t,n)>=0)return!0;n=n.parentNode}else while(n){if(n===t)return!0;n=n.parentNode}return!1},e.regPopup=function(e,t,r){var i;t==null&&(t=""),i=n[t];if(i){if(i.view===e)return;i.view.close()}return n[t]={view:e,trigger:r}},e.unregPopup=function(e,t){var r;t==null&&(t=""),r=n[t];if(r&&r.view===e)return delete n[t]},e.on(document.body,"mousedown",function(e){var r,i,s,o,u;u=e.src();for(i in n){o=n[i];if(!o)continue;s=[o.view.el],o.trigger&&(s=s.concat(o.trigger)),r=t(s,u),r||(o.view.close(),delete n[i])}})}(j3),function(e){return e.HtmlView=e.cls(e.View,{baseCss:"",onInit:function(e){return this._tagName=e.tagName||"div",this._selfClosing=!!e.selfClosing,this._attributes=e.attributes||{},this._innerHTML=e.innerHTML},onRender:function(e){var t,n,r,i;e.a("<"+this._tagName),e.a(' id="'+this.id+'"'),r=this.getCss(),r&&e.a(' class="'+this.css+'"'),i=this._attributes;for(t in i)n=i[t],e.a(" "+t+'="'+n+'"');if(this._selfClosing){e.a("/>");return}return e.a(">"),e.a(this._innerHTML||""),e.a("</"+this._tagName+">")}})}(j3),j3.ContainerView=j3.cls(j3.View,{templateBegin:j3.template('<div id="<%=id%>" class="<%=css%>">'),templateEnd:j3.template("</div>"),onRender:function(e,t){return this.renderBegin(e,t),this.innerHTML?e.append(this.innerHTML):this.renderChildren(e),this.renderEnd(e,t)},renderBegin:function(e,t){e.append(this.templateBegin(t))},renderEnd:function(e,t){e.append(this.templateEnd(t))},renderChildren:function(e){var t;if(!this.children)return;t=this.children.firstNode();while(t)t.value.render(e),t=t.next}}),function(e){var t,n,r,i,s,o,u,a,f;return n=function(n){var i,s,o,u;s=u=n.src(),o=null;while(s&&s!==this.el){i=e.Dom.data(s,"cmd");if(i){n.stop(),r.call(this,i,s);return}o=s,s=s.parentNode}if(o&&s===this.el)return t.call(this,o,u)},t=function(t,n){var r,s,o;o=e.Dom.indexOf(t),s=i.call(this,o),r={data:s,src:n,index:o},this.beforeItemClick&&this.beforeItemClick(r);if(r.stop)return;this.fire("beforeItemClick",this,r);if(r.stop)return;return this._activeItemOnClick&&this.setActiveIndex(o),this._checkable&&this._checkItemOnClick&&this.toggleSelectedIndex(o,t),this._selectItemOnClick&&u.call(this,o,t),this.onItemClick&&this.onItemClick(r),this.fire("itemClick",this,r)},r=function(t,n){var r,s,o,u;u=null,o=n;while(o&&o!==this.el)u=o,o=o.parentNode;if(o===this.el)return s=i.call(this,e.Dom.indexOf(u)),r={name:t,data:s,src:n},typeof this.onCommand=="function"&&this.onCommand(r),this.fire("command",this,r)},a=function(t,n){var r,s,o,u;return r=e.Dom,s={},o="list-item-checked",u=i.call(this,t),r.hasCls(n,o)?(s.unselectedItems=[u],r.removeCls(n,o)):(s.selectedItems=[u],r.addCls(n,o)),f.call(this,s.selectedItems,s.unselectedItems),this.fire("selectedItemsChange",this,s)},u=function(t,n){var r,i;return r=e.Dom,i="list-item-checked",this._selectedItemEl&&r.removeCls(this._selectedItemEl,i),r.addCls(n,i),this._selectedItemEl=n},f=function(t,n){var r,i,s,o,u,a,f;this._selectedItems||(this._selectedItems=[]);if(t)for(s=0,u=t.length;s<u;s++)i=t[s],r=e.indexOf(this._selectedItems,i,this._itemDataEquals),r===-1&&this._selectedItems.push(i);if(n){f=[];for(o=0,a=n.length;o<a;o++)i=n[o],r=e.indexOf(this._selectedItems,i,this._itemDataEquals),r!==-1?f.push(this._selectedItems.splice(r,1)):f.push(void 0);return f}},i=function(e){var t;return t=this.getDatasource(),this._itemDataSelector(t.getAt(e))},o=function(){var t,n,r;if(!this.el)return;return t=e.Dom,r=this.el.firstChild,n=this.getDatasource(),n.forEach(this,function(n){var i;return i=this._itemDataSelector(n),e.indexOf(this._selectedItems,i,this._itemDataEquals)<0?t.removeCls(r,"list-item-checked"):t.addCls(r,"list-item-checked"),r=t.next(r)})},s=function(){return this._activeItemIndex===-1?this._activeItemEl=null:this._activeItemEl=e.Dom.byIndex(this.el,this._activeItemIndex),this._selectedItemIndex===-1?this._selectedItemEl=null:this._selectedItemEl=e.Dom.byIndex(this.el,this._selectedItemIndex)},e.DataList=e.cls(e.View,{baseCss:"data-list",onInit:function(t){return this._listItemRenderer=t.listItemRenderer,this._activeItemOnClick=t.activeItemOnClick,this._checkable=t.checkable,this._checkItemOnClick=!!t.checkItemOnClick,this._selectItemOnClick=!!t.selectedItemOnClick,this._itemDataSelector=e.compileSelector(t.itemDataSelector),this._itemDataEquals=e.compileEquals(t.itemDataEquals||["id"]),e.isArray(t.selectedItems)?this._selectedItems=t.selectedItems:this._selectedItems=t.selectedItems||[]},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._checkable?" data-list-checkable":"")}},onRender:function(e,t){return e.a('<div id="'+t.id+'" class="'+t.css+'">'),this.renderDataListItems(e,this.getDatasource()),e.a("</div>")},onCreated:function(t){return e.on(this.el,"click",this,n),this.setDatasource(t.datasource),s.call(this)},onUpdateView:function(t,n,r){var i;if(!this.el)return;return i=new e.StringBuilder,this.renderDataListItems(i,this.getDatasource()),this.el.innerHTML=i.toString(),s.call(this)},renderDataListItems:function(e,t){var n,r;this._activeItemIndex=-1,this._selectedItemIndex=-1;if(t)return n=null,this._activeItemOnClick&&(n=t.getActive()),r=t.count(),t.forEach(this,function(t,i,s){var o,u,a;return u=n===t,u&&(this._activeItemIndex=s),a=this.shouldListItemSelected(t),a&&(this._selectedItemIndex=s),o={index:s,count:r,data:t,active:u,checkable:this._checkable,checked:a},this.renderDataListItem(e,o)})},renderDataListItem:function(e,t){var n;return n="list-item",t.index===0&&(n+=" list-item-first"),t.index===t.count-1&&(n+=" list-item-last"),t.index%2&&(n+=" list-item-even"),t.active&&(n+=" list-item-active"),t.checked&&(n+=" list-item-checked"),t.count===1&&(n+=" list-item-single"),e.append('<div class="'+n+'">'),this.onRenderDataListItem(e,t),e.append("</div>")},onRenderDataListItem:function(t,n){if(this._listItemRenderer)return this._listItemRenderer(t,n,this);if(!e.isUndefined(n.data))return t.e(n.data.toString())},getActiveItem:function(){return this._activeItemIndex===-1?null:i.call(this,this._activeItemIndex)},getActiveIndex:function(){return this._activeItemIndex},setActiveIndex:function(e){var t,n,r;if(this._activeItemIndex===e)return;n=i.call(this,e),t={data:n,index:e},this.beforeActiveItem&&this.beforeActiveItem(t);if(t.stop)return;this.fire("beforeActiveItem",this,t);if(t.stop)return;return r=this.getDatasource(),r&&r.setActive(r.getAt(e)),this.fire("activeItemChange",this,t)},toggleSelectedIndex:function(t){var n;return n=e.Dom.byIndex(this.el,t),a.call(this,t,n)},getSelectedItems:function(){return this._selectedItems},getSelectedItem:function(){return!this._selectedItems||this._selectedItems.length===0?null:this._selectedItems[0]},setSelectedItems:function(t){return t&&!e.isArray(t)&&(t=[t]),this._selectedItems=t,o.call(this)},setSelectedItem:function(e){return e?this.setSelectedItems([e]):this.setSelectedItems(null)},shouldListItemSelected:function(t){var n;if(!this._selectedItems)return;return n=this._itemDataSelector(t),e.indexOf(this._selectedItems,n,this._itemDataEquals)>=0},getActiveItemEl:function(){return this._activeItemEl}}),e.ext(e.DataList.prototype,e.DataView),e.DataList.render=function(t,n){var r;return r="data-list",n.checkable&&(r+=" data-list-checkable"),n.css&&(r+=" "+n.css),t.a("<div"),n.id&&(t.a(' id="'),t.e(n.id),t.a('"')),t.a(' class="'),t.e(r),t.a('">'),e.DataList.renderDataListItems(t,n),t.a("</div>")},e.DataList.renderDataListItems=function(t,n){var r,i,s;s=n.items;if(!s)return;return i=e.count(s),r=n.checkable,e.forEach(s,this,function(s,o,u){var a;return a={index:u,count:i,data:s,checkable:r,contextData:n.contextData},e.DataList.renderDataListItem(t,a,n)})},e.DataList.renderDataListItem=function(e,t,n){var r;return r="list-item",t.index===0&&(r+=" list-item-first"),t.index===t.count-1&&(r+=" list-item-last"),t.index%2&&(r+=" list-item-even"),t.active&&(r+=" list-item-active"),t.checked&&(r+=" list-item-checked"),t.count===1&&(r+=" list-item-single"),e.a('<div class="'+r+'">'),n.itemRenderer.call(n.context,e,t),e.a("</div>")}}(j3),function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v;return u=function(t){var u,a,f,l;u=e.Dom,f=t.src(),l=null;while(f&&f!==this.el){a=u.data(f,"cmd");if(a){t.stop(),n.call(this,a,f);return}if(f.className==="list-item-chk"){s.call(this,f);return}if(u.hasCls(f,"list-item")){o.call(this,f);return}if(f.className==="list-group-chk"){r.call(this,f);return}if(f.className==="list-group-header"){i.call(this,f);return}f=f.parentNode}},t=function(){var t;return t=e.Dom.parent(this.src,".list-group"),t?a.call(this.sender,t):null},n=function(n,r){var i,s,o,u,l;i=e.Dom,l=null,u=r;while(u&&u!==this.el){if(i.hasCls(u,"list-item")){o=f.call(this,u);break}if(i.hasCls(u,"list-group")){o=a.call(this,u);break}u=u.parentNode}return s={sender:this,name:n,data:o,src:r,getGroupData:t},typeof this.onCommand=="function"&&this.onCommand(s),this.fire("command",this,s)},s=function(t){var n;return n=e.Dom.parent(t,".list-item"),p.call(this,n)},o=function(e){if(!this._itemCheckable||!this._checkItemOnClick)return;return p.call(this,e)},r=function(t){var n;return n=e.Dom.parent(t,".list-group"),h.call(this,n)},i=function(t){var n;if(!this._groupCheckable||!this._checkGroupOnClick)return;return n=e.Dom.parent(t,".list-group"),h.call(this,n)},p=function(t){var n,r,i,s;return n=e.Dom,r={},i="list-item-checked",s=f.call(this,t),n.hasCls(t,i)?(r.unselectedItems=[s],n.removeCls(t,i)):(r.selectedItems=[s],n.addCls(t,i)),v.call(this,r.selectedItems,r.unselectedItems),c.call(this),this.fire("selectedItemsChange",this,r)},v=function(t,n){var r,i,s,o,u,a;this._selectedItems||(this._selectedItems=[]);if(t)for(s=0,u=t.length;s<u;s++)i=t[s],r=e.indexOf(this._selectedItems,i,this._itemDataEquals),r===-1&&this._selectedItems.push(i);if(n)for(o=0,a=n.length;o<a;o++)i=n[o],r=e.indexOf(this._selectedItems,i,this._itemDataEquals),r!==-1&&this._selectedItems.splice(r,1)},c=function(){var t,n,r,i,s,o;if(!this.el)return;t=e.Dom,r=this.el.firstChild,o=[];while(r){n=r.lastChild,i=n.firstChild;while(i)s=f.call(this,i),e.indexOf(this._selectedItems,s,this._itemDataEquals)<0?t.removeCls(i,"list-item-checked"):t.addCls(i,"list-item-checked"),i=t.next(i);o.push(r=t.next(r))}return o},h=function(t){var n,r,i,s;return n=e.Dom,r={},i="list-group-checked",s=a.call(this,t),n.hasCls(t,i)?(r.unselectedGroups=[s],n.removeCls(t,i)):(r.selectedGroups=[s],n.addCls(t,i)),d.call(this,r.selectedGroups,r.unselectedGroups),this.fire("selectedGroupsChange",this,r)},d=function(t,n){var r,i,s,o,u,a;this._selectedGroups||(this._selectedGroups=[]);if(t)for(s=0,u=t.length;s<u;s++)r=t[s],i=e.indexOf(this._selectedGroups,r,this._groupDataEquals),i===-1&&this._selectedGroups.push(r);if(n)for(o=0,a=n.length;o<a;o++)r=n[o],i=e.indexOf(this._selectedGroups,r,this._groupDataEquals),i!==-1&&this._selectedGroups.splice(i,1)},f=function(t){return this._itemDataSelector(this.getDatasource().getById(e.Dom.data(t,"id")))},a=function(t){return this._groupDataSelector(this.getDatasource().getGroupById(e.Dom.data(t,"id")))},l=function(){var t;if(!this.el)return;return t=new e.StringBuilder,this.renderDataListGroups(t,this.getDatasource()),this.el.innerHTML=t.toString()},e.GroupedDataList=e.cls(e.View,{baseCss:"data-list-groups",onInit:function(t){return this._listCss=t.listCss,this._itemRenderer=t.itemRenderer,this._activeItemOnClick=t.activeItemOnClick,this._itemCheckable=t.itemCheckable,this._checkItemOnClick=!!t.checkItemOnClick,this._itemIdName=t.itemIdName||"id",this._itemDataSelector=e.compileSelector(t.itemDataSelector||this._itemIdName),this._itemDataEquals=e.compileEquals(t.itemDataEquals||[this._itemIdName]),this._shouldListItemSelected=t.shouldListItemSelected,this._selectedItemsEx=t.selectedItemsEx,this._groupRenderer=t.groupRenderer,this._groupCheckable=t.groupCheckable,this._checkGroupOnClick=!!t.checkGroupOnClick,this._groupIdName=t.groupIdName||"id",this._groupDataSelector=e.compileSelector(t.groupDataSelector||this._groupIdName),this._groupDataEquals=e.compileSelector(t.groupDataEquals||[this._groupIdName]),this._shouldListGroupSelected=t.shouldListGroupSelected,this._selectedGroupsEx=t.selectedGroupsEx},onRender:function(e,t){return e.a('<div id="'+t.id+'" class="'+t.css+'">'),this.renderDataListGroups(e,this.getDatasource()),e.a("</div>")},onCreated:function(t){return e.on(this.el,"click",this,u),this.setDatasource(t.datasource)},onUpdateView:function(e,t,n){return l.call(this)},renderDataListGroups:function(e,t){if(!t)return;return t.forEachGroup(this,function(t,n,r){var i;return i={data:t,checkable:this._groupCheckable,checked:this.shouldListGroupSelected(t),index:r},this.renderDataListGroup(e,i)})},renderDataListGroup:function(t,n){var r,i;return r="list-group",n.index===0&&(r+=" list-group-first"),n.checked&&(r+=" list-group-checked"),i=e.getVal(n.data,this._groupIdName),t.a('<div class="'+r+'" data-id="'+i+'">'),t.a('<div class="list-group-header">'),this.onRenderDataListGroup(t,n),t.a("</div>"),this.renderDataList(t,n.data.items),t.a("</div>")},onRenderDataListGroup:function(t,n){if(this._groupRenderer)return this._groupRenderer.call(this,t,n);if(!e.isUndefined(n.data))return t.e(n.data.toString())},renderDataList:function(e,t){var n,r;return r="data-list",this._itemCheckable&&(r+=" data-list-checkable"),this._listCss&&(r+=" "+this._listCss),n={buffer:e},this.beforeRenderDataList&&this.beforeRenderDataList(n),this.fire("beforeRenderDataList",this,n),e.a('<div class="'+r+'">'),this.renderDataListItems(e,t,null),e.a("</div>"),this.afterRenderDataList&&this.afterRenderDataList(n),this.fire("afterRenderDataList",this,n)},renderDataListItems:function(t,n,r){var i;this._activeItemIndex=-1;if(n)return i=e.count(n),e.forEach(n,this,function(e,n,s){var o,u;return u=r===e,u&&(this._activeItemIndex=s),o={index:s,count:i,data:e,active:u,checkable:this._itemCheckable,checked:this.shouldListItemSelected(e)},this.renderDataListItem(t,o)})},renderDataListItem:function(t,n){var r,i;return r="list-item",n.index===0?r+=" list-item-first":n.index===n.count-1&&(r+=" list-item-last"),n.index%2&&(r+=" list-item-even"),n.active&&(r+=" list-item-active"),n.checked&&(r+=" list-item-checked"),i=e.getVal(n.data,this._itemIdName),t.append('<div class="'+r+'" data-id="'+i+'">'),this.onRenderDataListItem(t,n),t.append("</div>")},onRenderDataListItem:function(t,n){if(this._itemRenderer)return this._itemRenderer.call(this,t,n);if(!e.isUndefined(n.data))return t.append(n.data.toString())},getSelectedGroups:function(){return this._selectedGroups},getSelectedItems:function(){return this._selectedItems},setSelectedItems:function(e){return this._selectedItems=e,c.call(this)},shouldListGroupSelected:function(t){var n;if(this._shouldListGroupSelected)return this._shouldListGroupSelected(t);if(!this._selectedGroupsEx)return;return n=this._groupDataEquals(t),!!e.tryUntil(this._selectedGroupsEx,function(e){if(this._groupDataEquals(e,n))return!0})},shouldListItemSelected:function(t){var n;if(this._shouldListItemSelected)return this._shouldListItemSelected(t);if(!this._selectedItems)return;return n=this._itemDataSelector(t),!!e.tryUntil(this._selectedItems,this,function(e){if(this._itemDataEquals(e,n))return!0})},getItemCheckable:function(){return this._itemCheckable},setItemCheckable:function(e){return this._itemCheckable=!!e},getGroupCheckable:function(){return this._groupCheckable},setGroupCheckable:function(e){return this._groupCheckable=!!e},setSelectedItemsEx:function(e){return this._selectedItemsEx=e}}),e.ext(e.GroupedDataList.prototype,e.DataView)}(j3),function(e){var t,n,r;return e.Pagination=t=e.cls(e.ContainerView,{baseCss:"pgn",onInit:function(e){return this._pageSize=e.pageSize||50,this._pageNum=e.pageNum||1,this._entryCount=e.entryCount||0,this._align=e.align,this._hidePrevNextButtons=e.hidePrevNextButtons,this._hidePageButtons=e.hidePageButtons,this._autoHide=e.autoHide},render:function(e){var t;return e.a('<div id="'+this.id+'" class="'+this.getCss()+'"'),this._autoHide&&(t=this.getPageCount(),t===1&&e.a(' style="display:none"')),e.a(">"),r.call(this,e),e.a("</div>")},onCreated:function(){return e.on(this.el,"click",this,n)},refresh:function(){var t,n;n=new e.StringBuilder,r.call(this,n),this.el.innerHTML=n.toString();if(this._autoHide)return t=this.getPageCount(),t===1?this.hide():this.show()},getPageNum:function(){return this._pageNum},setPageNum:function(e,t){e=e||1;if(this._pageNum===e)return;return this._pageNum=e,t||this.refresh(),this.fire("pageNumChange",this)},getPageSize:function(){return this._pageSize},setPageSize:function(e,t){return this._pageSize=e||50,this.setPageNum(1)},getEntryCount:function(){return this._entryCount},setEntryCount:function(e,t){this._entryCount=e||0;if(!t)return this.refresh()},getPageCount:function(){return this._entryCount===0?1:Math.floor((this._entryCount-1)/this._pageSize)+1}}),r=function(e){var t,n,r;n=this.getPageCount(),this._hidePrevNextButtons||(this._pageNum!==1&&e.a('<a class="pgn-prev" href="javascript:;" data-cmd="prev">&lt;</a>'),this._pageNum!==n&&e.a('<a class="pgn-next" href="javascript:;" data-cmd="next">&gt;</a>')),e.a('<ul class="'),this._align==="left"?e.a("pull-left"):this._align==="right"&&e.a("pull-right"),e.a('">');for(t=r=1;1<=n?r<=n:r>=n;t=1<=n?++r:--r)this._pageNum===t?(e.a('<li class="active">'),e.a("<a>"+t+"</a>")):(e.a("<li>"),e.a('<a href="javascript:;" data-cmd="page" data-page="'+t+'">'+t+"</a>")),e.a("</li>");return e.a("</ul>")},n=function(t){var n,r;r=t.src(),n=e.Dom.data(r,"cmd");if(!n)return;switch(n){case"prev":return this.setPageNum(this.getPageNum()-1);case"next":return this.setPageNum(this.getPageNum()+1);case"page":return this.setPageNum(parseInt(e.Dom.data(r,"page")))}}}(j3),function(e){return e.BoxWithArrow=e.cls(e.ContainerView,{baseCss:"box-with-arrow",templateBegin:e.template('<div id="<%=id%>" class="<%=css%>"><div class="box-arrow"></div><div class="box">'),templateEnd:e.template("</div></div>"),onInit:function(e){return this._placement=e.placement||"top"},getTemplateData:function(){return{id:this.id,css:this.getCss()+" "+this.baseCss+"-"+this._placement}},onCreated:function(t){return this.elBody=e.Dom.byIndex(this.el,1)}})}(j3),function(e){var t,n,r;return e.Tooltip=t=e.cls(e.BoxWithArrow,{css:"tooltip",onInit:function(e){return this._content=e.content||"",this._encodeContent=!!e.encodeContent,t.base().onInit.call(this,e)},renderChildren:function(e){return this._encodeContent?e.e(this._content):e.a(this._content)},getContent:function(){return this._content},setContent:function(t,n){return this._content=t,this._encodeContent=!!n,this.getBody().innerHTML=this._encodeContent?e.htmlEncode(this._content):this._content},show:function(t){var n;return n=e.Dom,n.show(this.el),n.place(this.el,t.x-this.el.offsetWidth/2,t.y)},hide:function(){return e.Dom.hide(this.el),this.fire("hide",this)}}),r=null,n=function(){return r?r:r=new e.Pool({onCreate:function(e){var n;return n=new t(e),n.on("hide",function(e,t){return r.release(e)}),n},onInit:function(e,t){return e.setContent(t.content,t.encodeContent),e.show(t.pointAt)}})},e.Tooltip.show=function(e){var t,r;return(r=e.placement)==null&&(e.placement="top"),t=n().gain(e)}}(j3),function(e){var t,n,r,i,s;return t=function(e){this.click();if(this._linkButton&&this._commandMode)return e.stop()},r=function(e){return s.call(this)},n=function(e){return i.call(this)},s=function(){var t,n,r,i;if(!this._tip)return;return t=e.Dom,r=t.position(this.el),i=t.offsetWidth(this.el),n=t.offsetHeight(this.el),this._tooltip=e.Tooltip.show({content:this._tip,encodeContent:!0,pointAt:{x:r.left+i/2,y:r.top+n}})},i=function(){if(!this._tooltip)return;return this._tooltip.hide(),this._tooltip=null},e.Button=e.cls(e.View,{baseCss:"btn",template:e.template('<<%=linkButton?"a":"button"%> <%if(linkButton){%>href="<%=url%>"<%}else{%>type="<%=primary ? "submit" : "button"%>"<%}%> id="<%=id%>" class="<%=css%>"<%if(disabled){%> disabled="disabled"<%}%>><%if(icon){%><i class="<%=icon%>"></i><%}%><%if(icon && text){%><%=" "%><%}%><%=text%></<%=linkButton?"a":"button"%>>'),onInit:function(e){return this._text=e.text||"",this._tip=e.tip,this._icon=e.icon,this._primary=!!e.primary,this._disabled=!!e.disabled,this._active=!!e.active,this._toggle=e.toggle,this._linkButton=!!e.linkButton,this._url=e.url,this._commandMode=e.commandMode},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._primary?" btn-primary":"")+(this._disabled?" disabled":"")+(this._active?" active":""),text:this._text,icon:this._icon,primary:this._primary,disabled:this._disabled,linkButton:this._linkButton,url:this._url}},onCreated:function(i){this._icon&&(this._elIcon=this.el.firstChild),e.on(this.el,"click",this,t);if(!e.UA.supportTouch)return e.on(this.el,"mouseover",this,r),e.on(this.el,"mouseout",this,n)},getPrimary:function(){return this._primary},getText:function(){return this._text},setText:function(t){return this._text=t||"",this.el.innerHTML=e.htmlEncode(this._text)},getUrl:function(){return this._url},setUrl:function(e){this._linkButton&&(this._url=e,this.el.href=e)},getDisabled:function(){return this._disabled},setDisabled:function(t){this._disabled=!!t,this.el.disabled=this._disabled,this._disabled?e.Dom.addCls(this.el,"disabled"):e.Dom.removeCls(this.el,"disabled")},getActive:function(){return this._active},setActive:function(t){t=!!t;if(this._active===t)return;this._active=t,this._active?e.Dom.addCls(this.el,"active"):e.Dom.removeCls(this.el,"active"),this.fire(this._active?"active":"inactive",this,{active:this._active})},click:function(){var e;if(this._disabled)return;e=this.getActive(),this._toggle==="exclusive"?this.setActive(!e):this._toggle==="radio"&&!e&&this.setActive(!0),this.fire("click",this)},focus:function(){return this.el.focus()},blur:function(){return this.el.blur()},setIcon:function(e){return this._icon=e,this._elIcon.className=e},getTip:function(){return this._tip},setTip:function(e){return this._tip=e},showTip:function(){s.call(this)},hideTip:function(){i.call(this)}})}(j3),function(e){var t,n,r;return n=function(e,t){if(this._toggle==="radio"||this._toggle==="exclusive")this._activeButton&&this._activeButton.setActive(!1),this._activeButton=e;return this.fire("active",this,{button:e})},r=function(e,t){return this._toggle==="exclusive"&&(this._activeButton=e.getActive()?e:null),this.fire("click",e,t)},e.ButtonGroup=t=e.cls(e.ContainerView,{baseCss:"btn-grp",onInit:function(e){return this._toggle=e.toggle,this._label=e.label},onCreateChild:function(t,n){t.cls=e.Button,n.first&&(t.css="first"),n.last&&(t.css="last"),this._toggle&&(t.toggle=this._toggle)},renderChildren:function(e){return this._label&&(e.a('<div class="btn-grp-lbl">'),e.e(this._label),e.a("</div>")),t.base().renderChildren.apply(this,arguments)},onChildCreated:function(e){e.on("click",this,r),e.on("active",this,n);if(e.getActive())return this._activeButton=e},setActiveButtonByName:function(e){return this.getChildren().forEach(function(t){var n;n=t.name===e,t.setActive(n);if(n)return this._activeButton=t})}})}(j3),function(e){var t;return t=function(e){if(e.keyCode()===32)return this.click(),e.stop()},e.Checkbox=e.cls(e.View,{baseCss:"chk",template:e.template('<a id="<%=id%>" class="<%=css%>" href="javascript:;"><i></i><span><%-text%></span></a>'),onInit:function(e){return this._text=e.text||"",this._disabled=!!e.disabled,this._checked=!!e.checked,this._value=e.value,this._bindingMode=e.bindingMode||"checked"},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._disabled?" "+this.baseCss+"-disabled":"")+(this._checked?" "+this.baseCss+"-checked":""),text:this._text}},onCreated:function(n){return e.on(this.el,"click",this,this.click),e.on(this.el,"keypress",this,t),this._elText=e.Dom.byIndex(this.el,1),this.setDatasource(n.datasource)},getText:function(){return this._text},setText:function(t){return this._text=t||"",this._elText.innerHTML=e.htmlEncode(this._text)},getValue:function(){return this._value},setValue:function(e){this._value=e;if(this._checked&&this._bindingMode==="value")return this.updateData()},getDisabled:function(){return this._disabled},setDisabled:function(t){var n;return this._disabled=!!t,n=this.baseCss+"-disabled",this._disabled?e.Dom.addCls(this.el,n):e.Dom.removeCls(this.el,n)},getChecked:function(){return this._checked},setChecked:function(t){var n;t=!!t;if(this._checked===t)return;return this._checked=t,n=this.baseCss+"-checked",this._checked?e.Dom.addCls(this.el,n):e.Dom.removeCls(this.el,n),this.fire("change",this,{checked:this._checked}),this.updateData()},click:function(){if(!this.getDisabled())return this.setChecked(!this.getChecked())},focus:function(){return this.el.focus()},blur:function(){return this.el.blur()},onUpdateData:function(e){var t;this._bindingMode==="value"?t=this.getChecked()?this.getValue():null:t=this.getChecked();if(this.name)return e.set(this.name,t)},onUpdateView:function(e,t,n){var r;if(n&&n.changedData&&!n.changedData.hasOwnProperty(this.name))return;return r=e.get(this.name),this._bindingMode==="value"?this.setChecked(this.getValue()===r):this.setChecked(r)}}),e.ext(e.Checkbox.prototype,e.DataView)}(j3),function(e){var t,n;return e.CheckboxList=e.cls(e.ContainerView,{baseCss:"chk-list",onInit:function(e){return this._itemInline=!!e.itemInline,this._itemWidth=e.itemWidth,this._items=e.items,this._itemsDatasource=e.itemsDatasource,this._bindingMode=e.bindingMode||"array",this.setSelectedValue(e.selectedValue),this.setDatasource(e.datasource)},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._itemInline?" "+this.baseCss+"-inline":""),text:this._text}},createChildren:function(r){var i,s,o;s=this._items||this._itemsDatasource;if(!s)return;return i=this._bindingMode,o=this._selectedValue,e.forEach(s,this,function(r){var s,u;return u=e.getVal(r,"value"),s={parent:this,text:e.getVal(r,"text"),value:u,inline:this._itemInline,checked:n(o,u,i),on:{change:{c:this,h:t}}},this._itemInline&&this._itemWidth&&(s.width=this._itemWidth),new e.Checkbox(s)})},onUpdateData:function(){var t;return t=this.getDatasource(),t.set(this.name,e.clone(this._selectedValue))},onUpdateView:function(t,r,i){var s;this.setSelectedValue(t.get(this.name));if(!this.el)return;return this._updatingSubComponent=!0,s=this._bindingMode,e.forEach(this.children,this,function(e){return e.setChecked(n(this._selectedValue,e.getValue(),s))}),this._updatingSubComponent=!1},getSelectedValue:function(){return this._selectedValue},setSelectedValue:function(t){return t?this._selectedValue=e.clone(t):this._bindingMode==="array"?this._selectedValue=[]:this._selectedValue=0}}),e.ext(e.CheckboxList.prototype,e.DataView),n=function(t,n,r){if(r==="bit")return!!(t&n);if(r==="array")return-1!==e.indexOf(t,n)},t=function(t,n){var r,i,s;if(this._updatingSubComponent)return;return r=this._bindingMode,s=t.getValue(),r==="bit"?t.getChecked()?this._selectedValue|=s:this._selectedValue&=~s:r==="array"&&(t.getChecked()?this._selectedValue.push(s):(i=e.indexOf(this._selectedValue,s),i!==-1&&this._selectedValue.splice(i,1))),this.updateData()}}(j3),function(e){var t,n,r,i,s,o;return s=function(){return this._updatingView=!0,this._elInput.value=this._text,e.Dom.removeCls(this._elInput,this.baseCss+"-empty"),this._updatingView=!1,this.fire("focus",this)},r=function(){return this._updatingView=!0,this._text||e.Dom.addCls(this._elInput,this.baseCss+"-empty"),this._updatingView=!1,this.fire("blur",this)},o=function(e){return i.call(this),this.fire("keyup",this,{keyCode:e.keyCode()})},i=function(){var r;if(this._updatingView)return;r=this._elInput.value;if(this._text===r)return;return this._text=r,e.Dom.removeCls(this._elInput,this.baseCss+"-empty"),e.UA.ie&&n.call(this),this._multiline&&this._autoHeight&&t.call(this),this.updateData(),this.fire("change",this)},n=function(){this._elInput.placeholder="";if(this._text&&this._placeholder&&this._elPlaceholder){e.Dom.hide(this._elPlaceholder);return}if(!!this._placeholder)return this._elPlaceholder?e.Dom.show(this._elPlaceholder):(this._elPlaceholder=document.createElement("span"),this._elPlaceholder.className="input-placeholder",this.el.appendChild(this._elPlaceholder),e.on(this._elPlaceholder,"click",this,function(e){return this._elInput.focus()})),this._elPlaceholder.innerHTML=e.htmlEncode(this._placeholder);if(this._elPlaceholder)return e.Dom.hide(this._elPlaceholder)},t=function(){var n,r;n=this._elInput;if(n.scrollHeight>n.offsetHeight-2)return this._originalHeight||(this._originalHeight=e.Dom.height(n)),e.Dom.height(n,n.scrollHeight+2);if(this._originalHeight){r=e.Dom.height(n);if(r>this._originalHeight)return e.Dom.height(n,r-20),t.call(this)}},e.Textbox=e.cls(e.View,{baseCss:"input",templateInput:e.template('<div id="<%=id%>" class="input-ctnr <%=css%>"><input type="<%=type%>" class="<%=inputCss%>" name="<%=name%>"<%if(disabled){%> disabled="disabled"<%}%><%if(readOnly){%> readonly="readonly"<%}%><%if(placeholder){%> placeholder="<%-placeholder%>"<%}%> value="<%-text%>" /></div>'),templateTextarea:e.template('<div id="<%=id%>" class="input-ctnr <%=css%>"><textarea class="<%=inputCss%>" name="<%=name%>"<%if(disabled){%> disabled="disabled"<%}%><%if(readOnly){%> readonly="readonly"<%}%><%if(placeholder){%> placeholder="<%-placeholder%>"<%}%> row="<%=row%>"><%-text%></textarea></div>'),onInit:function(e){return this._text=e.text||"",this._primary=!!e.primary,this._disabled=!!e.disabled,this._readOnly=!!e.readOnly,this._type=e.type||"text",this._multiline=this._type==="text"&&!!e.multiline,this._multiline&&(this._row=e.row||3),this._autoHeight=!!e.autoHeight,this._placeholder=e.placeholder||""},getTemplateData:function(){return{id:this.id,css:this.css,inputCss:"input"+(this._disabled?" disabled":"")+(this._multiline?" input-multiline":"")+(this._text?void 0:" "+this.baseCss+"-empty"),text:this._text,disabled:this._disabled,readOnly:this._readOnly,type:this._type,name:this.name,row:this._row,placeholder:this._placeholder}},onRender:function(e){var t;this._multiline?t=this.templateTextarea:t=this.templateInput,e.append(t(this.getTemplateData()))},onCreated:function(t){this._elInput=this.el.firstChild,e.on(this._elInput,"focus",this,s),e.on(this._elInput,"blur",this,r),e.on(this._elInput,"keyup",this,o),e.on(this._elInput,"change",this,i),this.setDatasource(t.datasource),e.UA.ie&&this._placeholder&&n.call(this)},getText:function(){return this._text||""},setText:function(r){r=r||"";if(this._text===r)return;return this._text=r,this._updatingView=!0,this._text?(this._elInput.value=this._text,e.Dom.removeCls(this._elInput,this.baseCss+"-empty")):(this._elInput.value="",e.Dom.addCls(this._elInput,this.baseCss+"-empty")),e.UA.ie&&n.call(this),this._multiline&&this._autoHeight&&t.call(this),this._updatingView=!1,this.updateData(),this.fire("change",this)},getDisabled:function(){return this._disabled},setDisabled:function(t){return this._disabled=!!t,this._elInput.disabled=this._disabled,e.Dom.toggleCls(this._elInput,"disabled")},getReadOnly:function(){return this._elInput.readOnly},setReadOnly:function(e){return this._elInput.readOnly=!!e},focus:function(){return this.getDisabled()||this.getReadOnly()?!1:(this._elInput.focus(),this._elInput.select(-1,-1),!0)},blur:function(){return this._elInput.blur()},getPlaceholder:function(){return this._placeholder},setPlaceholder:function(t){return this._placeholder=t||"",e.UA.ie?n.call(this):this._elInput.placeholder=this._placeholder},onUpdateData:function(){return this._datasource.set(this.name,this._text)},onUpdateView:function(e,t,n){if(n&&n.changedData&&!n.changedData.hasOwnProperty(this.name))return;return this.setText(e.get(this.name))},onSetWidth:function(t){return e.Dom.offsetWidth(this._elInput,t)},onSetHeight:function(t){return e.Dom.offsetHeight(this._elInput,t)}}),e.ext(e.Textbox.prototype,e.DataView)}(j3),function(e){var t,n,r,i;return r=function(e){var t;return t=e.max-e.min,t?Math.floor(e.value*100/t):0},n=function(t){var n;switch(t.indicator){case"none":return"";case"percentage":return t.percentage+"%";case"progress":return t.value+" / "+t.max;case"text":return t.percentage===0?n=t.preparingText:t.percentage===100?n=t.completedText:n=t.processingtext,e.htmlEncode(n)}},i=function(){var e,t,i;return e={min:this._min,max:this._max,value:this._value,preparingText:this._preparingText,processingtext:this._processingtext,completedText:this._completedText,indicator:this._indicator},e.percentage=r(e),t=n(e),this._elBg.innerHTML=t,this._elText.innerHTML=t,i=100-e.percentage,this._elInner.style.marginLeft="-"+i+"%",this._elDone.style.marginLeft=i+"%",this._elText.style.marginLeft=i+"%"},e.ProgressBar=t=e.cls(e.View,{baseCss:"prg-bar",onInit:function(e){return this._min=e.min||0,this._max=e.max||100,this._value=e.value||0,this._indicator=e.indicator||"percentage",this._preparingText=e.preparingText,this._processingtext=e.processingText,this._completedText=e.completedText,this._inline=e.inline,this._gray=e.gray,this._warning=e.warning,this._danger=e.danger},getTemplateData:function(){return{id:this.id,css:this.css}},onRender:function(e,n){return t.render(e,{id:n.id,css:this.getCss(),min:this._min,max:this._max,value:this._value,preparingText:this._preparingText,processingtext:this._processingtext,completedText:this._completedText,indicator:this._indicator,inline:this._inline,gray:this._gray,warning:this._warning,danger:this._danger})},onCreated:function(){var t;return t=e.Dom,this._elBg=t.firstChild(this.el),this._elInner=t.next(this._elBg),this._elDone=t.firstChild(this._elInner),this._elText=t.next(this._elDone)},getMin:function(){return this._min},setMin:function(e){return this._min=e,i.call(this)},getMax:function(){return this._max},setMax:function(e){return this._max=e,i.call(this)},getValue:function(){return this._value},setValue:function(e){return this._value=e,i.call(this)},getPercentage:function(){return r({min:this._min,max:this._max,value:this._value})}}),t.render=function(t,i){var s,o,u;return e.isUndefined(i.indicator)&&(i.indicator="percentage"),e.isUndefined(i.min)&&(i.min=0),e.isUndefined(i.max)&&(i.max=100),e.isUndefined(i.value)&&(i.value=0),i.percentage=r(i),o=n(i),s="prg-bar",i.inline&&(s+=" prg-bar-inline"),i.gray&&(s+=" prg-bar-gray"),i.warning&&(s+=" prg-bar-warning"),i.danger&&(s+=" prg-bar-danger"),i.css&&(s+=" "+i.css),t.a('<div class="'+s+'"'),i.id&&t.a(' id="'+i.id+'"'),t.a(">"),t.a('<div class="prg-bar-bg">'),t.a(o),t.a("</div>"),u=100-i.percentage,t.a('<div class="prg-bar-inner" style="margin-left:-'),t.a(u),t.a('%">'),t.a('<div class="prg-bar-done" style="margin-left:'),t.a(u),t.a('%"></div>'),t.a('<div class="prg-bar-text" style="margin-left:'),t.a(u),t.a('%">'),t.a(o),t.a("</div>"),t.a("</div>"),t.a("</div>")}}(j3),function(e){return e.Bookmark={},e.Bookmark.render=function(e,t){var n,r;return n="bookmark",r=n,t.gray&&(r+=" "+n+"-gray"),t.warning&&(r+=" "+n+"-warning"),t.danger&&(r+=" "+n+"-danger"),t.icon&&(r+=" "+n+"-with-icon"),t.iconGray&&(r+=" "+n+"-with-icon-gray"),t.iconWarning&&(r+=" "+n+"-with-icon-warning"),t.iconDanger&&(r+=" "+n+"-with-icon-danger"),t.css&&(r+=" "+r),e.a("<div"),t.id&&e.a(' id="'+t.id+'"'),e.a(' class="'+r+'">'),t.icon&&(e.a('<span class="bookmark-icon"><i class="'),e.a(t.icon),e.a('"></i></span>')),e.a('<span class="bookmark-label">'),e.e(t.text),e.a("</span>"),e.a('<span class="bookmark-shadow"></span>'),e.a("</div>")}}(j3),j3.Calendar=function(){var e,t,n,r;return t=function(e,t,n){var r;return r=new j3.DateTime(e,t,1),r=r.addDay(0-r.getDayOfWeek()+n),r.getMonth()===t&&r.getDay()>1&&(r=r.addDay(-7)),r},n=function(e){var t,n,r,i,s;i=e.src();if(i.tagName!=="A")return;return n=i.parentNode,s=n.parentNode.rowIndex,t=n.cellIndex,r=this._firstDateOfMonthView.addDay((s-1)*7+t),this.setCurrentDate(r)},r=function(){return this._elCurYearMonth.innerHTML=this._year+" - "+this._month},e=j3.cls(j3.View,{baseCss:"cld",onInit:function(e){var t,n;(n=e.firstDayOfWeek)==null&&(e.firstDayOfWeek=1),this._firstDayOfWeek=e.firstDayOfWeek%7,this._date=e.date,t=j3.DateTime.today(),e.year?this._year=e.year:this._date?this._year=this._date.getYear():this._year=t.getYear(),e.month?this._month=e.month:this._date?this._month=this._date.getMonth():this._month=t.getMonth()},render:function(e){e.append('<div id="'+this.id+'" class="'+this.getCss()+'">'),e.append('<div class="'+this.baseCss+'-top">'),e.append('<a class="'+this.baseCss+'-next-month"></a>'),e.append('<a class="'+this.baseCss+'-prev-month"></a>'),e.append('<div class="'+this.baseCss+'-cur-year-month"></div>'),e.append("</div>"),e.append('<div class="'+this.baseCss+'-month-view">'),this.renderMonthView(e),e.append("</div>"),e.append("</div>")},renderMonthView:function(e){var n,r,i,s,o,u,a,f,l;e.append("<table><tr>");for(r=a=0;a<7;r=++a)n=(this._firstDayOfWeek+r)%7,e.append('<th class="'+this.baseCss+'-weekday-"'+n+">"+j3.Lang.dayNameAbb[n]+"</th>");e.append("</tr>"),u=j3.DateTime.today(),this._firstDateOfMonthView=t(this._year,this._month,this._firstDayOfWeek),this._lastDateOfMonthView=this._firstDateOfMonthView.addDay(42),o=this._firstDateOfMonthView;for(r=f=0;f<6;r=++f){e.append("<tr>");for(s=l=0;l<7;s=++l)i=o.equals(this._date),e.append('<td class="'),e.append(this.baseCss+"-weekday-"+o.getDayOfWeek()),o.equals(u)&&e.append(" "+this.baseCss+"-today"),i&&e.append(" active"),e.append('"><a>'+o.getDay()+"</a></td>"),o=o.addDay(1);e.append("</tr>")}e.append("</table>")},onCreated:function(){var e;return e=j3.Dom,this._elCldTop=e.firstChild(this.el),this._elNextMonth=e.firstChild(this._elCldTop),this._elPrevMonth=e.next(this._elNextMonth),this._elCurYearMonth=e.next(this._elPrevMonth),this._elMonthView=e.next(this._elCldTop),j3.on(this._elMonthView,"click",this,n),j3.on(this._elPrevMonth,"click",this,function(){return this._month--,this._month===0&&(this._year--,this._month=12),this.refreshMonthView()}),j3.on(this._elNextMonth,"click",this,function(){return this._month++,this._month===13&&(this._year++,this._month=1),this.refreshMonthView()}),r.call(this)},refreshMonthView:function(){var e;return e=new j3.StringBuilder,this.renderMonthView(e),this._elMonthView.innerHTML=e.toString(),r.call(this)},getCurrentDate:function(){return this._date},setCurrentDate:function(e){var t,n;if(j3.DateTime.equals(this._date,e))return;return n=this._date,this._date=e,t=this._date||j3.DateTime.today(),this._year=t.getYear(),this._month=t.getMonth(),this.refreshMonthView(),this.fire("change",this,{oldDate:n,curDate:e})}}),e}(),function(e){var t,n,r;return r=function(){var t,n,r,i,s,o,u;s=new e.StringBuilder,n=!0;if(this._multiple){i=this.getSelectedItems();if(i&&i.length)for(o=0,u=i.length;o<u;o++){r=i[o];if(!r)continue;n=!1,s.a('<div class="sel-lbl">'),s.e(r.text||r.name||r.value),s.a('<i data-cmd="unselect" class="sel-icon-unselect"></i>'),s.a("</div>")}else s.e(this._placeholder)}else r=this.getSelectedItem(),r?(n=!1,s.e(r.text||r.name||r.value)):s.e(this._placeholder);return this._elLbls.innerHTML=s.toString(),t=this.baseCss+"-empty",n?e.Dom.addCls(this.el,t):e.Dom.removeCls(this.el,t)},t=function(e){return this.onTriggerClick&&this.onTriggerClick()},n=function(e){var t;t=e.keyCode();if(t===13||t===40)return this.onTriggerClick&&this.onTriggerClick(),e.stop()},e.Selector=e.cls(e.View,{baseCss:"sel",template:e.template('<div id="<%=id%>" class="<%=css%>"<%if(disabled){%> disabled="disabled"<%}%> tabindex="0"><div class="sel-inner"><%if(icon){%><div class="sel-icon"><i class="<%=icon%>"></i></div><%}%><div class="sel-bar"><div class="sel-lbls"></div></div><a class="sel-trigger"><i class="<%=cssTrigger%>"></i></a></div></div>'),onInit:function(e){return this._disabled=!!e.disabled,this._multiple=!!e.multiple,this._placeholder=e.placeholder||"",this._mini=e.mini,this._icon=e.icon},onCreated:function(){var r;return r=e.Dom,this.elInner=r.firstChild(this.el),this._elIcon=r.byCls(this.elInner,"sel-icon"),this._elBar=r.byCls(this.elInner,"sel-bar"),this._elTrigger=r.next(this._elBar),this._elLbls=r.firstChild(this._elBar),e.on(this._elTrigger,"click",this,function(){return this.onTriggerClick&&this.onTriggerClick()}),e.on(this._elBar,"click",this,t),this._elIcon&&e.on(this._elIcon,"click",this,t),e.on(this.el,"keydown",this,n)},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._mini?" sel-mini":"")+(this._disabled?" disabled":""),cssTrigger:this.cssTrigger,disabled:this._disabled,icon:this._icon}},getDisabled:function(){return this._disabled},setDisabled:function(t){return this._disabled=!!t,this._disabled?e.Dom.addCls(this.el,"disabled"):e.Dom.removeCls(this.el,"disabled")},getMultiple:function(){return this._multiple},setMultiple:function(e){return this._multiple=e},getSelectedItem:function(){return this._selectedItems&&this._selectedItems.length?this._selectedItems[0]:null},getSelectedItems:function(){return this._selectedItems||[]},setSelectedItem:function(e){return this.setSelectedItems(e)},setSelectedItems:function(e){return this.doSetSelectedItems(e),typeof this.onSetSelectedItems=="function"?this.onSetSelectedItems():void 0},doSetSelectedItems:function(t){return t&&!e.isArray(t)&&(t=[t]),this._selectedItems=t||[],r.call(this)},updateSubcomponent:function(){return this._updatingSubcomponent=!0,typeof this.onUpdateSubcomponent=="function"&&this.onUpdateSubcomponent(),this._updatingSubcomponent=!1},isUpdatingSubcomponent:function(){return this._updatingSubcomponent},getPlaceholder:function(){return this._placeholder},setPlaceholder:function(t){this._placeholder=t||"";if(e.Dom.hasCls(this.el,this.baseCss+"-empty"))return this._elLbls.innerHTML=e.htmlEncode(this._placeholder)},onSetWidth:function(t){var n,r;return n=e.Dom,n.offsetWidth(this.el,t),r=n.width(this.elInner)-n.offsetWidth(this._elTrigger),this._elIcon&&(r-=n.offsetWidth(this._elIcon)),n.offsetWidth(this._elBar,r)}})}(j3),function(e){return e.SelectorGroup=e.cls(e.ContainerView,{baseCss:"sel-grp"})}(j3),j3.Dropdown=j3.cls(j3.Selector,{cssTrigger:"icon-drp-down",onInit:function(e){j3.Dropdown.base().onInit.call(this,e);if(!j3.isUndefined(e.boxWidth))return this._boxWidth=parseInt(e.boxWidth)},onTriggerClick:function(){this._isDropdown?this.close():this.dropdown()},isDropdown:function(){return this._isDropdown},dropdown:function(){var e,t,n,r;if(this.getDisabled())return;e=j3.Dom,r=!this._elDropdownBox,t={firstTime:r},r&&(n=document.createElement("div"),n.className="drp-box",this._elDropdownBox=n,e.append(this.elInner,n),this.onCreateDropdownBox(this._elDropdownBox)),typeof this.beforeDropdown=="function"&&this.beforeDropdown(t);if(t.stop)return;this.fire("beforeDropdown",this,t);if(t.stop)return;j3.regPopup(this,"dropdown"),e.addCls(this.el,"sel-active"),e.show(this._elDropdownBox),this.resizeDropdownBox(),typeof this.onDropdown=="function"&&this.onDropdown(t),this.fire("dropdown",this,t),this._isDropdown=!0},resizeDropdownBox:function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d;e=j3.Dom,o=e.position(this.el),n=e.offsetHeight(this.el),e.place(this._elDropdownBox,o.left,o.top+n+2),this._boxWidth>0?e.offsetWidth(this._elDropdownBox,this._boxWidth):(this._elDropdownBox.style.width="",p=e.offsetWidth(this.el),h=e.offsetWidth(this._elDropdownBox),h<p&&e.offsetWidth(this._elDropdownBox,p)),r=280,i=140;if(e.height(this._elDropdownBox)===r)return;return this._elDropdownBox.style.height="",d=e.clientHeight(),u=document.body.scrollTop,l=o.top-2-u,f=d-o.top-n-2+u,a=!1,t=e.height(this._elDropdownBox),t>r&&(t=r,s=!0),f<t&&(a=l>f,s?(t=a?l:f,t>r&&(t=r),t<i&&(t=i)):l<t&&(a=!1)),e.height(this._elDropdownBox)>t&&e.height(this._elDropdownBox,t),a?c=o.top-t-2:c=o.top+n+2,e.place(this._elDropdownBox,o.left,c)},close:function(){j3.Dom.removeCls(this.el,"sel-active"),j3.Dom.hide(this._elDropdownBox),this.fire("close",this),this._isDropdown=!1}}),function(e){var t,n,r,i,s,o,u,a,f,l;return i=function(e,t){var n,r;r=t.data,r.divider||r.disabled?t.stop=!0:r.cmd&&(t.stop=!0,this.close(),n={name:r.cmd,data:r},this.onCommand&&this.onCommand(n),this.fire("command",this,n))},s=function(t,n){var r,i,s;if(this.isUpdatingSubcomponent())return;return s=t,s===this._dataList?i=this._fixedDataList:i=this._dataList,i&&i.setSelectedItems(null),r=n.data,e.equals(this._selectedValue,r.value)||(this._selectedValue=r.value,this.doSetSelectedItems(r),this.updateData(),this.onChange&&this.onChange(),this.fire("change",this)),this.close()},l=e.compileSelector(["text","value","disabled","cmd","divider"]),n=function(t,n){return n?n:t?(n=new e.Collection,e.forEach(t,function(e){var t;return(t=e.value)==null&&(e.value=e.text),n.insert(e)}),n):null},r=function(e,n,r,s){var o;return n?(o=new t({parent:this,ctnr:e,datasource:n,selectedItemOnClick:!0,selectedItems:this._selectedItems,itemDataSelector:r,itemDataEquals:["value"],on:{beforeItemClick:{c:this,h:i},itemClick:{c:this,h:s}}}),o):null},o=function(t){return e.equals(this._selectedValue,t)?!1:(this._selectedValue=t,f.call(this),!0)},a=function(){return f.call(this)},f=function(){return this.updateSubcomponent(),this.doSetSelectedItems(u.call(this,this._selectedValue)),this.updateData()},u=function(e){var t,n,r;return e===null?null:(r=null,this._fixedItemsDatasource&&(t=this._fixedItemDataSelector,this._fixedItemsDatasource.tryUntil(function(n){var i;i=t(n);if(i.cmd||i.divider)return!1;if(i.value===e)return r=i,!0})),r||(n=this._itemDataSelector,this._itemsDatasource.tryUntil(function(t){var i;i=n(t);if(i.cmd||i.divider)return!1;if(i.value===e)return r=i,!0})),r)},e.DropdownList=e.cls(e.Dropdown,{_selectedIndex:null,onInit:function(t){return e.DropdownList.base().onInit.call(this,t),this._itemsDatasource=n(t.items,t.itemsDatasource)||new e.Collection,this._fixedItemsDatasource=n(t.fixedItems,t.fixedItemsDatasource),this._itemDataSelector=e.compileSelector(t.itemDataSelector||l),this._fixedItemDataSelector=e.compileSelector(t.fixedItemDataSelector||l)},onCreated:function(t){return e.DropdownList.base().onCreated.call(this),e.isUndefined(t.value)?this.doSetSelectedItems(null):o.call(this,t.value),this.setDatasource(t.datasource),this._itemsDatasource.on("refresh",this,a),this._itemsDatasource.on("addModel",this,a),this._itemsDatasource.on("removeModel",this,a)},onCreateDropdownBox:function(e){return this._fixedItemsDatasource&&(this._fixedDataList=r.call(this,e,this._fixedItemsDatasource,this._fixedItemDataSelector,s)),this._dataList=r.call(this,e,this._itemsDatasource,this._itemDataSelector,s)},getItemsDatasource:function(){return this._itemsDatasource},getItems:function(){return this._items},setItems:function(t){var n;n=new e.Collection,t&&e.forEach(t,function(e){var t;return(t=e.value)==null&&(e.value=e.text),n.insert(e)}),this._itemsDatasource=n;if(this._dataList)return this._dataList.setDatasource(this._itemsDatasource)},getSelectedValue:function(){return this._selectedValue},setSelectedValue:function(e){if(!o.call(this,e))return;return this.onChange&&this.onChange(),this.fire("change",this)},onSetSelectedItems:function(){var e;if(!this.getMultiple())return e=this.getSelectedItem(),this._selectedValue=e?e.value:null,this.updateSubcomponent(),this.updateData()},onUpdateData:function(){return this._datasource.set(this.name,this._selectedValue)},onUpdateView:function(e,t,n){if(n&&n.changedData&&!n.changedData.hasOwnProperty(this.name))return;return this.setSelectedValue(e.get(this.name))},onUpdateSubcomponent:function(){var e,t,n,r;if(!this._dataList)return;r=this._selectedValue,r===null?(this._fixedDataList&&this._fixedDataList.setSelectedItems(null),this._dataList.setSelectedItems(null)):(n=null,this._fixedDataList&&(e=this._fixedItemDataSelector,this._fixedItemsDatasource.tryUntil(function(t){var i;i=e(t);if(i.cmd||i.divider)return;if(i.value===r)return n=i,!0}),this._fixedDataList.setSelectedItem(n)),n||(t=this._itemDataSelector,this._itemsDatasource.tryUntil(function(e){var i;i=t(e);if(i.cmd||i.divider)return;if(i.value===r)return n=i,!0}),this._dataList.setSelectedItem(n)))}}),e.ext(e.DropdownList.prototype,e.DataView),t=e.cls(e.DataList,{css:"drp-list",onRenderDataListItem:function(t,n){var r,i;return r=this._itemDataSelector(n.data),e.getVal(r,"divider")?t.a('<div class="drp-list-divider"></div>'):(i=e.getVal(r,"text")||e.getVal(r,"name")||e.getVal(r,"value"),t.a("<a"),e.getVal(r,"disabled")&&t.a(' class="list-item-disabled"'),t.a(">"),t.a(i),t.a("</a>"))}})}(j3),function(e){var t,n,r,i;return r=function(t,r){var i,s,o;i=r.node;if(i.getUnselectable())return;return this.close(),o=null,i&&(s=i.getData(),o={text:e.getVal(s,this._itemsTextName),value:e.getVal(s,this._itemsValName)}),n.call(this,o)},i=function(e,t){return this.resizeDropdownBox()},t=function(e,t){var n;if(!e)return t(null);n=this.getItemsDatasource();if(!n)return;return n.getById(e,t)},n=function(e){var t;t=e&&e.value||null;if(this._selectedValue===t)return;return this._selectedValue=t,this.updateData(),this.doSetSelectedItems(e),this.fire("change",this,{value:t})},e.DropdownTree=e.cls(e.Dropdown,{onInit:function(t){return e.DropdownTree.base().onInit.apply(this,arguments),this._treeOptions=t.treeOptions||{},this._textName=t.textName,this._itemsValName=t.itemsValName||this.name,this._itemsTextName=t.itemsTextName||this._itemsValName},onCreateDropdownBox:function(t){var n;return n=this._treeOptions.cls||e.Tree,this._treeOptions.parent=this,this._treeOptions.ctnr=t,this._tree=new n(this._treeOptions),this._tree.on("nodeClick",this,r),this._tree.on("nodeExpand",this,i),this.fire("treeLoad",this,{tree:this._tree})},onCreated:function(t){return e.DropdownTree.base().onCreated.call(this),this._selectedValue=t.selectedValue,this.setDatasource(t.datasource),this.setItemsDatasource(t.itemsDatasource)},onDropdown:function(){var e;return e=this._tree.getTopNode(),e.expand(),this._tree.setActiveNode(null)},getTree:function(){return this._tree},getSelectedValue:function(){return this._selectedValue},setSelectedValue:function(r){var i=this;if(this._selectedValue===r)return;return t.call(this,r,function(t){var r;return t&&(r={text:e.getVal(t,i._itemsTextName),value:e.getVal(t,i._itemsValName)}),n.call(i,r)})},onUpdateView:function(e,t,n){if(n&&n.changedData&&!n.changedData.hasOwnProperty(this.name))return;return this.setSelectedValue(e.get(this.name))},onUpdateData:function(){var e,t;return t=this.getDatasource(),e={},e[this.name]=this._selectedValue,this._textName&&(e[this._textName]=this._selectedText),t.set(e,{append:!0})},onUpdateViewItems:function(e,t,n){}}),e.ext(e.DropdownTree.prototype,e.DataView,e.DataItemsView)}(j3),function(e){var t;return t=function(e,t){if(this.isUpdatingSubcomponent())return;return this.close(),this.setDate(t.curDate)},e.DateSelector=e.cls(e.Dropdown,{cssTrigger:"icon-calendar",onCreated:function(t){return e.DateSelector.base().onCreated.call(this),this.setDate(t.date),this.setDatasource(t.datasource)},onCreateDropdownBox:function(n){return this._calendar=new e.Calendar({ctnr:n,date:this._date}),this._calendar.on("change",this,t)},getDate:function(){return this._calendar.getCurrentDate()},setDate:function(t,n){var r,i;if(e.equals(this._date,t))return;return r=this._date,this._date=t,n||(this._date&&(i={text:this._date.toString("yyyy-MM-dd"),value:this._date}),this.doSetSelectedItems(i)),this.updateData(),this.fire("change",this,{oldDate:r,curDate:this._date})},onSetSelectedItems:function(){var e;return e=this.getSelectedItem(),this.setDate(e&&e.value||null,!0),this.updateSubcomponent()},onUpdateData:function(){return this._datasource.set(this.name,this._date)},onUpdateView:function(e,t,n){if(n&&n.changedData&&!n.changedData.hasOwnProperty(this.name))return;return this.setDate(e.get(this.name)),this.updateSubcomponent()},onUpdateSubcomponent:function(){if(this._calendar)return this._calendar.setCurrentDate(this._date)}}),e.ext(e.DateSelector.prototype,e.DataView)}(j3),function(e){var t;return t=function(e){if(e.keyCode()===32)return this.click(),e.stop()},e.Switch=e.cls(e.View,{baseCss:"swt",template:e.template('<div id="<%=id%>" class="<%=css%>"><a href="javascript:;"><span class="swt-on">YES</span><span class="swt-btn"></span><span class="swt-off">NO</span></a></div>'),onInit:function(e){return this._checked=!!e.checked},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._checked?" "+this.baseCss+"-checked":"")}},onCreated:function(n){return e.on(this.el,"click",this,this.click),e.on(this.el,"keypress",this,t),this.setDatasource(n.datasource)},getChecked:function(){return this._checked},setChecked:function(t){if(this._checked===!!t)return;return e.Dom.toggleCls(this.el,this.baseCss+"-checked"),this._checked=!!t,this.updateData(),this.fire("change",this)},click:function(){return this.setChecked(!this.getChecked())},onUpdateData:function(){return this._datasource.set(this.name,this._checked)},onUpdateView:function(e,t,n){if(n&&n.changedData&&!n.changedData.hasOwnProperty(this.name))return;return this.setChecked(e.get(this.name))}}),e.ext(e.Switch.prototype,e.DataView)}(j3),j3.UploadStatus={waiting:1,uploading:2,succeeded:4,failed:8,cancelling:16,cancelled:32},function(e){var t,n,r,i,s,o,u,a,f;return n=e.UploadStatus,e.UploadQueue=t=e.cls({ctor:function(t){this.id=e.View.genId(),this._autoUpload=t.autoUpload,this._formsMap={},this._filesMap={},this._uploadFileCollection=new e.Collection,t.on&&this.on(t.on)},upload:function(){return o.call(this)},getUploading:function(){return this._uploading},addUpload:function(t){var n;n=this._uploadFileCollection.insert(e.clone(t,["id","name","contextData","status","uploadUrl","passFileNameInActionUrl"],!0)),t.file?this._filesMap[t.id]=t.file:t.form&&(this._formsMap[t.id]=t.form),this.fire("uploadAdd",this,{data:n});if(this._autoUpload)return o.call(this)}}),e.ext(t.prototype,e.EventManager),o=function(){return window.FormData?u.call(this):a.call(this)},i=function(e){var t,r;return this._uploading===!0?null:(t=this._uploadFileCollection.tryUntil(function(e){return e.get("status")===n.waiting}),t?(r=t.get("id"),{id:r,data:e[r]}):null)},r=function(t){var n,r,i,s,o,u;r="__j3UploadCallback"+this.id,n=e.getVal(t,"uploadUrl")||"",o=e.getVal(t,"id"),e.indexOf("?")===-1?n+="?uploadId="+o:n+="&uploadId="+o,e.getVal(t,"passFileNameInActionUrl")&&(n+="&fileName="+encodeURIComponent(e.getVal(t,"name",""))),i=e.getVal(t,"contextData");if(i)for(s in i)u=i[s],n+="&"+s+"="+encodeURIComponent(u);return n+="&callback=parent."+r,n},u=function(){var t,o,u,a,l,c,h,p=this;a=i.call(this,this._filesMap);if(!a)return;c=a.id,l=a.data;if(!l)return;return o=s.call(this,c),o.set("status",n.uploading),this._uploading=!0,this.fire("uploadStatusChange",this,{data:o}),u=new FormData,u.append("file",l),h=new XMLHttpRequest,t=r.call(this,o),h.open("POST",t),h.setRequestHeader("Accept","application/json"),h.onload=function(){return h.status===200?f.call(p,e.fromJson(h.responseText)):f.call(p,{err:"Error",msg:"UploadError"})},h.upload.onprogress=function(e){var t;if(!event.lengthComputable)return;return t=event.loaded/event.total*100|0,o=s.call(p,c),o.set("progress",t),p.fire("uploadProgressChange",p,{data:o})},h.send(u)},a=function(){var e,t,o,u,a,l,c=this;u=i.call(this,this._formsMap);if(!u)return;l=u.id,a=u.data;if(!a)return;return o=s.call(this,l),o.set("status",n.uploading),this._uploading=!0,this.fire("uploadStatusChange",this,{data:o}),t="__j3UploadCallback"+this.id,window[t]=function(e){return f.call(c,e)},e=r.call(this,o),a.action=e,a.submit()},s=function(e){return this._uploadFileCollection.tryUntil(function(t){return t.get("id")===e})},f=function(t){var r,i;this._uploading=!1,r=s.call(this,t.uploadId);if(!r)return;return t.err?(e.MessageBar.error(t.msg),r.set("status",n.failed)):(i={status:n.succeeded},t.document&&(i.docId=t.document._id||t.document.id),r.set(i,{append:!0})),this.fire("uploadStatusChange",this,{data:r}),o.call(this)}}(j3),function(e){var t,n,r,i,s,o,u;return n=e.UploadStatus,e.UploadSelector=t=e.cls(e.ContainerView,{baseCss:"upload-selector",onInit:function(e){return this._multiple=e.multiple,this._uploadUrl=e.uploadUrl,this._passFileNameInActionUrl=e.passFileNameInActionUrl,this._uploadQueue=e.uploadQueue,this._autoUpload=e.autoUpload,this._contextData=e.contextData,this._formsMap={},this._filesMap={},this._triggers=[]},createChildren:function(t){return this._uploadFileCollection=new e.Collection},renderChildren:function(e){},onCreated:function(e){if(e.trigger)return this.registerTrigger(e.trigger)},reset:function(){return this._formsMap={},this._filesMap={},this._lastFileInput=null,this._uploadFileCollection.clear()},upload:function(){return __tryUpload.call(this)},getUploading:function(){return this._uploading},getLastFileInput:function(){return this._lastFileInput},registerTrigger:function(t){if(e["in"](this._triggers,t))return;return e.UA.ie?e.on(t,"mouseover",this,u):e.on(t,"click",this,o),this._triggers.push(t)},unregisterTrigger:function(t){if(!e["in"](this._triggers,t))return;return e.UA.ie?e.on(t,"mouseover",this,u):e.on(t,"click",this,o),e.remove(this._triggers,t)},getUploadUrl:function(){return this._uploadUrl},setUploadUrl:function(e){return this._uploadUrl=e},setContextData:function(e){return this._contextData=e},canTriggerFileSelect:function(){return!!window.FormData},triggerFileSelect:function(){return(!this._lastFileInput||this._lastFileInput.value)&&r.call(this),this._lastFileInput.click()}}),i=function(){var t;if(this._elUplaodIFrameCtnr)return;return t=new e.StringBuilder,t.a("<div style='width:0px;height:0px;overflow:hidden;'>"),t.a("<iframe class='uploader-iframe' name='"+this.id+"-iframe'></iframe>"),t.a("</div>"),e.Dom.append(this.el,t.toString()),this._elUplaodIFrameCtnr=e.Dom.lastChild(this.el)},r=function(){var t,n,r;return i.call(this),r=new e.StringBuilder,r.a("<form class='uploader-form' target='"+this.id+"-iframe' method='POST' enctype='multipart/form-data'>"),r.a("<input type='file' class='uploader-file-input' name='file'"),this._multiple&&r.a(" multiple='true'"),r.a(" title='"+this._tip+"' />"),r.a("</form>"),e.Dom.append(this._elUplaodIFrameCtnr,r.toString()),n=e.Dom.lastChild(this._elUplaodIFrameCtnr),t=e.Dom.byIndex(n,0),e.on(t,"change",this,s),this._lastFileInput=t,n},u=function(t){var n,i,s;return(!this._lastFileInput||this._lastFileInput.value)&&r.call(this),n=e.Dom,n.opacity(this._lastFileInput,.01),s=t.src(),i=n.position(s),this._lastFileInput.style.position="absolute",this._lastFileInput.style.width=s.offsetWidth+"px",this._lastFileInput.style.height=s.offsetHeight+"px",n.place(this._lastFileInput,i.left,i.top)},o=function(e){return this.triggerFileSelect()},s=function(t){var n,r,i,s,o,u,a,f,l,c;s=t.src();if(!s.value)return;s.style.position="";if(window.FormData){c=s.files;for(f=0,l=c.length;f<l;f++)r=c[f],n=r.name,o=e.guid(),u={id:o,name:n,contextData:this._contextData,status:e.UploadStatus.waiting,uploadUrl:this._uploadUrl,passFileNameInActionUrl:this._passFileNameInActionUrl,file:r},this._uploadQueue.addUpload(u)}else n=e.Path.basename(s.value),i=s.parentNode,o=e.guid(),a=this._uploadFileCollection.insert({id:o,name:n,contextData:this._contextData,status:e.UploadStatus.waiting,uploadUrl:this._uploadUrl,passFileNameInActionUrl:this._passFileNameInActionUrl,form:i}),this._uploadQueue.addUpload(u)}}(j3),function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;return t=e.UploadStatus,e.Uploader=n=e.cls(e.ContainerView,{baseCss:"uploader",onInit:function(e){return this._enableDrop=e.enableDrop,this._actionUrl=e.actionUrl,this._dropIndicatorText=e.dragIndicatorText,this._selectLocalIndicatorText=e.selectLocalIndicatorText,this._removeConfirmText=e.removeConfirmText,this._autoUpload=e.autoUpload,this._formsMap={},this._filesMap={}},createChildren:function(t){return this._uploadFileCollection=new e.Collection({on:{addModel:{c:this,h:m},removeModel:{c:this,h:m},modelDataChange:{c:this,h:m}}}),this._uploadFileList=new e.DataList({parent:this,css:"uploader-file-list",datasource:this._uploadFileCollection,listItemRenderer:t.fileItemRenderer||y,on:{command:{c:this,h:g}}})},renderChildren:function(e){return e.a("<div class='uploader-inner'>"),this._uploadFileList.render(e),e.a("<div class='uploader-indicator'>"),e.a("<i class='uploader-icon'></i>"),this._enableDrop&&(e.a("<span class='uploader-indicator-drop'>"),e.a(this._dropIndicatorText),e.a("</span>")),e.a("<a class='uploader-indicator-select uploader-indicator-select-local' href='javascript:;'>"),e.a(this._selectLocalIndicatorText),e.a("</a>"),e.a("</div>"),e.a("</div>")},onCreated:function(t){var n=this;return this._elInner=e.Dom.firstChild(this.el),this._elIndicator=e.Dom.byIndex(this._elInner,1),this._elSelectLocal=e.Dom.byCls(this._elIndicator,"uploader-indicator-select-local"),e.on(this._elIndicator,"click",this,o),this.el.ondragover=function(){return!1},this.el.ondragend=function(){return!1},this.el.ondrop=function(e){return u.call(n,e)},e.UA.ie?e.on(this._elSelectLocal,"mouseover",this,f):e.on(this._elSelectLocal,"click",this,a),this.setDatasource(t.datasource)},onUpdateView:function(e,n,r){var i,s,o,u,a;if(r&&r.changedData&&!r.changedData.hasOwnProperty(this.name))return;i=e.get(this.name),o=[];if(i)for(u=0,a=i.length;u<a;u++)s=i[u],o.push({id:s.id,name:s.name,docId:s.docId||s.id,status:s.status||t.succeeded,progress:s.progress});return this._uploadFileCollection.loadData(o)},reset:function(){return this._formsMap={},this._filesMap={},this._lastFileInput=null,this._uploadFileCollection.clear()},upload:function(){return p.call(this)}}),e.ext(n.prototype,e.DataView),y=function(n,r){var i,s,o,u,a,f,l;return i=r.data,o=i.get("name"),s=e.Path.extname(o),s&&(s=s.substr(1)),u=[{cmd:"remove",icon:"icon-remove-doc",text:"remove"}],a={css:"action-links pull-right",commandMode:!0},e.LinkList.render(u,a,n),n.a('<div class="pull-right">'),l=i.get("status"),l===t.uploading&&(f=i.get("progress"),e.isUndefined(f)||n.a(""+f+"%")),n.a("</div>"),n.a('<div class="list-item-title">'),n.a('<i class="icon-files-small'),s&&n.a(" icon-files-small-type-"+s),n.a('"></i>'),n.e(i.get("name")),n.a("</div>")},i=function(){var t;if(this._elUplaodIFrameCtnr)return;return t=new e.StringBuilder,t.a("<div style='width:0px;height:0px;overflow:hidden;'>"),t.a("<iframe class='uploader-iframe' name='"+this.id+"-iframe'></iframe>"),t.a("</div>"),e.Dom.append(this._elIndicator,t.toString()),this._elUplaodIFrameCtnr=e.Dom.lastChild(this._elIndicator)},r=function(){var t,n,r;return i.call(this),r=new e.StringBuilder,r.a("<form class='uploader-form' target='"+this.id+"-iframe' method='POST' enctype='multipart/form-data'>"),r.a("<input type='file' class='uploader-file-input' name='file' multiple='true' title='"+this._selectLocalIndicatorText+"' />"),r.a("</form>"),e.Dom.append(this._elUplaodIFrameCtnr,r.toString()),n=e.Dom.lastChild(this._elUplaodIFrameCtnr),t=e.Dom.byIndex(n,0),e.on(t,"change",this,s),this._lastFileInput=t,n},o=function(t){var n,r;return r=t.src(),n=e.Dom.data(r,"cmd"),this.fire("command",this,{name:n})},f=function(t){var n,i,s;return(!this._lastFileInput||this._lastFileInput.value)&&r.call(this),n=e.Dom,n.opacity(this._lastFileInput,.01),s=t.src(),i=n.position(s),this._lastFileInput.style.position="absolute",this._lastFileInput.style.width=s.offsetWidth+"px",this._lastFileInput.style.height=s.offsetHeight+"px",n.place(this._lastFileInput,i.left,i.top)},a=function(e){return(!this._lastFileInput||this._lastFileInput.value)&&r.call(this),this._lastFileInput.click()},u=function(t){var n,r,i,s,o,u;t.preventDefault(),i=event.dataTransfer.files;if(!i)return;for(o=0,u=i.length;o<u;o++)r=i[o],n=r.name,s=e.guid(),this._uploadFileCollection.insert({id:s,name:n,status:e.UploadStatus.waiting}),this._filesMap[s]=r;if(this._autoUpload)return p.call(this)},s=function(t){var n,r,i,s,o,u,a,f;s=t.src();if(!s.value)return;s.style.position="";if(window.FormData){f=s.files;for(u=0,a=f.length;u<a;u++)r=f[u],n=r.name,o=e.guid(),this._uploadFileCollection.insert({id:o,name:n,status:e.UploadStatus.waiting}),this._filesMap[o]=r}else n=e.Path.basename(s.value),i=s.parentNode,o=e.guid(),this._uploadFileCollection.insert({id:o,name:n,status:e.UploadStatus.waiting}),this._formsMap[o]=i;if(this._autoUpload)return p.call(this)},p=function(){return window.FormData?d.call(this):v.call(this)},c=function(e){var n,r;return this._uploading===!0?null:(n=this._uploadFileCollection.tryUntil(function(e){return e.get("status")===t.waiting}),n?(r=n.get("id"),{id:r,data:e[r]}):null)},l=function(t){var n,r;return r="__j3UploadCallback"+this.id,n=this._actionUrl||"",e.indexOf("?")===-1?n+="?uploadId="+t:n+="&uploadId="+t,n+="&callback=parent."+r,n},d=function(){var n,r,i,s,o,u,a,f=this;s=c.call(this,this._filesMap);if(!s)return;u=s.id,o=s.data;if(!o)return;return r=h.call(this,u),r.set("status",t.uploading),this._uploading=!0,i=new FormData,i.append("file",o),a=new XMLHttpRequest,n=l.call(this,u),a.open("POST",n),a.setRequestHeader("Accept","application/json"),a.onload=function(){return a.status===200?b.call(f,e.fromJson(a.responseText)):b.call(f,{err:"Error",msg:"UploadError"})},a.upload.onprogress=function(e){var t;if(!event.lengthComputable)return;return t=event.loaded/event.total*100|0,r=h.call(f,u),r.set("progress",t)},a.send(i)},v=function(){var e,n,r,i,s,o,u=this;i=c.call(this,this._formsMap);if(!i)return;o=i.id,s=i.data;if(!s)return;return r=h.call(this,o),r.set("status",t.uploading),this._uploading=!0,n="__j3UploadCallback"+this.id,window[n]=function(e){return b.call(u,e)},e=l.call(this,o),s.action=e,s.submit()},h=function(e){return this._uploadFileCollection.tryUntil(function(t){return t.get("id")===e})},b=function(n){var r;this._uploading=!1,r=h.call(this,n.uploadId);if(!r)return;return n.err?(e.MessageBar.error(n.msg),r.set("status",t.failed)):r.set({status:t.succeeded,docId:n.document._id||n.document.id},{append:!0}),p.call(this)},m=function(e,n){var r;if(this.isUpdatingView())return;return r=[],e.forEach(function(e){var n;return n=e.getData(),n.status===t.succeeded&&(n.id=n.docId),r.push(n)}),this.getDatasource().set(this.name,r)},g=function(t,n){var r;return r=n.data,e.MessageBox.confirm(null,this._removeConfirmText,this,function(){return this._uploadFileCollection.removeById(r.get("id"))})}}(j3),function(e){return e.Toolbar=e.cls(e.ContainerView,{baseCss:"toolbar",onCreateChild:function(t,n){var r,i;(r=t.cls)==null&&(t.cls=e.Button),(i=t.css)==null&&(t.css=""),n.first&&(t.css+=" first");if(n.last)return t.css+=" last"}})}(j3),function(e){var t;return t=function(e){try{this.action("ok")}catch(t){window.console&&window.console.log(""+t.name+": "+t.message)}this._target==="ajax"&&e.stop()},e.Form=e.cls(e.ContainerView,{baseCss:"form",templateBegin:e.template('<form id="<%=id%>" class="<%=css%>" method="<%=method%>" target="<%=target%>"><%if(title){%><div class="form-title"><%-title%></div><%}%>'),templateEnd:e.template("</form>"),onInit:function(e){return this._method=e.method||"POST",this._target=e.target||"ajax",this._narrowLabel=!!e.narrowLabel,this._stackedLabel=!!e.stackedLabel,this._datasource=e.datasource,this._title=e.title},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._narrowLabel?" form-narrow-label":"")+(this._stackedLabel?" form-stacked-label":""),method:this._method,target:this._target,title:this._title}},onCreated:function(){return e.on(this.el,"submit",this,t)},onCreateChild:function(e){e.form=this;if(this._datasource&&!e.datasource)return e.datasource=this._datasource},getDatasource:function(){return this._datasource},getFormItemByName:function(e){var t;if(!this.children)return null;t=this.children.firstNode();while(t){if(t.value.name===e)return t.value;t=t.next}return null},getActionButtonByName:function(e){var t;if(!this.children)return null;t=this.children.firstNode();while(t){if(t.value.getActionButtonByName)return t.value.getActionButtonByName(e);t=t.next}return null},action:function(e,t){var n;return n={name:e,src:t},typeof this.onAction=="function"&&this.onAction(n),this.fire("action",this,n)},getTarget:function(){return this._target},focus:function(){return this.children?(this.children.tryUntil(function(e){return e.focus&&e.focus()}),!0):!1}}),e.ext(e.Form.prototype,e.DataView)}(j3),function(e){return e.FormDivider=e.cls(e.View,{baseCss:"form-divider",template:e.template("<div id=<%=id%> class=<%=css%>></div>")})}(j3),function(e){var t,n,r;return r=function(e,t){return{parent:e,datasource:t.datasource,id:t.id,name:t.name,width:t.controlWidth,height:t.controlHeight,fill:t.controlFill,on:t.on}},e.FormItem=t=e.cls(e.ContainerView,{baseCss:"form-item",onInit:function(t){var n;return this._label=t.label,this._inline=t.inline,this._stacked=t.stacked,this._compact=t.compact,this._nolabel=t.nolabel,this._isFirst=t.isFirst,this._helpText=t.helpText,t.controlId||(t.controlId=e.View.genId()),this._controlId=t.controlId,(n=t.datasource)==null&&(t.datasource=this.parent.getDatasource()),this._formItemDatasource=t.datasource},getTemplateData:function(){return{id:this.id,label:this._label,css:this.getCss()+(this._inline?" "+this.baseCss+"-inline":"")+(this._stacked?" "+this.baseCss+"-stacked":"")+(this._compact?" "+this.baseCss+"-compact":"")+(this._nolabel?" "+this.baseCss+"-nolabel":"")+(this._isFirst?" "+this.baseCss+"-first":""),controlId:this._controlId,helpText:this._helpText}},renderBegin:function(e,t){e.a('<div id="'+t.id+'" class="'+t.css+'">'),e.a('<label class="form-label" for="'+this._controlId+'">'),this.renderLabelContent(e),e.a("</label>"),e.a('<div class="form-controls">')},renderEnd:function(e,t){this._helpText&&(e.a('<div class="form-help">'),e.a(this._helpText),e.a("</div>")),e.a("</div>"),e.a("</div>")},renderLabelContent:function(e){e.e(this._label)},onCreated:function(){return this.elBody=e.Dom.byIndex(this.el,1)},getDatasource:function(){return this._formItemDatasource},createFormControl:function(t,n){return new n.cls(e.ext(r(this,t),n))},setDisabled:function(){},getControlId:function(){return this._controlId}}),e.TextFormItem=n=e.cls(e.FormItem,{onInit:function(e){return n.base().onInit.call(this,e),this.name=e.name},createChildren:function(t){var n;return n="",t.datasource&&(n=t.datasource.get(this.name)),this._text=this.createFormControl(t,{cls:e.HtmlView,id:this.getControlId(),tagName:"div",css:"form-item-text",innerHTML:e.htmlEncode(n)})},onCreated:function(e){n.base().onCreated.call(this,e),this._elText=this._text.el;if(e.datasource)return this.setDatasource(e.datasource)},val:function(){var e;return e=this.getDatasource(),e?e.get(this.name):null},setDisabled:function(t){return t?e.Dom.addCls(this._elText,"form-item-text-disabled"):e.Dom.removeCls(this._elText,"form-item-text-disabled")},onUpdateView:function(t,n,r){if(r&&r.changedData&&!r.changedData.hasOwnProperty(this.name))return;this._elText.innerHTML=e.htmlEncode(t.get(this.name))}}),e.ext(e.TextFormItem.prototype,e.DataView),e.TextboxFormItem=e.cls(e.FormItem,{createChildren:function(t){return this._textbox=this.createFormControl(t,{cls:e.Textbox,id:this.getControlId(),text:t.value,multiline:t.multiline,type:t.type,placeholder:t.placeholder,disabled:t.disabled,autoHeight:t.controlAutoHeight})},textbox:function(){return this._textbox},val:function(){return this._textbox.getText()},focus:function(){return this._textbox.focus()},setDisabled:function(e){return this._textbox.setDisabled(e)}}),e.CheckboxFormItem=e.cls(e.FormItem,{createChildren:function(t){return this._checkbox=this.createFormControl(t,{cls:e.Checkbox,id:this.getControlId(),text:t.text,value:t.value,bindingMode:t.bindingMode,disabled:t.disabled})},checkbox:function(){return this._checkbox},val:function(){return this._checkbox.getValue()},setDisabled:function(e){return this._checkbox.setDisabled(e)}}),e.CheckboxListFormItem=e.cls(e.FormItem,{createChildren:function(t){return this._checkboxList=this.createFormControl(t,{cls:e.CheckboxList,id:this.getControlId(),items:t.items,itemsDatasource:t.itemsDatasource,itemInline:t.listItemInline,itemWidth:t.listItemWidth,bindingMode:t.bindingMode,disabled:t.disabled})},checkboxList:function(){return this._checkboxList},val:function(){return this._checkboxList.getSelectedValue()},setDisabled:function(e){return this._checkboxList.setDisabled(e)}}),e.DropdownListFormItem=e.cls(e.FormItem,{createChildren:function(t){return this._dropdownList=this.createFormControl(t,{cls:e.DropdownList,id:this.getControlId(),items:t.items,itemsDatasource:t.itemsDatasource,fixedItemsDatasource:t.fixedItemsDatasource,itemDataSelector:t.itemDataSelector,fixedItemDataSelector:t.fixedItemDataSelector,value:t.value,placeholder:t.placeholder,icon:t.controlIcon,disabled:t.disabled})},dropdownList:function(){return this._dropdownList},val:function(){return this._dropdownList.getSelectedValue()},setDisabled:function(e){return this._dropdownList.setDisabled(e)}}),e.DropdownTreeFormItem=e.cls(e.FormItem,{createChildren:function(t){return this._dropdownTree=this.createFormControl(t,{cls:e.DropdownTree,id:this.getControlId(),placeholder:t.placeholder,treeOptions:t.treeOptions,textName:t.textName,itemsValName:t.itemsValName,itemsTextName:t.itemsTextName,itemsDatasource:t.itemsDatasource,icon:t.controlIcon,disabled:t.disabled})},dropdownTree:function(){return this._dropdownTree},val:function(){return this._dropdownTree.getSelectedValue()},setDisabled:function(e){return this._dropdownTree.setDisabled(e)}}),e.DateSelectorFormItem=e.cls(e.FormItem,{createChildren:function(t){return this._dateSelector=this.createFormControl(t,{cls:e.DateSelector,id:this.getControlId(),date:t.value,placeholder:t.placeholder,icon:t.controlIcon,disabled:t.disabled})},dateSelector:function(){return this._dateSelector},val:function(){return this._dateSelector.getDate()},setDisabled:function(e){return this._dateSelector.setDisabled(e)}}),e.DateDurationFormItem=e.cls(e.FormItem,{createChildren:function(t){return this._beginDateSelector=this.createFormControl(t,{cls:e.DateSelector,id:this.getControlId(),date:t.beginValue,placeholder:t.beginPlaceholder,name:t.beginName,mini:!0,icon:t.beginControlIcon,disabled:t.disabled}),this._endDateSelector=this.createFormControl(t,{cls:e.DateSelector,date:t.endValue,placeholder:t.endPlaceholder,name:t.endName,mini:!0,icon:t.endControlIcon,disabled:t.disabled})},renderChildren:function(e){return this._beginDateSelector.render(e),e.a('<span class="form-controls-connector">-</span>'),this._endDateSelector.render(e)},setDisabled:function(e){return this._beginDateSelector.setDisabled(e),this._endDateSelector.setDisabled(e)}}),e.SwitchFormItem=e.cls(e.FormItem,{createChildren:function(t){return this._switch=this.createFormControl(t,{cls:e.Switch,id:this.getControlId(),checked:t.value})},"switch":function(){return this._switch},val:function(){return this._switch.getChecked()}})}(j3),function(e){var t,n,r,i,s;return s=function(e,t){return this.updateData()},i=function(e,t){return this.updateData()},n=function(e){return e},r=function(e){return e.getData()},e.FormItemGroup=t=e.cls(e.ContainerView,{baseCss:"form-item-group",onInit:function(e){this._bindingMode=e.bindingMode||"individual",this._childOptionsProvider=e.childOptionsProvider,this._formToItemModelConvertor=e.formToItemModelConvertor||n,this._itemToFormModelConvertor=e.itemToFormModelConvertor||r,this.setDatasource(e.datasource)},createChildren:function(n){this._bindingMode==="map"&&(this._subItemsDatasource=new e.Model,this._subItemsDatasource.on("change",this,s)),n.itemsDatasource?n.itemsDatasource.bind(this,this.onUpdateItems):t.base().createChildren.call(this,n)},createChildFormItem:function(e,t){var n;n=this._childOptionsProvider(e),this.createChild(n,t)},onCreateChild:function(t){var n;this._bindingMode==="map"&&(t.datasource=this._subItemsDatasource),this._bindingMode==="array"&&(n=new e.Model,n.on("change",this,i),n.on("refresh",this,i),t.datasource=n)},onUpdateData:function(){var t;if(this._bindingMode==="individual")return;if(this._bindingMode==="map"){this.getDatasource().set(this.name,this._subItemsDatasource.getData());return}this._bindingMode==="array"&&(t=this.getDatasource().get(this.name),t||(t=[]),e.forEach(this.getChildren(),this,function(e,n,r){var i,s;return s=null,r<t.length&&(s=t[r]),i=this._itemToFormModelConvertor(e.getDatasource(),e,s),r<t.length?t[r]=i:t.push(i)}),this.getDatasource().set(this.name,t))},onUpdateView:function(t,n,r){var i;if(this._bindingMode==="individual")return;i=this.getDatasource().get(this.name);if(this._bindingMode==="map"){this._subItemsDatasource.set(i||{});return}this._bindingMode==="array"&&(i||(i=[]),e.forEach(this.getChildren(),this,function(e,t,n){var r;return r=this._formToItemModelConvertor(i[n],e),e.getDatasource().set(r||{})}))},onUpdateItems:function(e,t,n){var r,i;if(this._updatingItems)return;this._updatingItems=!0,this.el&&(this.getChildren().clear(),this.el.innerHTML=""),r={},i=e.count()-1,e.forEach(this,function(e,t,n){var s;return r.index=n,r.first=n===0,r.last=n===i,s=this._childOptionsProvider(e,r),s.parent=this,this.createChild(s,r)}),this._updatingItems=!1}}),e.ext(t.prototype,e.DataView)}(j3),function(e){var t;return t=function(e,t){if(!e.getPrimary())return this._form.action(e.name,e)},e.FormActions=e.cls(e.ContainerView,{baseCss:"form-actions",templateBegin:e.template('<div id="<%=id%>" class="<%=css%>">'),templateEnd:e.template("</div>"),onInit:function(e){var t;return this._form=e.form,(t=this._form)==null&&(this._form=e.parent),this._align=e.align},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._align==="right"?" "+this.baseCss+"-right":"")+(this._align==="left"?" "+this.baseCss+"-left":"")+(this._align==="center"?" "+this.baseCss+"-center":"")}},onCreateChild:function(t){if(!t.cls)return t.cls=e.Button},onChildCreated:function(e){return e.on("click",this,t)},getActionButtonByName:function(e){var t;if(!this.children)return null;t=this.children.firstNode();while(t){if(t.value.name===e)return t.value;t=t.next}return null}})}(j3),function(e){var t;return e.MenuItem=t=e.cls(e.View,{baseCss:"menu-item",onInit:function(e){return this._text=e.text||"",this._url=e.url,this._divider=e.divider,this._items=e.items||[]},getText:function(){return this._text},getUrl:function(){return this._url},getDivider:function(){return this._divider}}),t.render=function(e,t){var n;n="menu-item",t.divider&&(n+=" menu-divider"),e.a('<li class="'+n+'">');if(t.divider){e.a("</li>");return}return e.a("<a"),t.url&&e.a(' href="'+t.url+'"'),e.a(' data-cmd="'),e.a(t.name||""),e.a('">'),e.a("<i"),t.icon&&e.a('class="'+t.icon+'"'),e.a("></i>"),e.e(t.text||""),e.a("</li>")}}(j3),function(e){var t,n,r,i,s;return e.Menu=e.cls(e.View,{baseCss:"menu",template:e.template('<div id="<%=id%>" class="<%=css%>"></div>'),onInit:function(e){return this._items=e.items||[]},onCreated:function(t){return this._hidden=!0,e.on(this.el,"click",this,n)},popup:function(n){var i,o,u,a,f,l;return i=e.Dom,t.call(this),n.contextData&&(this._contextData=n.contextData),f=n.trigger,f&&(a=i.position(f),l=f.offsetHeight,n.x=a.left,n.alignRight&&(n.x+=f.offsetWidth),n.y=a.top+l),s.call(this),r.call(this),this.show(),n.width?this.width(n.width):this.width(-1),o=n.x,u=n.y,n.alignRight&&(o-=this.el.offsetWidth),i.place(this.el,o,u),e.regPopup(this,"menu",f)},close:function(){return this.hide(),e.unregPopup(this,"menu"),this.fire("close",this)},getContextData:function(){return this._contextData},setContextData:function(e){if(this._contextData===e)return;return this._contextData=e}}),i=function(t,n){var r,i,s;t.a('<ul class="menu-items">');for(i=0,s=n.length;i<s;i++)r=n[i],e.MenuItem.render(t,r);return t.a("</ul>")},t=function(){var t,n,r,s,o;if(this._elMenuItems)return;t=new e.StringBuilder,i.call(this,t,this._items),this.el.innerHTML=t.toString(),this._elMenuItems=this.el.firstChild,this._menuItems=[],n=this._elMenuItems.firstChild,r=0,o=[];while(n)s=this._items[r],this._menuItems.push(new e.MenuItem({parent:this,el:n,divider:s.divider,text:s.text,name:s.name,icon:s.icon})),n=n.nextSibling,o.push(r++);return o},n=function(e){var t,n,r;r=e.src();while(r&&r!==this.el){if(r.tagName==="A"){t=r.attributes["data-cmd"];if(t&&t.nodeValue){e.stop(),this.close(),n={name:t.nodeValue,contextData:this._contextData},this.onCommand&&this.onCommand(n),this.fire("command",this,n);return}}r=r.parentNode}},s=function(){var e,t,n,r,i;if(!this._menuItems)return;r=this._menuItems,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.fire("updateItemUI",this,{name:e.name,item:e,contextData:this._contextData}));return i},r=function(){var e,t,n,r,i,s,o,u,a;u=this._menuItems;for(r=0,s=u.length;r<s;r++)t=u[r],t.getDivider()&&t.setVisible(!0);e=!0,n=null,a=this._menuItems;for(i=0,o=a.length;i<o;i++)t=a[i],t.getDivider()?e||n?t.setVisible(!1):(t.setVisible(!0),n=t):t.getVisible()&&(e=!1,n=null);if(n)return n.setVisible(!1)}}(j3),function(e){return e.Navbar=e.cls(e.ContainerView,{baseCss:"navbar",onInit:function(e){return this.fixedTop=!!e.fixedTop},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this.fixedTop?" "+this.baseCss+"-fixed-top":"")}}})}(j3),function(e){var t,n,r,i;return n=function(t){var n,i,s,o;if(!this._commandMode)return;n=e.Dom,o=t.src();while(o&&o!==this.el){if(o.tagName==="A"){i=n.data(o,"cmd");if(!i)continue;s=n.data(o,"data"),t.stop(),r(o)&&this.fire("command",this,{src:o,name:i,data:s});return}o=o.parentNode}},r=function(e){return!!e.href},i=function(){var n,r,i;return i=new e.StringBuilder,n=this.getDatasource()||this._items||[],r={target:this._linkTarget,commandMode:this._commandMode},t.renderList(i,n,r),this.el.innerHTML=i.toString()},e.LinkList=t=e.cls(e.View,{baseCss:"link-list",onInit:function(e){return this._linkTarget=e.linkTarget,this._commandMode=e.commandMode,e.items&&(this._items=e.items),this.setDatasource(e.datasource)},onCreated:function(t){if(this._commandMode)return e.on(this.el,"click",this,n)},onRender:function(e){var n,r;return n=this.getDatasource()||this._items||[],r={id:this.id,css:this.getCss(),target:this._linkTarget,commandMode:this._commandMode},t.render(n,r,e)},onUpdateView:function(e){if(!this.el)return;return i.call(this)},setItems:function(e){return this._items=e,i.call(this)}}),e.ext(t.prototype,e.DataView),e.ext(t,{render:function(n,r,i){var s;s=i?i:new e.StringBuilder,s.a("<ul"),r.id&&s.a(' id="'+r.id+'"'),r.css&&s.a(' class="'+r.css+'"'),s.a(">"),t.renderList(s,n,r),s.a("</ul>");if(!i)return s.toString()},renderList:function(n,r,i){var s,o,u=this;return r.getActive&&(s=r.getActive()),o={target:i.target,commandMode:i.commandMode},e.forEach(r,function(e,r,i){return e.hasOwnProperty("isActive")?o.isActive=e.isActive:o.isActive=s===e,o.isFirst=i===0,t.renderLinkListItem(n,e,o)})},renderLinkListItem:function(t,n,r){var i,s,o,u,a,f,l;return t.a('<li class="'),r.isActive&&t.a(" active"),r.isFirst&&t.a(" first"),e.getVal(n,"isHighlight")&&t.a(" highlight"),u=e.getVal(n,"css"),u&&t.a(" "+u),t.a('">'),t.a("<a"),l=e.getVal(n,"url"),!l&&r.commandMode&&e.getVal(n,"cmd")&&(l="javascript:;"),l&&t.a(' href="'+l+'"'),f=e.getVal(n,"title"),f&&t.a(' title="'+e.htmlEncode(f)+'"'),a=e.getVal(n,"target"),a||(a=r.target),a&&t.a(' target="'+a+'"'),r.commandMode&&(i=e.getVal(n,"cmd"),i&&t.a(' data-cmd="'+i+'"'),s=e.getVal(n,"data"),s&&t.a(' data-data="'+s+'"')),t.a(">"),o=e.getVal(n,"icon"),o&&t.a('<i class="'+o+'"></i>'),t.a(e.htmlEncode(e.getVal(n,"text"))),t.a("</a>"),t.a("</li>")}})}(j3),function(e){var t,n,r;return t=function(e,t){return t.forEachGroup(this,function(r){return n.call(this,e,r,t.getActive())})},n=function(t,n,i){return t.append('<div class="nav-group-item">'),t.append('<div class="nav-list-title">'),n.icon&&t.append('<i class="'+n.icon+'"></i>'),t.append(e.htmlEncode(n.text)),t.append("</div>"),r.call(this,t,n.items,i),t.append("</div>")},r=function(t,n,r){var i;return t.append('<ul class="nav-list">'),i={commandMode:!0},e.forEach(n,this,function(n,s,o){return i.isActive=r===n,i.isFirst=o===0,e.LinkList.renderLinkListItem(t,n,i)}),t.append("</ul>")},e.NavGroup=e.cls(e.View,{baseCss:"nav-group",onCreated:function(e){if(e.datasource)return this.setDatasource(e.datasource)},onUpdateView:function(n,r,i){var s;return s=new e.StringBuilder,t.call(this,s,this.getDatasource()),this.el.innerHTML=s.toString()}}),e.ext(e.NavGroup.prototype,e.DataView)}(j3),function(e){return e.Panel=e.cls(e.ContainerView,{baseCss:"pnl",templateBegin:e.template('<div id="<%=id%>" class="<%=css%>"><div class="pnl-header"><%if(icon){%><i class="<%=icon%>"></i><%}%><%=title%></div><div class="pnl-body">'),templateEnd:e.template("</div></div>"),onInit:function(e){return this._icon=e.icon,this._title=e.title},getTemplateData:function(){return{id:this.id,css:this.getCss(),icon:this._icon,title:this._title}}})}(j3),function(e){var t,n,r;return n=function(t){var n,r;t.append('<ul class="tabs-triggers">');if(this.children){n=this.children.firstNode();while(n)r=n.value,t.append("<li"),t.append(' id="'+r.id+'-trigger"'),r===this.getActive()&&t.append(' class="active"'),t.append("><a>"),t.append(e.htmlEncode(r.getTitle())),t.append("</a></li>"),n=n.next}return t.append("</ul>")},t=function(t){var n,r;n=t.src();while(n&&n!==this._elTabsTriggers){if(n.tagName==="LI"){r=e.Dom.indexOf(n),this.setActive(this.children.getAt(r));return}n=n.parentNode}},r=function(){return typeof this.onActive=="function"&&this.onActive(),this.fire("active",this)},e.Tabset=e.cls(e.ContainerView,{baseCss:"tabs",onInit:function(e){},renderBegin:function(e,t){e.append('<div id="'+t.id+'" class="'+t.css+'">'),e.append('<div class="tabs-header">'),n.call(this,e),e.append("</div>"),e.append('<div class="tabs-body">')},renderEnd:function(e){return e.append("</div></div>")},onCreateChild:function(t,n){var r;return(r=t.cls)!=null?r:t.cls=e.TabPanel},onChildCreated:function(e,t,n){if(n.active||t.index===0)return this._activePanel=e},onCreated:function(){var n;return n=e.Dom,this._elTabsTriggers=n.firstChild(n.firstChild(this.el)),e.on(this._elTabsTriggers,"click",this,t),r.call(this._activePanel)},getActive:function(){return this._activePanel},setActive:function(t){var n,i;if(this._activePanel===t)return;if(!t)return;return i=this._activePanel,n=e.Dom,this._activePanel&&(n.removeCls(this._activePanel.elTrigger,"active"),n.removeCls(this._activePanel.el,"tab-pnl-active")),this._activePanel=t,n.addCls(this._activePanel.elTrigger,"active"),n.addCls(this._activePanel.el,"tab-pnl-active"),r.call(this._activePanel),this.fire("activePanelChange",this,{old:i,panel:this._activePanel})}})}(j3),function(e){return e.TabPanel=e.cls(e.ContainerView,{baseCss:"tab-pnl",getTemplateData:function(){return{id:this.id,css:this.getCss()+(this.getActive()?" tab-pnl-active":"")}},onInit:function(e){return this._title=e.title,this._name=e.name},onCreated:function(){return this.elTrigger=e.$(this.id+"-trigger")},setActive:function(){return this.parent.setActive(this)},getActive:function(){return this.parent.getActive()===this},getTitle:function(){return this._title},getName:function(){return this._name}})}(j3),function(e){var t,n,r;return n=function(e){var t,n,r,i;if(this._level){i=[];for(t=n=0,r=this._level-1;0<=r?n<r:n>r;t=0<=r?++n:--n)i.push(e.append('<div class="tree-node-indent"></div>'));return i}},t=function(){var t,n;n=this._elNodeBody;if(!n)return;return t=e.Dom,this._childrenLoaded&&(!this.children||!this.children.count())?(this.collapse(),t.addCls(n,"tree-node-leaf")):(t.removeCls(n,"tree-node-leaf"),this._expanded?t.addCls(n,"tree-node-expanded"):t.removeCls(n,"tree-node-expanded"))},r=function(e,t,n){n||(n=[]),t&&e.getChecked()&&(n.push(e),e._tree._checkedNodes.remove(e));if(!this.children)return;return this.children.forEach(function(e){return r(e,!0,n)}),n},e.TreeNode=e.cls(e.ContainerView,{baseCss:"tree-node",onInit:function(t){return this._level=this.parent.getLevel()+1,this._tree=this.parent.getTree(),this._data=t.data,t.text?this._text=t.text:this._data&&(this._text=this._data[this._tree._dataTextName]),this._icon=t.icon,this._expanded=!!t.expanded,this._childrenLoaded=!!t.childrenLoaded||t.children,this._checkable=this.parent.getCheckable(),t.hasOwnProperty("checkable")&&(this._checkable=!!t.checkable),this._checked=!!t.checked,this._unselectable=!!t.unselectable,this._expandOnClick=t.expandOnClick,e.isUndefined(t.checkOnClick)?this._checkOnClick=this._tree._checkOnClick:this._checkOnClick=t.checkOnClick,this._itemDataSelector=e.compileSelector(t.itemDataSelector||this._tree._itemDataSelector||"id"),this._itemDataEquals=e.compileEquals(t.itemDataEquals||this._tree._itemDataEquals||["id"])},onCreateChild:function(t){return t.cls=t.cls||e.TreeNode,t.parent=this},renderBegin:function(e,t){return e.append('<div id="'+t.id+'" class="'+t.css+'">'),e.append('<div class="tree-node-body'),this._level===0&&e.append(" tree-node-top"),this._childrenLoaded&&(!this.children||!this.children.count())?e.append(" tree-node-leaf"):this._expanded&&e.append(" tree-node-expanded"),this._checked&&e.append(" tree-node-checked"),e.append('">'),e.append('<div class="tree-node-indents">'),n.call(this,e),e.append("</div>"),this._level&&e.append('<div class="tree-node-expander"></div>'),e.append('<div class="tree-node-content">'),this.renderNodeContent(e),e.append("</div>"),e.append("</div>"),e.append('<div class="tree-node-children'),this._expanded||e.append(" hide"),e.append('">')},renderEnd:function(e){return e.append("</div></div>")},renderNodeContent:function(t){return this._checkable&&t.append('<a class="tree-node-chk" javascript:;><i></i></a>'),this._icon&&t.append('<i class="tree-node-icon '+this._icon+'"></i>'),t.append('<span id="'+this.id+'-label" class="tree-node-label">'),t.append(e.htmlEncode(this._text)),t.append("</span>")},onCreated:function(t){return this._elNodeBody=e.Dom.firstChild(this.el),this._elIndent=e.Dom.firstChild(this._elNodeBody),this.elBody=e.Dom.lastChild(this.el),this._elLabel=e.$(this.id+"-label"),this.el._j3TreeNode=this},onLoad:function(){if(this.parent&&this.parent!==this._tree)return t.apply(this.parent)},getLevel:function(){return this._level},setLevel:function(t){var r,i,s;if(this._level===t)return;this._level=t,r=new e.StringBuilder,n.call(this,r),this._elIndent.innerHTML=r.toString();if(!this.children)return;i=this.children.firstNode(),s=[];while(i)i.value.setLevel(this._level+1),s.push(i=i.next);return s},getTree:function(){return this._tree},getCheckable:function(){return this._checkable},getChecked:function(){return this._checked},setChecked:function(t,n){var r,i;t=!!t;if(this._checked===t)return;this._checked=t,e.Dom.toggleCls(this._elNodeBody,"tree-node-checked"),i=this._tree,r={node:this,checked:t},this.fire("check",this,r),i.notifyNodeCheck(this,t);if(n&&this.children)return this.children.forEach(function(e){return e.setChecked(t,!0)})},getUnselectable:function(){return this._unselectable},setUnselectable:function(e){return this._unselectable=e},getExpanded:function(){return this._expanded},setExpanded:function(t){var n,r;t=!!t;if(t===this._expanded)return;r=this._tree,n={node:this};if(t){this.beforeExpand&&this.beforeExpand(n);if(n.stop)return;this.fire("beforeExpand",this,n);if(n.stop)return;r.beforeNodeExpand&&r.beforeNodeExpand(n);if(n.stop)return;r.fire("beforeNodeExpand",r,n);if(n.stop)return}return e.Dom.toggleCls(this._elNodeBody,"tree-node-expanded"),e.Dom.toggleCls(this.elBody,"hide"),this._expanded=t,t?(this.fire("expand",this),r.onNodeExpand&&r.onNodeExpand(n),r.fire("nodeExpand",r,n)):(this.fire("collapse",this),r.onNodeCollapse&&r.onNodeCollapse(n),r.fire("nodeCollapse",r,n))},expand:function(e){this.setExpanded(!0);if(e&&this.children)return this.children.forEach(function(e){return e.expand(!0)})},collapse:function(e){this.setExpanded(!1);if(e&&this.children)return this.children.forEach(function(e){return e.collapse(!0)})},click:function(){this._expandOnClick&&this.expand();if(this._checkOnClick&&this._checkable)return this.setChecked(!this.getChecked())},getActive:function(){return this._tree.getActiveNode()===this},setActive:function(){return this._tree.setActiveNode(this)},__doSetActive:function(t){t?e.Dom.addCls(this._elNodeBody,"tree-node-active"):e.Dom.removeCls(this._elNodeBody,"tree-node-active")},__doSetHover:function(t){return t?e.Dom.addCls(this._elNodeBody,"tree-node-hover"):e.Dom.removeCls(this._elNodeBody,"tree-node-hover")},insert:function(e){if(e.parent===this)return;e.parent.children.remove(e);if(!this._childrenLoaded){this.expand();return}return e.parent=this,this.getChildren().insert(e),this.elBody.appendChild(e.el),e.setLevel(this._level+1)},remove:function(n){var i,s,o,u;o=this._tree,s=this.parent;if(s===o)return;this.getActive()&&(i=this.getNext(),i||(i=this.getPrevious()),i||(i=s)),u=r(this,!0),e.Dom.remove(this.el),s.children.remove(this),i&&(o._activeNode=null,o.setActiveNode(i)),t.call(s);if(u&&u.length&&!n)return o.fire("checkedNodesChange",o,{uncheckedNodes:u})},clearChildren:function(e){var n,i;if(!this.children)return;n=this._tree.getActiveNode();while(n&&n!==this._tree&&n!==this)n=n.parent;n===this&&this.setActive(),i=r(this,!1),this.children.clear(),this.elBody.innerHTML="",t.call(this);if(i&&i.length&&!e)return tree.fire("checkedNodesChange",tree,{uncheckedNodes:i})},getText:function(){return this._text},setText:function(t){return this._text=t,this._elLabel.innerHTML=e.htmlEncode(this._text)},getData:function(){return this._data},setData:function(e){var t;this._data=e;if(this._data){t=this._tree._dataTextName;if(t)return this.setText(this._data[t])}},getItemData:function(){return this._itemDataSelector(this._data)},getNodeByDataId:function(e){var t,n;if(this._data&&this._data[this._tree._dataIdName]===e)return this;if(!this.children)return null;t=this.children.firstNode();while(t){n=t.value.getNodeByDataId(e);if(n)return n;t=t.next}return null},getChildrenLoaded:function(){return this._childrenLoaded},setChildrenLoaded:function(e){return this._childrenLoaded=e},getNext:function(){var t;return t=e.Dom.next(this.el),t&&t._j3TreeNode},getPrevious:function(){var t;return t=e.Dom.previous(this.el),t&&t._j3TreeNode}})}(j3),function(e){var t,n,r,i;return t=function(e){var t,n,r;t=e.src();while(t&&t!==this.el){if(t.className==="tree-node-expander"){r=t.parentNode.parentNode._j3TreeNode,r&&r.setExpanded(!r.getExpanded());return}if(t.className==="tree-node-chk"){r=t.parentNode.parentNode.parentNode._j3TreeNode,r&&r.setChecked(!r.getChecked());return}if(t.className==="tree-node"){n=t._j3TreeNode,n&&(n.getUnselectable()||this.setActiveNode(n),n.click(),this.fire("nodeClick",this,{node:n}));return}t=t.parentNode}},n=function(e){var t,n;if(!this._expandOnDoubleClick)return;t=e.src();while(t&&t!==this.el){if(t.className==="tree-node-expander")return;if(t.className==="tree-node-chk")return;if(t.className==="tree-node"){n=t._j3TreeNode,n.setExpanded(!n.getExpanded());return}t=t.parentNode}},r=function(e){var t,n;t=e.src();while(t&&t!==this.el){if(t.className==="tree-node"){n=t._j3TreeNode,n&&this.setHoverNode(n);return}t=t.parentNode}},i=function(e){return this.setHoverNode(null)},e.TreeView=e.cls(e.View,{baseCss:"tree-view",onInit:function(t){return this._checkable=!!t.checkable,this._dataIdName=t.dataIdName||"id",this._dataTextName=t.dataTextName||"name",this._topNodeHidden=!!t.topNodeHidden,e.isUndefined(t.checkOnClick)?this._checkOnClick=!0:this._checkOnClick=!!t.checkOnClick,e.isUndefined(t.expandOnDoubleClick)?this._expandOnDoubleClick=!0:this._expandOnDoubleClick=!!t.expandOnDoubleClick,this._itemDataSelector=e.compileSelector(t.itemDataSelector||"id"),this._itemDataEquals=e.compileEquals(t.itemDataEquals||["id"])},createChildren:function(t){var n;return n=t.topNode||{},n.parent=this,n.expanded=!0,this._topNode=new e.TreeNode(n)},onRender:function(e,t){e.append('<div id="'+t.id+'" class="'+t.css),this._topNodeHidden&&e.append(" tree-view-hide-top-node"),e.append('">'),this._topNode.render(e),e.append("</div>")},onCreated:function(){return e.on(this.el,"click",this,t),e.on(this.el,"dblclick",this,n),e.on(this.el,"mousemove",this,r),e.on(this.el,"mouseout",this,i)},getLevel:function(){return-1},getTree:function(){return this},getCheckable:function(){return this._checkable},getTopNode:function(){return this._topNode},getNodeByDataId:function(e){return this.getTopNode().getNodeByDataId(e)},getActiveNode:function(){return this._activeNode},setActiveNode:function(e){var t;this._topNodeHidden&&e===this.getTopNode()&&(e=null),e&&e.getUnselectable()&&(e=null);if(this._activeNode===e)return;return t=this._activeNode,this._activeNode&&this._activeNode.__doSetActive(!1),this._activeNode=e,this._activeNode&&this._activeNode.__doSetActive(!0),this.fire("activeNodeChange",this,{old:t,node:this._activeNode})},getHoverNode:function(){return this._hoverNode},setHoverNode:function(e){var t;this._topNodeHidden&&e===this.getTopNode()&&(e=null),e&&e.getUnselectable()&&(e=null);if(this._hoverNode===e)return;return t=this._hoverNode,this._hoverNode&&this._hoverNode.__doSetHover(!1),this._hoverNode=e,this._hoverNode&&this._hoverNode.__doSetHover(!0),this.fire("hoverNodeChange",this,{old:t,node:this._hoverNode})},removeNode:function(e){return e.remove()},notifyNodeCheck:function(t,n,r){var i;this._checkedNodes||(this._checkedNodes=new e.List),i={},n?(this._checkedNodes.insert(t),i.checkedNodes=[t]):(this._checkedNodes.remove(t),i.uncheckedNodes=[t]);if(!r)return this.fire("checkedNodesChange",this,i)},getCheckedNodes:function(){return this._checkedNodes},getSelectedItems:function(){var e;return e=[],this._checkedNodes?this._checkedNodes.forEach(function(t){return e.push(t.getItemData())}):e},getTopNodeHidden:function(){return this._topNodeHidden}})}(j3),function(e){var t;return t=function(e,t){return this._window.action(e.name,e)},e.WindowActions=e.cls(e.ContainerView,{baseCss:"wnd-actions",templateBegin:e.template('<div id="<%=id%>" class="<%=css%>">'),templateEnd:e.template("</div>"),onInit:function(e){var t;return this._window=e.window,(t=this._window)==null&&(this._window=e.parent),this._align=e.align},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._align==="right"?" "+this.baseCss+"-right":"")+(this._align==="left"?" "+this.baseCss+"-left":"")+(this._align==="center"?" "+this.baseCss+"-center":"")}},onChildCreated:function(e){return e.on("click",this,t)},getActionButton:function(e){var t;if(!this.children)return null;t=this.children.firstNode();while(t){if(t.value.name===e)return t.value;t=t.next}return null}})}(j3),function(e){var t,n,r;return r=function(t){return t==="okcancel"?[{cls:e.Button,text:e.Lang.ok,name:"ok",primary:!0},{cls:e.Button,text:e.Lang.cancel,name:"cancel"}]:t==="yesno"?[{cls:e.Button,text:e.Lang.yes,name:"yes",primary:!0},{cls:e.Button,text:e.Lang.no,name:"no"}]:t},t=function(e){return this.close("cancel")},n=function(e){},e.Window=e.cls(e.ContainerView,{baseCss:"wnd",templateBegin:e.template('<div id="<%=id%>" class="<%=css%>" style="display:none"><div class="wnd-header"><a class="close">&times;</a><h2 class="wnd-title"><%-title%></h2></div><div class="wnd-body"><div class="wnd-body-inner">'),onInit:function(t){return this._title=t.title,this._contextData=t.contextData,e.isUndefined(t.autoFocusChild)&&(t.autoFocusChild=!0),this._autoFocusChild=!!t.autoFocusChild},getTemplateData:function(){return{id:this.id,css:this.getCss(),title:this._title,windowActions:this._windowActions}},createChildren:function(t){e.Window.base().createChildren.apply(this,arguments),this.createWindowChildren&&this.createWindowChildren(t);if(t.actions)return this._windowActions=new e.WindowActions({parent:this,children:r(t.actions)})},renderEnd:function(e){return e.append("</div>"),e.append("</div>"),this._windowActions&&(e.append('<div class="wnd-footer">'),this._windowActions.render(e),e.append("</div>")),e.append("</div>")},renderChildren:function(e){var t;if(!this.children)return;t=this.children.firstNode();while(t)t.value!==this._windowActions&&t.value.render(e),t=t.next},onCreated:function(){var r;return r=e.Dom,this._elWndHeader=r.firstChild(this.el),this._elWndBody=r.next(this._elWndHeader),this._elWndFooter=r.next(this._elWndBody),this._elClose=r.firstChild(this._elWndHeader),this._elTitle=r.lastChild(this._elWndHeader),this.elBody=r.firstChild(this._elWndBody),e.on(this._elClose,"click",this,t),e.on(this.el,"blur",this,n),this._dd=new e.Drag({el:this.el,trigger:this._elWndHeader,invalidTriggerTypes:"A"})},setTitle:function(t){return this._elTitle.innerHTML=e.htmlEncode(t)},getContextData:function(){return this._contextData},setContextData:function(e){return this._contextData=e},action:function(e,t){var n;return n={name:e,src:t},typeof this.onAction=="function"&&this.onAction(n),this.fire("action",this,n)},canLayout:function(){return this._visible},show:function(){var t;return t=e.Overlay.show(),this.el.style.zIndex=t+1,e.Dom.show(this.el),this._visible=!0,this.layout(),e.Dom.center(this.el),this._autoFocusChild&&e.View.focusChild.call(this),this.onActive&&this.onActive(),this.fire("active",this)},close:function(t,n){var r;if(!this._visible)return;r={result:t,data:n},typeof beforeClose=="function"&&beforeClose(r);if(r.stop)return;this.fire("beforeClose",this,r);if(r.stop)return;return this.hide(),this._visible=!1,e.Overlay.hide(),typeof onClose=="function"&&onClose(r),this.fire("close",this,r)},getActionButton:function(e){return this._windowActions?this._windowActions.getActionButton(e):null},onSetHeight:function(t){var n,r;if(!t){this.el.style.height="",this._elWndBody.style.height="",this._elWndBody.firstChild.style.height="";return}return n=e.Dom,n.offsetHeight(this.el,t),r=n.height(this.el)-n.offsetHeight(this._elWndHeader),this._elWndFooter&&(r-=n.offsetHeight(this._elWndFooter)),n.offsetHeight(this._elWndBody,r),n.offsetHeight(this._elWndBody.firstChild,n.height(this._elWndBody))},center:function(){return e.Dom.center(this.el)},getVisible:function(){return this._visible}})}(j3),function(e){var t,n,r,i;return e.MessageBox=t=e.cls(e.Window,{css:"msg-wnd",renderChildren:function(e){return e.append('<div class="msg-box-icon"></div>'),e.append('<div class="msg-box-content">'),e.append("</div>")},onCreated:function(n){return t.base().onCreated.apply(this,arguments),this._elMsgIcon=e.Dom.firstChild(this.elBody),this._elMsgContent=e.Dom.next(this._elMsgIcon),this._btnOK=this.getActionButton("ok"),this._btnCancel=this.getActionButton("cancel")},onAction:function(e){return this.close(e.name)},setIcon:function(e){return this._elMsgIcon.className="msg-box-icon msg-box-icon-"+e},setContent:function(t,n){return t==null&&(t=""),n&&(t=e.htmlEncode(t)),this._elMsgContent.innerHTML=t},setButtons:function(t){var n;n=e.Lang;switch(t){case"okcancel":return this._btnCancel.show(),this._btnOK.setText(n.ok),this._btnCancel.setText(n.cancel);case"ok":return this._btnOK.setText(n.ok),this._btnCancel.hide();case"yesno":return this._btnCancel.show(),this._btnOK.setText(n.yes),this._btnCancel.setText(n.no);case"yes":return this._btnCancel.hide(),this._btnOK.setText(n.yes)}}}),i=null,r=function(){return i?i:i=new e.Pool({onCreate:function(n){var r;return n==null&&(n={}),n.actions="okcancel",r=new t(n),r.on("close",function(t,n){var s;if(r._silentCloseByCancel&&n.result==="cancel"){i.release(t);return}return s=t._onCloseOnce,s&&(e.isFunction(s)?s():s.handler.apply(s.context,arguments)),i.release(t)}),r},onInit:function(e,t){return e.setTitle(t.title||""),e.setIcon(t.icon),e.setContent(t.content,t.encodeContent),e.setButtons(t.buttons),e._onCloseOnce=t.onClose,e._silentCloseByCancel=t.silentCloseByCancel,e.show(),e._btnOK.focus()}})},n=function(t,n,i){return function(s,o,u,a){var f;return arguments.length===1?f=s:(a||(a=u,u=null),f={title:s,content:o,onClose:{handler:a,context:u}}),f.icon=t||f.icon,f.buttons=n||f.buttons,f.silentCloseByCancel=i||f.silentCloseByCancel,f.title=f.title||e.Lang[t],r().gain(f)}},e.ext(t,{show:n(null,null),alert:n("warning","ok"),error:n("error","ok"),message:n("message","ok"),confirm:n("confirm","okcancel",!0)})}(j3),function(e){var t,n,r,i;return e.MessageBar=t=e.cls(e.View,{baseCss:"msg-bar",template:e.template('<div id="<%=id%>" class="<%=css%>"><div class="msg-bar-icon"></div><div class="msg-bar-content"></div></div>'),onCreated:function(){var t;return t=e.Dom,this._elIcon=t.firstChild(this.el),this._elContent=t.next(this._elIcon)},setIcon:function(e){if(this._icon===e)return;return this._icon=e,this.el.className=this.getCss()+" "+this.baseCss+"-"+this._icon,this._elIcon.className=this.baseCss+"-icon "+this.baseCss+"-icon-"+this._icon},setContent:function(t,n){return n&&(t=e.htmlEncode(t)),this._elContent.innerHTML=t},show:function(n){var r,i,s=this;return t.base().show.apply(this,arguments),i=this.el,r=n.ctnr,r?(r.appendChild(i),i.style.top="0",i.style.left="0"):(document.body.appendChild(i),e.Dom.center(i,30)),this._timerClose=setTimeout(function(){return s.close()},4e3)},close:function(){return clearTimeout(this._timerClose),this.hide(),this.fire("close",this)}}),i=null,r=function(){return i?i:i=new e.Pool({onCreate:function(e){var n;return n=new t(e),n.on("close",function(e,t){return i.release(e)}),n},onInit:function(e,t){return e.setIcon(t.icon),e.setContent(t.content,t.encodeContent),e._onCloseOnce=t.onClose,e.show(t)}})},n=function(t){return function(n,i,s){var o;return arguments.length===1&&e.isObject(n)?o=n:(s||(s=i,i=null),o={content:n,onClose:{handler:s,context:i}}),o.icon=t||o.icon,r().gain(o)}},e.ext(t,{show:n(null),alert:n("warning"),error:n("error"),message:n("message")})}(j3),function(e){return e.Splitter=e.cls(e.ContainerView,{baseCss:"spt",onInit:function(e){if(e.vertical)return this._vertical=!0},getTemplateData:function(){return{id:this.id,css:this.getCss()+(this._vertical?" spt-vertical":"")}},onCreateChild:function(t,n){var r;return(r=t.cls)!=null?r:t.cls=e.SplitterPanel},layoutChildren:function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d;if(!this.children)return;t=e.Dom,o=this._vertical?"height":"width",n=h=t[o].call(t,this.el),r=[],u=this.children.firstNode();while(u)a=u.value,f=a.getSize(),f?(a[o].call(a,a),n-=f):r.push(a),u=u.next;l=Math.floor(n/r.length),c=n;for(s=p=0,d=r.length;p<d;s=++p)i=r[s],s===r.length-1?f=c:(f=l,c-=l),i[o].call(i,f)}})}(j3),function(e){return e.SplitterPanel=e.cls(e.ContainerView,{baseCss:"spt-pnl",onInit:function(e){return this._fill=0,this._size=e.size||0},getSize:function(){return this._size}})}(j3),function(e){var t,n;if(typeof location=="undefined")return;return n="",t=function(){if(n===location.href)return;return n=location.href,e.Location.fire("change",{path:location.pathname})},e.Location={start:function(){return t()},"goto":function(e){return location.href=e},back:function(){return history.go(-1)},refresh:function(){return location.refresh()}},e.ext(e.Location,e.EventManager)}(j3),function(e){var t,n;return t=function(n){var r,i,s;s=[];for(i in n)r=n[i],e.isObject(r)&&t(r),i!=="$"&&0===i.indexOf("$")?s.push(n["*"]=[i.substr(1),r]):s.push(void 0);return s},n=function(t,r,i){var s,o;s="";while(s===""&&t.length)s=t.shift();if(s==="")return r.$;o=r[s];if(!o){o=r["*"];if(!o)return null;i[o[0]]=s,o=o[1]}return e.isFunction(o)?o:e.isObject(o)?n(t,o,i):null},e.Router=e.cls({ctor:function(e){this._routes=e.routes||{},t(this._routes)},handle:function(t){var r,i,s;r=t.split("/"),s={},i=n(r,this._routes,s);if(e.isFunction(i))return i(s)}})}(j3),function(e){var t,n;return n=null,e.app=function(){return n},t=function(e){return this._router.handle(e.path)},e.Application=e.cls({ctor:function(t){n=this,this._router=new e.Router({routes:t.routes}),this.onLoad&&this.onLoad()},start:function(){return e.Location.on("change",this,t),e.Location.start()}})}(j3),function(e){var t,n;return n={},t=null,e.getPage=function(e){return n[e]},e.Page=e.cls(e.ContainerView,{baseCss:"page",getPage:function(){return this},show:function(){t&&t.show(),e.Page.base().show.apply(this,arguments),t=this,this.refresh()},refresh:function(e){return this._params=e,this.onRefresh&&this.onRefresh()},onMessage:function(){var t;return(t=this._msgEvtMngr)==null&&(this._msgEvtMngr=e.createEventManager()),this._msgEvtMngr.on.apply(this._msgEvtMngr,arguments)},unMessage:function(){if(!this._msgEvtMngr)return;return this._msgEvtMngr.un.apply(this._msgEvtMngr,arguments)},notifyMessage:function(e,t,n){typeof this.onNotifyMessage=="function"&&this.onNotifyMessage(e,t,n);if(!this._msgEvtMngr)return;return this._msgEvtMngr.fire(e,t,n)},getParam:function(e){if(!this._params)return;return this._params[e]},getQuery:function(t,n){return this._query||(this._query=new e.UrlQuery),this._query.get(t,n)},setQuery:function(t,n){return this._query||(this._query=new e.UrlQuery),this._query.set(t,n)},unsetQuery:function(e){if(!this._query)return;return this._query.unset(e)},commitQuery:function(){return location.href=location.protocol+"//"+location.host+location.pathname+"#"+this.queryString()},queryString:function(){return this._query||(this._query=new e.UrlQuery),this._query.toString()}})}(j3)}).call(this)